{"file_contents":{"drizzle.config.ts":{"content":"// TODO: [REMOVIDO] Drizzle ORM config estava aqui\n// Implementar: Usar localStorage ao invés de PostgreSQL\n// Dependências removidas: drizzle-kit, postgres, DATABASE_URL","size_bytes":172},"middleware.ts":{"content":"// TODO: [REMOVIDO] Next.js Middleware estava aqui\n// Implementar: Usar React Router para navegação de rotas\n// Funcionalidade removida: JWT validation, protected routes middleware\n// Em Vite: usar Context API + localStorage para auth simples","size_bytes":244},"next.config.js":{"content":"// TODO: [REMOVIDO] Configuração Next.js estava aqui\n// Implementar: Voltar para Next.js se necessário, agora usando Vite\n// Dependências removidas: postgres, bcryptjs, headers/rewrites\n","size_bytes":190},"postcss.config.js":{"content":"module.exports = {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}","size_bytes":81},"replit.md":{"content":"# DoceCalc - Calculadora de Preços para Confeiteiras\n\n## Overview\n\nDoceCalc is a comprehensive pricing calculator application designed specifically for confectionery businesses. The platform helps confectioners calculate accurate prices for their recipes, manage ingredients, track costs, and maintain profitability. It includes features for recipe management, ingredient databases, budget calculations, and business analytics with both free and pro subscription tiers.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n- **Framework**: Next.js 14 with App Router for server-side rendering and optimal performance\n- **UI Components**: Custom component library built on Radix UI primitives for accessibility and consistency\n- **Styling**: Tailwind CSS with custom design system including gradient backgrounds, custom color palette, and responsive design\n- **State Management**: React hooks and context for local state, Supabase real-time subscriptions for server state\n- **Form Handling**: React Hook Form with Zod validation for type-safe form management\n- **Icons**: Lucide React for consistent iconography throughout the application\n\n### Authentication & Authorization\n- **Authentication Provider**: Supabase Auth with email/password authentication\n- **Session Management**: Middleware-based route protection with automatic redirects\n- **User Context**: Custom AuthProvider component wrapping the application for user state management\n- **Protected Routes**: Middleware protecting dashboard, calculator, recipes, ingredients, and budgets routes\n- **Role-Based Access**: Free vs Pro plan differentiation for feature access\n\n### Backend Architecture\n- **Database**: Supabase (PostgreSQL) with real-time capabilities\n- **API Layer**: Supabase client for database operations and authentication\n- **File Storage**: Supabase Storage for image uploads and recipe photos\n- **Real-time Updates**: Supabase real-time subscriptions for live data synchronization\n\n### Data Architecture\n- **User Profiles**: Stores user information, subscription plans, default hourly rates, and profit margins\n- **Recipe Management**: Complete recipe system with ingredients, quantities, and complexity ratings\n- **Ingredient Database**: Categorized ingredient system with pricing and unit management\n- **Calculation Engine**: Custom pricing algorithms considering ingredients, labor, overhead, and profit margins\n- **Budget System**: Quote and budget management for client proposals\n\n### Key Features\n- **Pricing Calculator**: Advanced algorithm considering ingredient costs, labor time, complexity multipliers, and overhead expenses\n- **Recipe Management**: Create, edit, and organize recipes with detailed ingredient lists and instructions\n- **Ingredient Database**: Maintain current pricing for ingredients with category organization\n- **Business Analytics**: Dashboard with key metrics and performance indicators\n- **Multi-tier Pricing**: Free and Pro plans with feature differentiation\n\n## External Dependencies\n\n### Core Services\n- **Supabase**: Primary backend service providing authentication, database (PostgreSQL), real-time subscriptions, and file storage\n- **Vercel/Deployment Platform**: Application hosting and deployment\n\n### UI & Design\n- **Radix UI**: Accessible component primitives for dropdowns, dialogs, toasts, and form elements\n- **Tailwind CSS**: Utility-first CSS framework for styling and responsive design\n- **Lucide React**: Icon library for consistent visual elements\n- **Google Fonts**: Inter and Poppins fonts for typography\n\n### Development Tools\n- **TypeScript**: Type safety and enhanced development experience\n- **ESLint**: Code linting and style enforcement\n- **PostCSS & Autoprefixer**: CSS processing and browser compatibility\n\n### Form & Validation\n- **React Hook Form**: Efficient form handling and validation\n- **Zod**: Schema validation for form data and API responses\n\n### Utility Libraries\n- **clsx & tailwind-merge**: Dynamic CSS class management\n- **class-variance-authority**: Type-safe component variant handling","size_bytes":4116},"tailwind.config.js":{"content":"/** @type {import('tailwindcss').Config} */\nmodule.exports = {\n  darkMode: [\"class\"],\n  content: [\n    './pages/**/*.{ts,tsx}',\n    './components/**/*.{ts,tsx}',\n    './app/**/*.{ts,tsx}',\n    './src/**/*.{ts,tsx}',\n  ],\n  theme: {\n    container: {\n      center: true,\n      padding: \"2rem\",\n      screens: {\n        \"2xl\": \"1400px\",\n      },\n    },\n    extend: {\n      fontFamily: {\n        display: ['Poppins', 'sans-serif'],\n        sans: ['Inter', 'sans-serif'],\n      },\n      colors: {\n        border: \"hsl(var(--border))\",\n        input: \"hsl(var(--input))\",\n        ring: \"hsl(var(--ring))\",\n        background: \"hsl(var(--background))\",\n        foreground: \"hsl(var(--foreground))\",\n        primary: {\n          DEFAULT: \"hsl(var(--primary))\",\n          foreground: \"hsl(var(--primary-foreground))\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary))\",\n          foreground: \"hsl(var(--secondary-foreground))\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive))\",\n          foreground: \"hsl(var(--destructive-foreground))\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted))\",\n          foreground: \"hsl(var(--muted-foreground))\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent))\",\n          foreground: \"hsl(var(--accent-foreground))\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover))\",\n          foreground: \"hsl(var(--popover-foreground))\",\n        },\n        card: {\n          DEFAULT: \"hsl(var(--card))\",\n          foreground: \"hsl(var(--card-foreground))\",\n        },\n      },\n      backgroundImage: {\n        'gradient-doce': 'linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%)',\n        'gradient-soft': 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n      },\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: 0 },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: 0 },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\")],\n}","size_bytes":2440},"app/globals.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap');\n\n@layer base {\n  :root {\n    --background: 0 0% 100%;\n    --foreground: 222.2 84% 4.9%;\n    --card: 0 0% 100%;\n    --card-foreground: 222.2 84% 4.9%;\n    --popover: 0 0% 100%;\n    --popover-foreground: 222.2 84% 4.9%;\n    --primary: 346 77% 49%;\n    --primary-foreground: 355 100% 97%;\n    --secondary: 210 40% 98%;\n    --secondary-foreground: 222.2 84% 4.9%;\n    --muted: 210 40% 98%;\n    --muted-foreground: 215.4 16.3% 46.9%;\n    --accent: 210 40% 98%;\n    --accent-foreground: 222.2 84% 4.9%;\n    --destructive: 0 84.2% 60.2%;\n    --destructive-foreground: 210 40% 98%;\n    --border: 214.3 31.8% 91.4%;\n    --input: 214.3 31.8% 91.4%;\n    --ring: 346 77% 49%;\n    --radius: 0.5rem;\n  }\n\n  .dark {\n    --background: 222.2 84% 4.9%;\n    --foreground: 210 40% 98%;\n    --card: 222.2 84% 4.9%;\n    --card-foreground: 210 40% 98%;\n    --popover: 222.2 84% 4.9%;\n    --popover-foreground: 210 40% 98%;\n    --primary: 346 77% 49%;\n    --primary-foreground: 355 100% 97%;\n    --secondary: 217.2 32.6% 17.5%;\n    --secondary-foreground: 210 40% 98%;\n    --muted: 217.2 32.6% 17.5%;\n    --muted-foreground: 215 20.2% 65.1%;\n    --accent: 217.2 32.6% 17.5%;\n    --accent-foreground: 210 40% 98%;\n    --destructive: 0 62.8% 30.6%;\n    --destructive-foreground: 210 40% 98%;\n    --border: 217.2 32.6% 17.5%;\n    --input: 217.2 32.6% 17.5%;\n    --ring: 346 77% 49%;\n  }\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n  \n  body {\n    @apply bg-background text-foreground font-sans;\n    font-feature-settings: \"rlig\" 1, \"calt\" 1;\n  }\n\n  h1, h2, h3, h4, h5, h6 {\n    @apply font-display;\n  }\n}\n\n@layer components {\n  /* Loading animations */\n  .animate-pulse-soft {\n    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n  }\n\n  .animate-fade-in {\n    animation: fade-in 0.3s ease-out forwards;\n  }\n\n  /* Custom scrollbar */\n  .custom-scrollbar::-webkit-scrollbar {\n    width: 6px;\n  }\n  \n  .custom-scrollbar::-webkit-scrollbar-track {\n    @apply bg-gray-100 rounded-full;\n  }\n  \n  .custom-scrollbar::-webkit-scrollbar-thumb {\n    @apply bg-gray-300 rounded-full hover:bg-gray-400;\n  }\n\n  /* Glassmorphism effect */\n  .glass {\n    background: rgba(255, 255, 255, 0.1);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(255, 255, 255, 0.2);\n  }\n\n  /* Gradient backgrounds */\n  .bg-gradient-doce {\n    background: linear-gradient(135deg, #f59e32 0%, #ec4899 100%);\n  }\n\n  .bg-gradient-soft {\n    background: linear-gradient(135deg, #fef7ed 0%, #fdf2f8 100%);\n  }\n\n  /* Button variants */\n  .btn-doce {\n    @apply bg-gradient-doce text-white font-medium px-6 py-2.5 rounded-lg;\n    @apply transition-all duration-200 ease-in-out;\n    @apply hover:shadow-lg hover:shadow-doce-500/25 hover:scale-105;\n    @apply active:scale-95;\n  }\n\n  /* Card variants */\n  .card-doce {\n    @apply bg-white rounded-xl shadow-sm border border-gray-200/50;\n    @apply hover:shadow-md transition-shadow duration-200;\n  }\n\n  .card-gradient {\n    @apply bg-gradient-soft rounded-xl shadow-sm border border-gray-200/50;\n  }\n\n  /* Input focus states */\n  .input-focus {\n    @apply focus:ring-2 focus:ring-primary/20 focus:border-primary;\n    @apply transition-all duration-200;\n  }\n\n  /* Status indicators */\n  .status-success {\n    @apply bg-green-100 text-green-800 border border-green-200;\n  }\n\n  .status-warning {\n    @apply bg-yellow-100 text-yellow-800 border border-yellow-200;\n  }\n\n  .status-error {\n    @apply bg-red-100 text-red-800 border border-red-200;\n  }\n\n  .status-info {\n    @apply bg-blue-100 text-blue-800 border border-blue-200;\n  }\n}\n\n@layer utilities {\n  .text-balance {\n    text-wrap: balance;\n  }\n\n  /* Hide scrollbar but keep functionality */\n  .scrollbar-hide {\n    -ms-overflow-style: none;\n    scrollbar-width: none;\n  }\n  \n  .scrollbar-hide::-webkit-scrollbar {\n    display: none;\n  }\n\n  /* Mobile-first responsive text */\n  .text-responsive {\n    @apply text-sm sm:text-base;\n  }\n\n  .heading-responsive {\n    @apply text-xl sm:text-2xl lg:text-3xl;\n  }\n\n  /* Safe area for mobile */\n  .safe-area-inset {\n    padding-left: env(safe-area-inset-left);\n    padding-right: env(safe-area-inset-right);\n  }\n}\n\n/* Animations personalizadas */\n@keyframes shimmer {\n  0% { background-position: -200px 0; }\n  100% { background-position: calc(200px + 100%) 0; }\n}\n\n.shimmer {\n  background: linear-gradient(90deg, \n    transparent, \n    rgba(255, 255, 255, 0.4), \n    transparent\n  );\n  background-size: 200px 100%;\n  animation: shimmer 1.5s infinite;\n}\n\n/* Loading skeleton */\n.skeleton {\n  @apply bg-gray-200 animate-pulse rounded;\n}\n\n.skeleton-text {\n  @apply skeleton h-4 w-full mb-2;\n}\n\n.skeleton-title {\n  @apply skeleton h-6 w-3/4 mb-4;\n}\n\n/* Print styles */\n@media print {\n  .no-print {\n    display: none !important;\n  }\n  \n  body {\n    -webkit-print-color-adjust: exact;\n    print-color-adjust: exact;\n  }\n}","size_bytes":5012},"app/layout.tsx":{"content":"import './globals.css'\nimport type { Metadata } from 'next'\nimport { Inter, Poppins } from 'next/font/google'\nimport { Toaster } from '@/components/ui/toaster'\nimport { LocalAuthProvider } from '@/components/auth/local-auth-provider'\n\nconst inter = Inter({ \n  subsets: ['latin'],\n  variable: '--font-inter',\n  display: 'swap',\n})\n\nconst poppins = Poppins({ \n  subsets: ['latin'],\n  weight: ['400', '500', '600', '700'],\n  variable: '--font-poppins',\n  display: 'swap',\n})\n\nexport const metadata: Metadata = {\n  title: 'DoceCalc - Calculadora de Preços para Confeiteiras',\n  description: 'A ferramenta completa para calcular preços de doces e controlar custos da sua confeitaria. Nunca mais venda no prejuízo!',\n  keywords: 'calculadora preços, confeitaria, doces, custos, receitas, margem lucro',\n  authors: [{ name: 'DoceCalc Team' }],\n  creator: 'DoceCalc',\n  publisher: 'DoceCalc',\n  formatDetection: {\n    email: false,\n    address: false,\n    telephone: false,\n  },\n  metadataBase: new URL(process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000'),\n  openGraph: {\n    title: 'DoceCalc - Calculadora de Preços para Confeiteiras',\n    description: 'Calcule o preço correto dos seus doces e tenha uma confeitaria lucrativa',\n    url: '/',\n    siteName: 'DoceCalc',\n    images: [\n      {\n        url: '/og-image.png',\n        width: 1200,\n        height: 630,\n        alt: 'DoceCalc - Calculadora para Confeiteiras',\n      },\n    ],\n    locale: 'pt_BR',\n    type: 'website',\n  },\n  twitter: {\n    card: 'summary_large_image',\n    title: 'DoceCalc - Calculadora de Preços para Confeiteiras',\n    description: 'Calcule o preço correto dos seus doces e tenha uma confeitaria lucrativa',\n    images: ['/og-image.png'],\n  },\n  robots: {\n    index: true,\n    follow: true,\n    googleBot: {\n      index: true,\n      follow: true,\n      'max-video-preview': -1,\n      'max-image-preview': 'large',\n      'max-snippet': -1,\n    },\n  },\n  verification: {\n    google: process.env.GOOGLE_VERIFICATION_ID,\n  },\n}\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"pt-BR\" className={`${inter.variable} ${poppins.variable}`}>\n      <head>\n        <link rel=\"icon\" href=\"/favicon.ico\" sizes=\"any\" />\n        <link rel=\"icon\" href=\"/favicon.svg\" type=\"image/svg+xml\" />\n        <link rel=\"apple-touch-icon\" href=\"/apple-touch-icon.png\" />\n        <link rel=\"manifest\" href=\"/manifest.json\" />\n        <meta name=\"theme-color\" content=\"#ec4899\" />\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n      </head>\n      <body className=\"min-h-screen bg-gradient-soft font-sans antialiased\">\n        <LocalAuthProvider>\n          {children}\n          <Toaster />\n        </LocalAuthProvider>\n      </body>\n    </html>\n  )\n}\n","size_bytes":2842},"app/page.tsx":{"content":"'use client'\n\nimport { useAuth } from '@/components/auth/local-auth-provider'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport Link from 'next/link'\nimport { useRouter } from 'next/navigation'\nimport { useEffect } from 'react'\nimport { \n  Calculator, \n  TrendingUp, \n  Clock, \n  DollarSign, \n  CheckCircle, \n  ArrowRight,\n  Cake,\n  PieChart,\n  FileText,\n  Zap,\n  Star,\n  Users\n} from 'lucide-react'\n\nexport default function HomePage() {\n  const { user, loading } = useAuth()\n  const router = useRouter()\n\n  useEffect(() => {\n    if (!loading && user) {\n      router.replace('/dashboard')\n    }\n  }, [user, loading, router])\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-primary\"></div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-soft\">\n      {/* Header */}\n      <header className=\"border-b bg-white/80 backdrop-blur-sm sticky top-0 z-50\">\n        <div className=\"container mx-auto px-4 h-16 flex items-center justify-between\">\n          <div className=\"flex items-center space-x-2\">\n            <Cake className=\"h-8 w-8 text-primary\" />\n            <span className=\"text-2xl font-display font-bold text-gray-900\">DoceCalc</span>\n          </div>\n          \n          <div className=\"hidden md:flex items-center space-x-8\">\n            <a href=\"#funcionalidades\" className=\"text-gray-600 hover:text-primary transition-colors\">\n              Funcionalidades\n            </a>\n            <a href=\"#planos\" className=\"text-gray-600 hover:text-primary transition-colors\">\n              Planos\n            </a>\n            <a href=\"#depoimentos\" className=\"text-gray-600 hover:text-primary transition-colors\">\n              Depoimentos\n            </a>\n          </div>\n\n          <div className=\"flex items-center space-x-4\">\n            <Link href=\"/auth/login\">\n              <Button variant=\"ghost\">Entrar</Button>\n            </Link>\n            <Link href=\"/auth/register\">\n              <Button variant=\"doce\">Cadastrar Grátis</Button>\n            </Link>\n          </div>\n        </div>\n      </header>\n\n      {/* Hero Section */}\n      <section className=\"py-20 px-4\">\n        <div className=\"container mx-auto text-center max-w-4xl\">\n          <Badge className=\"mb-4 bg-primary/10 text-primary border-primary/20\">\n            +500k Confeiteiras no Brasil 🇧🇷\n          </Badge>\n          \n          <h1 className=\"text-4xl md:text-6xl font-display font-bold text-gray-900 mb-6\">\n            Pare de vender no \n            <span className=\"text-transparent bg-gradient-doce bg-clip-text\"> prejuízo!</span>\n          </h1>\n          \n          <p className=\"text-xl text-gray-600 mb-8 max-w-2xl mx-auto\">\n            A calculadora completa para confeiteiras que querem ter uma confeitaria \n            <strong className=\"text-primary\"> realmente lucrativa</strong>. \n            Calcule preços corretos e venda com confiança!\n          </p>\n          \n          <div className=\"flex flex-col sm:flex-row gap-4 justify-center items-center mb-12\">\n            <Link href=\"/auth/register\">\n              <Button size=\"xl\" variant=\"doce\" className=\"w-full sm:w-auto\">\n                Começar Grátis Agora\n                <ArrowRight className=\"ml-2 h-5 w-5\" />\n              </Button>\n            </Link>\n            \n            <Link href=\"#demo\">\n              <Button size=\"xl\" variant=\"outline\" className=\"w-full sm:w-auto\">\n                Ver Demonstração\n              </Button>\n            </Link>\n          </div>\n          \n          {/* Stats */}\n          <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-8 max-w-2xl mx-auto\">\n            <div className=\"text-center\">\n              <div className=\"text-3xl font-bold text-primary\">8k+</div>\n              <div className=\"text-gray-600\">Buscas mensais</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-3xl font-bold text-primary\">500k+</div>\n              <div className=\"text-gray-600\">Confeiteiras BR</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-3xl font-bold text-primary\">R$ 19</div>\n              <div className=\"text-gray-600\">Por mês apenas</div>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Problemas */}\n      <section className=\"py-20 bg-white/50\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"text-3xl md:text-4xl font-display font-bold text-gray-900 mb-4\">\n              Você já passou por isso? 😰\n            </h2>\n            <p className=\"text-xl text-gray-600 max-w-2xl mx-auto\">\n              A maioria das confeiteiras comete estes erros que quebram o negócio\n            </p>\n          </div>\n\n          <div className=\"grid md:grid-cols-2 gap-8 max-w-4xl mx-auto\">\n            <Card className=\"border-red-200 bg-red-50/50\">\n              <CardHeader>\n                <CardTitle className=\"text-red-700 flex items-center\">\n                  <DollarSign className=\"h-6 w-6 mr-2\" />\n                  Preço no \"achômetro\"\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-red-600\">\n                  \"Cobro R$ 3,00 o brigadeiro porque a concorrência cobra isso...\"\n                  Resultado: prejuízo mascarado que só aparece no final do mês.\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"border-red-200 bg-red-50/50\">\n              <CardHeader>\n                <CardTitle className=\"text-red-700 flex items-center\">\n                  <Clock className=\"h-6 w-6 mr-2\" />\n                  Esquece a mão de obra\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-red-600\">\n                  \"Só conto o ingrediente, meu trabalho é de graça!\"\n                  Seu tempo vale dinheiro e precisa estar no preço.\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"border-red-200 bg-red-50/50\">\n              <CardHeader>\n                <CardTitle className=\"text-red-700 flex items-center\">\n                  <TrendingUp className=\"h-6 w-6 mr-2\" />\n                  Margem de lucro baixa\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-red-600\">\n                  \"20% de lucro está bom...\" Não! Para crescer o negócio, \n                  você precisa de margens maiores.\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"border-red-200 bg-red-50/50\">\n              <CardHeader>\n                <CardTitle className=\"text-red-700 flex items-center\">\n                  <FileText className=\"h-6 w-6 mr-2\" />\n                  Orçamentos amadores\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-red-600\">\n                  \"Mando por WhatsApp mesmo...\" Clientes não levam a sério\n                  e você perde vendas por parecer amadora.\n                </p>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </section>\n\n      {/* Funcionalidades */}\n      <section id=\"funcionalidades\" className=\"py-20\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"text-3xl md:text-4xl font-display font-bold text-gray-900 mb-4\">\n              A solução completa para sua confeitaria 🎂\n            </h2>\n            <p className=\"text-xl text-gray-600 max-w-2xl mx-auto\">\n              Tudo que você precisa para calcular preços corretos e ter um negócio lucrativo\n            </p>\n          </div>\n\n          <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-8\">\n            <Card className=\"hover:shadow-lg transition-shadow\">\n              <CardHeader>\n                <Calculator className=\"h-12 w-12 text-primary mb-4\" />\n                <CardTitle>Calculadora Inteligente</CardTitle>\n                <CardDescription>\n                  Calcula automaticamente custos de ingredientes, mão de obra, \n                  custos fixos e margem de lucro ideal.\n                </CardDescription>\n              </CardHeader>\n            </Card>\n\n            <Card className=\"hover:shadow-lg transition-shadow\">\n              <CardHeader>\n                <Cake className=\"h-12 w-12 text-primary mb-4\" />\n                <CardTitle>Base de Receitas</CardTitle>\n                <CardDescription>\n                  Cadastre suas receitas com ingredientes e quantidades. \n                  Templates prontos para começar rápido.\n                </CardDescription>\n              </CardHeader>\n            </Card>\n\n            <Card className=\"hover:shadow-lg transition-shadow\">\n              <CardHeader>\n                <DollarSign className=\"h-12 w-12 text-primary mb-4\" />\n                <CardTitle>Preços Atualizados</CardTitle>\n                <CardDescription>\n                  Base de ingredientes com preços médios do mercado, \n                  atualizada por nossa comunidade.\n                </CardDescription>\n              </CardHeader>\n            </Card>\n\n            <Card className=\"hover:shadow-lg transition-shadow\">\n              <CardHeader>\n                <PieChart className=\"h-12 w-12 text-primary mb-4\" />\n                <CardTitle>Relatórios Inteligentes</CardTitle>\n                <CardDescription>\n                  Veja quais produtos dão mais lucro, análise de custos \n                  e insights para otimizar seu negócio.\n                </CardDescription>\n              </CardHeader>\n            </Card>\n\n            <Card className=\"hover:shadow-lg transition-shadow\">\n              <CardHeader>\n                <FileText className=\"h-12 w-12 text-primary mb-4\" />\n                <CardTitle>Orçamentos Profissionais</CardTitle>\n                <CardDescription>\n                  Gere orçamentos em PDF profissionais para impressionar\n                  seus clientes e fechar mais vendas.\n                </CardDescription>\n              </CardHeader>\n            </Card>\n\n            <Card className=\"hover:shadow-lg transition-shadow\">\n              <CardHeader>\n                <Zap className=\"h-12 w-12 text-primary mb-4\" />\n                <CardTitle>Cálculo Instantâneo</CardTitle>\n                <CardDescription>\n                  Mude a quantidade e veja o preço atualizar na hora. \n                  Perfeito para atender clientes rapidamente.\n                </CardDescription>\n              </CardHeader>\n            </Card>\n          </div>\n        </div>\n      </section>\n\n      {/* Demo Section */}\n      <section id=\"demo\" className=\"py-20 bg-white/50\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"text-3xl md:text-4xl font-display font-bold text-gray-900 mb-4\">\n              Veja como é simples usar 📱\n            </h2>\n            <p className=\"text-xl text-gray-600 max-w-2xl mx-auto\">\n              Interface criada especialmente para confeiteiras, mesmo quem não é expert em tecnologia\n            </p>\n          </div>\n\n          <div className=\"max-w-4xl mx-auto\">\n            <div className=\"bg-gradient-doce p-8 rounded-2xl text-white text-center\">\n              <h3 className=\"text-2xl font-bold mb-4\">🎯 Exemplo Prático: Brigadeiro</h3>\n              \n              <div className=\"grid md:grid-cols-3 gap-6 text-left bg-white/10 p-6 rounded-lg\">\n                <div>\n                  <h4 className=\"font-semibold mb-2\">📝 Ingredientes:</h4>\n                  <ul className=\"text-sm space-y-1\">\n                    <li>• Leite condensado: R$ 3,95</li>\n                    <li>• Chocolate pó: R$ 1,25</li>\n                    <li>• Manteiga: R$ 0,27</li>\n                    <li>• Granulado: R$ 2,00</li>\n                  </ul>\n                </div>\n                \n                <div>\n                  <h4 className=\"font-semibold mb-2\">⚡ Cálculo Automático:</h4>\n                  <ul className=\"text-sm space-y-1\">\n                    <li>• Custo ingredientes: R$ 7,47</li>\n                    <li>• Mão de obra (30min): R$ 12,50</li>\n                    <li>• Custos fixos: R$ 2,40</li>\n                    <li>• Margem 60%: R$ 13,42</li>\n                  </ul>\n                </div>\n                \n                <div>\n                  <h4 className=\"font-semibold mb-2\">💰 Resultado:</h4>\n                  <ul className=\"text-sm space-y-1\">\n                    <li>• <strong>Custo total: R$ 22,37</strong></li>\n                    <li>• <strong>Preço final: R$ 35,79</strong></li>\n                    <li>• <strong>Por unidade: R$ 1,20</strong></li>\n                    <li>• ✅ Lucro real: R$ 13,42</li>\n                  </ul>\n                </div>\n              </div>\n              \n              <div className=\"mt-6\">\n                <Badge className=\"bg-green-500 text-white\">\n                  ✨ Antes você cobrava R$ 1,00 e tinha prejuízo. Agora R$ 1,20 com 60% de lucro!\n                </Badge>\n              </div>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Planos */}\n      <section id=\"planos\" className=\"py-20\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"text-3xl md:text-4xl font-display font-bold text-gray-900 mb-4\">\n              Escolha seu plano 💎\n            </h2>\n            <p className=\"text-xl text-gray-600 max-w-2xl mx-auto\">\n              Comece grátis e upgrade quando seu negócio crescer\n            </p>\n          </div>\n\n          <div className=\"grid md:grid-cols-2 gap-8 max-w-4xl mx-auto\">\n            {/* Plano Free */}\n            <Card className=\"relative\">\n              <CardHeader>\n                <div className=\"text-center\">\n                  <CardTitle className=\"text-2xl mb-2\">Plano Gratuito</CardTitle>\n                  <div className=\"text-4xl font-bold text-primary\">R$ 0</div>\n                  <p className=\"text-gray-600\">Para sempre</p>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <ul className=\"space-y-3 mb-8\">\n                  <li className=\"flex items-center\">\n                    <CheckCircle className=\"h-5 w-5 text-green-500 mr-3\" />\n                    3 receitas cadastradas\n                  </li>\n                  <li className=\"flex items-center\">\n                    <CheckCircle className=\"h-5 w-5 text-green-500 mr-3\" />\n                    Calculadora básica\n                  </li>\n                  <li className=\"flex items-center\">\n                    <CheckCircle className=\"h-5 w-5 text-green-500 mr-3\" />\n                    Base de ingredientes\n                  </li>\n                  <li className=\"flex items-center\">\n                    <CheckCircle className=\"h-5 w-5 text-green-500 mr-3\" />\n                    Suporte por email\n                  </li>\n                </ul>\n                <Link href=\"/auth/register\">\n                  <Button className=\"w-full\" variant=\"outline\">\n                    Começar Grátis\n                  </Button>\n                </Link>\n              </CardContent>\n            </Card>\n\n            {/* Plano Pro */}\n            <Card className=\"relative border-primary bg-gradient-to-b from-primary/5 to-transparent\">\n              <div className=\"absolute -top-3 left-1/2 transform -translate-x-1/2\">\n                <Badge className=\"bg-primary text-white\">Mais Popular 🔥</Badge>\n              </div>\n              <CardHeader>\n                <div className=\"text-center\">\n                  <CardTitle className=\"text-2xl mb-2\">Plano Profissional</CardTitle>\n                  <div className=\"text-4xl font-bold text-primary\">R$ 29</div>\n                  <p className=\"text-gray-600\">Por mês</p>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <ul className=\"space-y-3 mb-8\">\n                  <li className=\"flex items-center\">\n                    <CheckCircle className=\"h-5 w-5 text-green-500 mr-3\" />\n                    Receitas ilimitadas\n                  </li>\n                  <li className=\"flex items-center\">\n                    <CheckCircle className=\"h-5 w-5 text-green-500 mr-3\" />\n                    Calculadora avançada\n                  </li>\n                  <li className=\"flex items-center\">\n                    <CheckCircle className=\"h-5 w-5 text-green-500 mr-3\" />\n                    Orçamentos profissionais\n                  </li>\n                  <li className=\"flex items-center\">\n                    <CheckCircle className=\"h-5 w-5 text-green-500 mr-3\" />\n                    Relatórios detalhados\n                  </li>\n                  <li className=\"flex items-center\">\n                    <CheckCircle className=\"h-5 w-5 text-green-500 mr-3\" />\n                    Economia de escala\n                  </li>\n                  <li className=\"flex items-center\">\n                    <CheckCircle className=\"h-5 w-5 text-green-500 mr-3\" />\n                    Templates de receitas\n                  </li>\n                  <li className=\"flex items-center\">\n                    <CheckCircle className=\"h-5 w-5 text-green-500 mr-3\" />\n                    Suporte prioritário\n                  </li>\n                </ul>\n                <Link href=\"/auth/register\">\n                  <Button className=\"w-full\" variant=\"doce\">\n                    Começar Teste Grátis\n                  </Button>\n                </Link>\n              </CardContent>\n            </Card>\n          </div>\n\n          <p className=\"text-center text-gray-600 mt-8\">\n            💳 <strong>7 dias grátis</strong> no plano PRO · Cancele quando quiser · Sem taxas extras\n          </p>\n        </div>\n      </section>\n\n      {/* Depoimentos */}\n      <section id=\"depoimentos\" className=\"py-20 bg-white/50\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"text-3xl md:text-4xl font-display font-bold text-gray-900 mb-4\">\n              O que as confeiteiras estão falando 💬\n            </h2>\n            <p className=\"text-xl text-gray-600 max-w-2xl mx-auto\">\n              Resultados reais de quem já está usando o DoceCalc\n            </p>\n          </div>\n\n          <div className=\"grid md:grid-cols-3 gap-8 max-w-5xl mx-auto\">\n            <Card className=\"text-center\">\n              <CardHeader>\n                <div className=\"flex justify-center mb-4\">\n                  {[...Array(5)].map((_, i) => (\n                    <Star key={i} className=\"h-5 w-5 text-yellow-400 fill-current\" />\n                  ))}\n                </div>\n                <CardDescription className=\"text-base\">\n                  \"Descobri que estava perdendo dinheiro em 70% dos meus produtos! \n                  Agora com os preços corretos, meu lucro triplicou em 2 meses.\"\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"font-semibold\">Maria Silva</div>\n                <div className=\"text-sm text-gray-600\">Doces da Mari - SP</div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"text-center\">\n              <CardHeader>\n                <div className=\"flex justify-center mb-4\">\n                  {[...Array(5)].map((_, i) => (\n                    <Star key={i} className=\"h-5 w-5 text-yellow-400 fill-current\" />\n                  ))}\n                </div>\n                <CardDescription className=\"text-base\">\n                  \"Os orçamentos profissionais em PDF impressionam os clientes. \n                  Minha taxa de fechamento de vendas aumentou 40%!\"\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"font-semibold\">Ana Costa</div>\n                <div className=\"text-sm text-gray-600\">Confeitaria Ana - RJ</div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"text-center\">\n              <CardHeader>\n                <div className=\"flex justify-center mb-4\">\n                  {[...Array(5)].map((_, i) => (\n                    <Star key={i} className=\"h-5 w-5 text-yellow-400 fill-current\" />\n                  ))}\n                </div>\n                <CardDescription className=\"text-base\">\n                  \"Finalmente sei quanto cobrar! A calculadora é muito fácil de usar \n                  e me deu confiança para precificar corretamente.\"\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"font-semibold\">Carla Santos</div>\n                <div className=\"text-sm text-gray-600\">Carla Doces - MG</div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </section>\n\n      {/* CTA Final */}\n      <section className=\"py-20 bg-gradient-doce text-white\">\n        <div className=\"container mx-auto px-4 text-center\">\n          <h2 className=\"text-3xl md:text-4xl font-display font-bold mb-4\">\n            Pronta para ter uma confeitaria lucrativa? 🚀\n          </h2>\n          <p className=\"text-xl mb-8 max-w-2xl mx-auto opacity-90\">\n            Junte-se a centenas de confeiteiras que já descobriram como calcular preços corretos \n            e ter um negócio próspero\n          </p>\n          \n          <div className=\"flex flex-col sm:flex-row gap-4 justify-center items-center mb-8\">\n            <Link href=\"/auth/register\">\n              <Button size=\"xl\" variant=\"secondary\" className=\"w-full sm:w-auto bg-white text-primary hover:bg-gray-100\">\n                Começar Grátis Agora\n                <ArrowRight className=\"ml-2 h-5 w-5\" />\n              </Button>\n            </Link>\n          </div>\n          \n          <div className=\"flex justify-center items-center space-x-6 text-sm opacity-75\">\n            <div className=\"flex items-center\">\n              <CheckCircle className=\"h-4 w-4 mr-1\" />\n              Grátis para sempre\n            </div>\n            <div className=\"flex items-center\">\n              <CheckCircle className=\"h-4 w-4 mr-1\" />\n              Sem cartão de crédito\n            </div>\n            <div className=\"flex items-center\">\n              <CheckCircle className=\"h-4 w-4 mr-1\" />\n              Comece em 2 minutos\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Footer */}\n      <footer className=\"bg-gray-900 text-gray-300 py-12\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"grid md:grid-cols-4 gap-8\">\n            <div>\n              <div className=\"flex items-center space-x-2 mb-4\">\n                <Cake className=\"h-6 w-6 text-primary\" />\n                <span className=\"text-xl font-display font-bold text-white\">DoceCalc</span>\n              </div>\n              <p className=\"text-sm\">\n                A calculadora completa para confeiteiras que querem ter um negócio lucrativo.\n              </p>\n            </div>\n            \n            <div>\n              <h3 className=\"font-semibold text-white mb-4\">Produto</h3>\n              <ul className=\"space-y-2 text-sm\">\n                <li><a href=\"#funcionalidades\" className=\"hover:text-primary\">Funcionalidades</a></li>\n                <li><a href=\"#planos\" className=\"hover:text-primary\">Planos</a></li>\n                <li><a href=\"#demo\" className=\"hover:text-primary\">Demo</a></li>\n              </ul>\n            </div>\n            \n            <div>\n              <h3 className=\"font-semibold text-white mb-4\">Suporte</h3>\n              <ul className=\"space-y-2 text-sm\">\n                <li><a href=\"mailto:contato@docecalc.com\" className=\"hover:text-primary\">Contato</a></li>\n                <li><a href=\"/ajuda\" className=\"hover:text-primary\">Central de Ajuda</a></li>\n                <li><a href=\"/blog\" className=\"hover:text-primary\">Blog</a></li>\n              </ul>\n            </div>\n            \n            <div>\n              <h3 className=\"font-semibold text-white mb-4\">Legal</h3>\n              <ul className=\"space-y-2 text-sm\">\n                <li><a href=\"/privacidade\" className=\"hover:text-primary\">Privacidade</a></li>\n                <li><a href=\"/termos\" className=\"hover:text-primary\">Termos</a></li>\n                <li><a href=\"/cookies\" className=\"hover:text-primary\">Cookies</a></li>\n              </ul>\n            </div>\n          </div>\n          \n          <div className=\"border-t border-gray-800 mt-8 pt-8 text-center text-sm\">\n            <p>&copy; 2024 DoceCalc. Todos os direitos reservados.</p>\n            <p className=\"mt-2 text-gray-500\">Feito com 💖 para confeiteiras brasileiras</p>\n          </div>\n        </div>\n      </footer>\n    </div>\n  )\n}","size_bytes":25302},"hooks/use-toast.ts":{"content":"'use client'\n\nimport * as React from \"react\"\nimport type { ComponentProps } from \"react\"\n\nexport interface ToastProps extends ComponentProps<'div'> {\n  title?: string\n  description?: string\n  variant?: 'default' | 'destructive'\n}\n\ntype ToastActionElement = React.ReactElement<any>\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3923},"lib/auth-provider.tsx":{"content":"'use client'\n\nimport { createContext, useContext, useEffect, useState } from 'react'\nimport { User } from '@supabase/supabase-js'\nimport { supabase } from '@/lib/supabase-client'\nimport { Profile } from '@/lib/database-types'\nimport { toast } from '@/hooks/use-toast'\n\ninterface AuthContextType {\n  user: User | null\n  profile: Profile | null\n  loading: boolean\n  signIn: (email: string, password: string) => Promise<void>\n  signUp: (email: string, password: string, nome: string) => Promise<void>\n  signOut: () => Promise<void>\n  updateProfile: (updates: Partial<Profile>) => Promise<void>\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined)\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const [user, setUser] = useState<User | null>(null)\n  const [profile, setProfile] = useState<Profile | null>(null)\n  const [loading, setLoading] = useState(true)\n\n  useEffect(() => {\n    // Pegar usuário inicial\n    const getInitialUser = async () => {\n      const { data: { user } } = await supabase.auth.getUser()\n      setUser(user)\n      \n      if (user) {\n        await fetchProfile(user.id)\n      }\n      \n      setLoading(false)\n    }\n\n    getInitialUser()\n\n    // Escutar mudanças de autenticação\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(\n      async (event, session) => {\n        setUser(session?.user ?? null)\n        \n        if (session?.user) {\n          await fetchProfile(session.user.id)\n        } else {\n          setProfile(null)\n        }\n        \n        setLoading(false)\n      }\n    )\n\n    return () => subscription.unsubscribe()\n  }, [])\n\n  const fetchProfile = async (userId: string) => {\n    try {\n      const { data, error } = await supabase\n        .from('profiles')\n        .select('*')\n        .eq('id', userId)\n        .single()\n\n      if (error && error.code !== 'PGRST116') {\n        throw error\n      }\n\n      setProfile(data)\n    } catch (error) {\n      console.error('Erro ao buscar perfil:', error)\n      toast({\n        title: \"Erro\",\n        description: \"Não foi possível carregar seu perfil.\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const signIn = async (email: string, password: string) => {\n    try {\n      setLoading(true)\n      \n      const { data, error } = await supabase.auth.signInWithPassword({\n        email,\n        password,\n      })\n\n      if (error) throw error\n\n      toast({\n        title: \"Bem-vinda de volta! 🎂\",\n        description: \"Login realizado com sucesso.\",\n      })\n    } catch (error: any) {\n      console.error('Erro no login:', error)\n      \n      let message = \"Erro ao fazer login. Tente novamente.\"\n      if (error.message?.includes('Invalid login credentials')) {\n        message = \"Email ou senha incorretos.\"\n      } else if (error.message?.includes('Email not confirmed')) {\n        message = \"Por favor, confirme seu email antes de fazer login.\"\n      }\n      \n      toast({\n        title: \"Erro no Login\",\n        description: message,\n        variant: \"destructive\",\n      })\n      \n      throw error\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const signUp = async (email: string, password: string, nome: string) => {\n    try {\n      setLoading(true)\n      \n      const { data, error } = await supabase.auth.signUp({\n        email,\n        password,\n        options: {\n          data: {\n            nome: nome,\n          },\n        },\n      })\n\n      if (error) throw error\n\n      toast({\n        title: \"Conta criada! 🎉\",\n        description: \"Verifique seu email para confirmar a conta.\",\n      })\n    } catch (error: any) {\n      console.error('Erro no cadastro:', error)\n      \n      let message = \"Erro ao criar conta. Tente novamente.\"\n      if (error.message?.includes('User already registered')) {\n        message = \"Este email já está cadastrado. Faça login ou recupere sua senha.\"\n      } else if (error.message?.includes('Password should be at least 6 characters')) {\n        message = \"A senha deve ter pelo menos 6 caracteres.\"\n      } else if (error.message?.includes('Signup requires a valid password')) {\n        message = \"Por favor, insira uma senha válida.\"\n      }\n      \n      toast({\n        title: \"Erro no Cadastro\",\n        description: message,\n        variant: \"destructive\",\n      })\n      \n      throw error\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const signOut = async () => {\n    try {\n      setLoading(true)\n      \n      const { error } = await supabase.auth.signOut()\n      if (error) throw error\n\n      toast({\n        title: \"Até logo! 👋\",\n        description: \"Logout realizado com sucesso.\",\n      })\n    } catch (error) {\n      console.error('Erro no logout:', error)\n      toast({\n        title: \"Erro\",\n        description: \"Erro ao fazer logout.\",\n        variant: \"destructive\",\n      })\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const updateProfile = async (updates: Partial<Profile>) => {\n    if (!user) return\n\n    try {\n      const { data, error } = await supabase\n        .from('profiles')\n        .update(updates)\n        .eq('id', user.id)\n        .select()\n        .single()\n\n      if (error) throw error\n\n      setProfile(data)\n      \n      toast({\n        title: \"Perfil atualizado! ✨\",\n        description: \"Suas informações foram salvas com sucesso.\",\n      })\n    } catch (error) {\n      console.error('Erro ao atualizar perfil:', error)\n      toast({\n        title: \"Erro\",\n        description: \"Não foi possível atualizar seu perfil.\",\n        variant: \"destructive\",\n      })\n      throw error\n    }\n  }\n\n  const value = {\n    user,\n    profile,\n    loading,\n    signIn,\n    signUp,\n    signOut,\n    updateProfile,\n  }\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext)\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider')\n  }\n  return context\n}","size_bytes":5982},"lib/auth.ts":{"content":"import bcrypt from 'bcryptjs'\nimport { SignJWT, jwtVerify } from 'jose'\nimport { db } from './db'\nimport { profiles } from './schema'\nimport { eq } from 'drizzle-orm'\n\nconst JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key'\nconst secret = new TextEncoder().encode(JWT_SECRET)\n\nexport interface User {\n  id: string\n  email: string\n  nome: string\n  plano?: string // opcional\n}\n\n// === Helpers de senha e token ===\nexport async function hashPassword(password: string): Promise<string> {\n  return bcrypt.hash(password, 12)\n}\n\nexport async function verifyPassword(password: string, hashedPassword: string): Promise<boolean> {\n  return bcrypt.compare(password, hashedPassword)\n}\n\nexport async function generateToken(user: User): Promise<string> {\n  return new SignJWT({\n    userId: user.id,\n    email: user.email,\n    nome: user.nome,\n  })\n    .setProtectedHeader({ alg: 'HS256' })\n    .setIssuedAt()\n    .setExpirationTime('7d')\n    .sign(secret)\n}\n\nexport async function verifyToken(token: string): Promise<any> {\n  try {\n    const { payload } = await jwtVerify(token, secret, {\n      algorithms: ['HS256'],\n    })\n    return payload\n  } catch (error) {\n    console.error('Failed to verify JWT:', error)\n    return null\n  }\n}\n\n// === Cadastro (signUp) ===\nexport async function signUp(email: string, password: string, nome: string) {\n  try {\n    // Verificar se email já existe\n    const existingUser = await db\n      .select()\n      .from(profiles)\n      .where(eq(profiles.email, email))\n      .limit(1)\n\n    if (existingUser.length > 0) {\n      throw new Error('Email já cadastrado')\n    }\n\n    // Hash da senha\n    const hashedPassword = await hashPassword(password)\n\n    // Criar usuário\n    const [newUser] = await db\n      .insert(profiles)\n      .values({\n        id: crypto.randomUUID(),\n        email,\n        nome,\n        password: hashedPassword,\n        plano: 'free', // opcional, se existir no schema\n      })\n      .returning({\n        id: profiles.id,\n        email: profiles.email,\n        nome: profiles.nome,\n        plano: profiles.plano,\n      })\n\n    // Gerar token\n    const token = await generateToken({\n      id: newUser.id,\n      email: newUser.email,\n      nome: newUser.nome,\n      plano: newUser.plano,\n    })\n\n    return { user: newUser, token }\n  } catch (error) {\n    console.error('Erro no cadastro:', error)\n    throw error\n  }\n}\n\n// === Login (signIn) ===\nexport async function signIn(email: string, password: string) {\n  try {\n    const [user] = await db\n      .select({\n        id: profiles.id,\n        email: profiles.email,\n        nome: profiles.nome,\n        password: profiles.password,\n        plano: profiles.plano,\n      })\n      .from(profiles)\n      .where(eq(profiles.email, email))\n      .limit(1)\n\n    if (!user) {\n      throw new Error('Email ou senha incorretos')\n    }\n\n    const isValid = await verifyPassword(password, user.password || '')\n    if (!isValid) {\n      throw new Error('Email ou senha incorretos')\n    }\n\n    const token = await generateToken({\n      id: user.id,\n      email: user.email,\n      nome: user.nome,\n      plano: user.plano,\n    })\n\n    return { user, token }\n  } catch (error) {\n    console.error('Erro no login:', error)\n    throw error\n  }\n}\n\n// === Pegar usuário logado ===\nexport async function getCurrentUser(token: string) {\n  try {\n    const decoded = await verifyToken(token)\n    if (!decoded) return null\n\n    const [user] = await db\n      .select({\n        id: profiles.id,\n        email: profiles.email,\n        nome: profiles.nome,\n        plano: profiles.plano,\n      })\n      .from(profiles)\n      .where(eq(profiles.id, decoded.userId))\n      .limit(1)\n\n    return user || null\n  } catch (error) {\n    console.error('Erro ao buscar usuário:', error)\n    return null\n  }\n}\n","size_bytes":3779},"lib/calculations-lib.ts":{"content":"import { ReceitaCompleta, CalculoDetalhes } from '@/lib/database-types'\n\n// Multiplicadores de complexidade para mão de obra\nexport const MULTIPLICADORES_COMPLEXIDADE = {\n  simples: 1.0,   // Brigadeiro, beijinho, etc\n  media: 1.5,     // Bolo simples, torta básica\n  complexa: 2.0   // Cake design, doces elaborados\n} as const\n\n// Percentuais de custos fixos\nexport const CUSTOS_FIXOS = {\n  energia: 0.03,      // 3% do custo base\n  gas: 0.02,          // 2% do custo base\n  embalagem: 0.05,    // 5% do custo base\n  transporte: 0.02,   // 2% do custo base (se houver entrega)\n  outros: 0.01        // 1% do custo base (desgaste equipamentos, etc)\n} as const\n\nexport const CUSTOS_FIXOS_TOTAL = Object.values(CUSTOS_FIXOS).reduce((acc, val) => acc + val, 0)\n\n// Função principal de cálculo de preços\nexport function calcularPrecoReceita(\n  receita: ReceitaCompleta,\n  valorHoraTrabalhador: number,\n  margemLucro: number,\n  quantidadeProduzir: number = 1,\n  incluirTransporte: boolean = false\n): CalculoDetalhes {\n  \n  // 1. Calcular custo dos ingredientes\n  const { custoIngredientes, breakdown } = calcularCustoIngredientes(\n    receita,\n    quantidadeProduzir\n  )\n  \n  // 2. Calcular custo da mão de obra\n  const custoMaoDeObra = calcularCustoMaoDeObra(\n    receita,\n    valorHoraTrabalhador,\n    quantidadeProduzir\n  )\n  \n  // 3. Calcular custos fixos\n  const custoBase = custoIngredientes + custoMaoDeObra\n  let custosFixos = custoBase * (CUSTOS_FIXOS_TOTAL - CUSTOS_FIXOS.transporte)\n  \n  if (incluirTransporte) {\n    custosFixos += custoBase * CUSTOS_FIXOS.transporte\n  }\n  \n  // 4. Custo total\n  const custoTotal = custoIngredientes + custoMaoDeObra + custosFixos\n  \n  // 5. Preço final com margem de lucro\n  const precoFinal = custoTotal * (1 + margemLucro)\n  \n  return {\n    custoIngredientes,\n    custoMaoDeObra,\n    custosFixos,\n    custoTotal,\n    margemLucro,\n    precoFinal: Math.ceil(precoFinal * 2) / 2, // Arredonda para 0,50\n    breakdown\n  }\n}\n\n// Calcular custo dos ingredientes\nfunction calcularCustoIngredientes(\n  receita: ReceitaCompleta,\n  quantidadeProduzir: number\n) {\n  let custoIngredientes = 0\n  const breakdown: { ingrediente: string; quantidade: number; custo: number }[] = []\n  \n  receita.receita_ingredientes.forEach(receitaIngrediente => {\n    const ingrediente = receitaIngrediente.ingredientes\n    const quantidadeNecessaria = receitaIngrediente.quantidade * quantidadeProduzir\n    \n    // Calcular custo usando preço por kg (convertido para preço por unidade)\n    const custoIngrediente = quantidadeNecessaria * (ingrediente.preco_por_unidade || ingrediente.preco_kg)\n    \n    custoIngredientes += custoIngrediente\n    breakdown.push({\n      ingrediente: ingrediente.nome,\n      quantidade: quantidadeNecessaria,\n      custo: custoIngrediente\n    })\n  })\n  \n  return { custoIngredientes, breakdown }\n}\n\n// Calcular custo da mão de obra\nfunction calcularCustoMaoDeObra(\n  receita: ReceitaCompleta,\n  valorHora: number,\n  quantidadeProduzir: number\n): number {\n  const tempoTotalMinutos = (receita.tempo_preparo || receita.tempo_producao) * quantidadeProduzir\n  const tempoTotalHoras = tempoTotalMinutos / 60\n  \n  const multiplicador = MULTIPLICADORES_COMPLEXIDADE[receita.complexidade]\n  \n  return tempoTotalHoras * valorHora * multiplicador\n}\n\n// Calcular preço por unidade\nexport function calcularPrecoPorUnidade(\n  receita: ReceitaCompleta,\n  valorHoraTrabalhador: number,\n  margemLucro: number,\n  incluirTransporte: boolean = false\n): number {\n  const calculo = calcularPrecoReceita(\n    receita,\n    valorHoraTrabalhador,\n    margemLucro,\n    1,\n    incluirTransporte\n  )\n  \n  return calculo.precoFinal / receita.rendimento\n}\n\n// Função para sugerir margem de lucro baseada na complexidade\nexport function sugerirMargemLucro(complexidade: 'simples' | 'media' | 'complexa'): number {\n  switch (complexidade) {\n    case 'simples':\n      return 0.40 // 40% de margem para produtos simples\n    case 'media':\n      return 0.60 // 60% de margem para produtos médios\n    case 'complexa':\n      return 0.80 // 80% de margem para produtos complexos\n    default:\n      return 0.50\n  }\n}\n\n// Função para calcular preço de venda competitivo\nexport function calcularPrecoCompetitivo(\n  custoTotal: number,\n  margemMinima: number = 0.30, // 30% margem mínima\n  margemMaxima: number = 1.00   // 100% margem máxima\n) {\n  const precoMinimo = custoTotal * (1 + margemMinima)\n  const precoMaximo = custoTotal * (1 + margemMaxima)\n  const precoSugerido = custoTotal * (1 + 0.50) // 50% margem padrão\n  \n  return {\n    precoMinimo: Math.ceil(precoMinimo * 2) / 2,\n    precoMaximo: Math.ceil(precoMaximo * 2) / 2,\n    precoSugerido: Math.ceil(precoSugerido * 2) / 2\n  }\n}\n\n// Função para análise de rentabilidade\nexport function analisarRentabilidade(\n  precoVenda: number,\n  custoTotal: number\n) {\n  const lucro = precoVenda - custoTotal\n  const margemPercentual = (lucro / custoTotal) * 100\n  const margemSobreVenda = (lucro / precoVenda) * 100\n  \n  let classificacao: 'baixa' | 'boa' | 'excelente'\n  \n  if (margemPercentual < 30) {\n    classificacao = 'baixa'\n  } else if (margemPercentual < 60) {\n    classificacao = 'boa'\n  } else {\n    classificacao = 'excelente'\n  }\n  \n  return {\n    lucro,\n    margemPercentual: Math.round(margemPercentual * 100) / 100,\n    margemSobreVenda: Math.round(margemSobreVenda * 100) / 100,\n    classificacao\n  }\n}\n\n// Função para calcular economia de escala\nexport function calcularEconomiaEscala(\n  receita: ReceitaCompleta,\n  valorHora: number,\n  margem: number,\n  quantidades: number[]\n) {\n  return quantidades.map(qty => {\n    const calculo = calcularPrecoReceita(receita, valorHora, margem, qty)\n    const precoPorUnidade = calculo.precoFinal / (receita.rendimento * qty)\n    \n    return {\n      quantidade: qty,\n      custoTotal: calculo.custoTotal,\n      precoTotal: calculo.precoFinal,\n      precoPorUnidade: Math.ceil(precoPorUnidade * 2) / 2,\n      economiaPercentual: qty > 1 ? \n        ((quantidades[0] && calcularPrecoReceita(receita, valorHora, margem, 1).precoFinal / receita.rendimento) - precoPorUnidade) / \n        (quantidades[0] && calcularPrecoReceita(receita, valorHora, margem, 1).precoFinal / receita.rendimento) * 100 : 0\n    }\n  })\n}\n\n// Função para validar se os preços estão corretos\nexport function validarCalculos(calculo: CalculoDetalhes): {\n  valido: boolean\n  erros: string[]\n  avisos: string[]\n} {\n  const erros: string[] = []\n  const avisos: string[] = []\n  \n  // Validações de erro\n  if (calculo.custoIngredientes <= 0) {\n    erros.push('Custo de ingredientes deve ser maior que zero')\n  }\n  \n  if (calculo.custoMaoDeObra <= 0) {\n    erros.push('Custo de mão de obra deve ser maior que zero')\n  }\n  \n  if (calculo.margemLucro < 0) {\n    erros.push('Margem de lucro não pode ser negativa')\n  }\n  \n  // Validações de aviso\n  if (calculo.margemLucro < 0.20) {\n    avisos.push('Margem de lucro muito baixa (menos de 20%)')\n  }\n  \n  if (calculo.custoMaoDeObra > calculo.custoIngredientes * 2) {\n    avisos.push('Custo de mão de obra muito alto comparado aos ingredientes')\n  }\n  \n  if (calculo.margemLucro > 1.5) {\n    avisos.push('Margem de lucro muito alta (mais de 150%) - pode afetar competitividade')\n  }\n  \n  return {\n    valido: erros.length === 0,\n    erros,\n    avisos\n  }\n}\n\n// Utilitários para formatação\nexport function formatarMoeda(valor: number): string {\n  return new Intl.NumberFormat('pt-BR', {\n    style: 'currency',\n    currency: 'BRL'\n  }).format(valor)\n}\n\nexport function formatarPercentual(valor: number): string {\n  return new Intl.NumberFormat('pt-BR', {\n    style: 'percent',\n    minimumFractionDigits: 1,\n    maximumFractionDigits: 1\n  }).format(valor)\n}\n\nexport function formatarQuantidade(quantidade: number, unidade: string): string {\n  if (unidade === 'unidades') {\n    return `${quantidade} un`\n  }\n  \n  if (quantidade >= 1000 && unidade === 'g') {\n    return `${(quantidade / 1000).toFixed(2)} kg`\n  }\n  \n  if (quantidade >= 1000 && unidade === 'ml') {\n    return `${(quantidade / 1000).toFixed(2)} L`\n  }\n  \n  return `${quantidade} ${unidade}`\n}","size_bytes":8107},"lib/database-types.ts":{"content":"export type Json =\n  | string\n  | number\n  | boolean\n  | null\n  | { [key: string]: Json | undefined }\n  | Json[]\n\nexport interface Database {\n  public: {\n    Tables: {\n      profiles: {\n        Row: {\n          id: string\n          nome: string\n          email: string | null\n          plano: 'free' | 'pro'\n          valor_hora: number\n          margem_padrao: number\n          created_at: string\n          updated_at: string\n        }\n        Insert: {\n          id: string\n          nome: string\n          email?: string | null\n          plano?: 'free' | 'pro'\n          valor_hora?: number\n          margem_padrao?: number\n          created_at?: string\n          updated_at?: string\n        }\n        Update: {\n          id?: string\n          nome?: string\n          email?: string | null\n          plano?: 'free' | 'pro'\n          valor_hora?: number\n          margem_padrao?: number\n          created_at?: string\n          updated_at?: string\n        }\n      }\n      categorias_ingredientes: {\n        Row: {\n          id: string\n          user_id: string\n          nome: string\n          cor: string\n          icone: string\n          created_at: string\n        }\n        Insert: {\n          id?: string\n          user_id: string\n          nome: string\n          cor?: string\n          icone?: string\n          created_at?: string\n        }\n        Update: {\n          id?: string\n          user_id?: string\n          nome?: string\n          cor?: string\n          icone?: string\n          created_at?: string\n        }\n      }\n      ingredientes: {\n        Row: {\n          id: string\n          user_id: string\n          nome: string\n          categoria_id: string | null\n          preco_kg: number\n          unidade: 'g' | 'ml' | 'unidades'\n          densidade: number\n          ativo: boolean\n          created_at: string\n          updated_at: string\n        }\n        Insert: {\n          id?: string\n          user_id: string\n          nome: string\n          categoria_id?: string | null\n          preco_kg: number\n          unidade?: 'g' | 'ml' | 'unidades'\n          densidade?: number\n          ativo?: boolean\n          created_at?: string\n          updated_at?: string\n        }\n        Update: {\n          id?: string\n          user_id?: string\n          nome?: string\n          categoria_id?: string | null\n          preco_kg?: number\n          unidade?: 'g' | 'ml' | 'unidades'\n          densidade?: number\n          ativo?: boolean\n          created_at?: string\n          updated_at?: string\n        }\n      }\n      receitas: {\n        Row: {\n          id: string\n          user_id: string\n          nome: string\n          descricao: string | null\n          tempo_producao: number\n          complexidade: 'simples' | 'media' | 'complexa'\n          rendimento: number\n          imagem_url: string | null\n          categoria: string\n          ativa: boolean\n          custo_calculado: number | null\n          preco_sugerido: number | null\n          created_at: string\n          updated_at: string\n        }\n        Insert: {\n          id?: string\n          user_id: string\n          nome: string\n          descricao?: string | null\n          tempo_producao?: number\n          complexidade?: 'simples' | 'media' | 'complexa'\n          rendimento?: number\n          imagem_url?: string | null\n          categoria?: string\n          ativa?: boolean\n          custo_calculado?: number | null\n          preco_sugerido?: number | null\n          created_at?: string\n          updated_at?: string\n        }\n        Update: {\n          id?: string\n          user_id?: string\n          nome?: string\n          descricao?: string | null\n          tempo_producao?: number\n          complexidade?: 'simples' | 'media' | 'complexa'\n          rendimento?: number\n          imagem_url?: string | null\n          categoria?: string\n          ativa?: boolean\n          custo_calculado?: number | null\n          preco_sugerido?: number | null\n          created_at?: string\n          updated_at?: string\n        }\n      }\n      receita_ingredientes: {\n        Row: {\n          id: string\n          receita_id: string\n          ingrediente_id: string\n          quantidade: number\n          created_at: string\n        }\n        Insert: {\n          id?: string\n          receita_id: string\n          ingrediente_id: string\n          quantidade: number\n          created_at?: string\n        }\n        Update: {\n          id?: string\n          receita_id?: string\n          ingrediente_id?: string\n          quantidade?: number\n          created_at?: string\n        }\n      }\n      calculos_salvos: {\n        Row: {\n          id: string\n          user_id: string\n          receita_id: string\n          quantidade_produzida: number\n          preco_unitario: number\n          preco_total: number\n          detalhes: Json\n          created_at: string\n        }\n        Insert: {\n          id?: string\n          user_id: string\n          receita_id: string\n          quantidade_produzida: number\n          preco_unitario: number\n          preco_total: number\n          detalhes: Json\n          created_at?: string\n        }\n        Update: {\n          id?: string\n          user_id?: string\n          receita_id?: string\n          quantidade_produzida?: number\n          preco_unitario?: number\n          preco_total?: number\n          detalhes?: Json\n          created_at?: string\n        }\n      }\n      orcamentos: {\n        Row: {\n          id: string\n          user_id: string\n          cliente_nome: string\n          cliente_contato: string | null\n          itens: Json\n          valor_total: number\n          status: 'pendente' | 'aprovado' | 'rejeitado' | 'concluido'\n          observacoes: string | null\n          valido_ate: string | null\n          created_at: string\n          updated_at: string\n        }\n        Insert: {\n          id?: string\n          user_id: string\n          cliente_nome: string\n          cliente_contato?: string | null\n          itens: Json\n          valor_total: number\n          status?: 'pendente' | 'aprovado' | 'rejeitado' | 'concluido'\n          observacoes?: string | null\n          valido_ate?: string | null\n          created_at?: string\n          updated_at?: string\n        }\n        Update: {\n          id?: string\n          user_id?: string\n          cliente_nome?: string\n          cliente_contato?: string | null\n          itens?: Json\n          valor_total?: number\n          status?: 'pendente' | 'aprovado' | 'rejeitado' | 'concluido'\n          observacoes?: string | null\n          valido_ate?: string | null\n          created_at?: string\n          updated_at?: string\n        }\n      }\n    }\n    Views: {\n      [_ in never]: never\n    }\n    Functions: {\n      [_ in never]: never\n    }\n    Enums: {\n      [_ in never]: never\n    }\n  }\n}\n\n// Tipos derivados para uso na aplicação\nexport type Profile = Database['public']['Tables']['profiles']['Row']\nexport type Receita = Database['public']['Tables']['receitas']['Row']\nexport type Ingrediente = Database['public']['Tables']['ingredientes']['Row']\nexport type CategoriaIngrediente = Database['public']['Tables']['categorias_ingredientes']['Row']\nexport type ReceitaIngrediente = Database['public']['Tables']['receita_ingredientes']['Row']\nexport type CalculoSalvo = Database['public']['Tables']['calculos_salvos']['Row']\nexport type Orcamento = Database['public']['Tables']['orcamentos']['Row']\n\n// Tipos compostos para uso na aplicação\nexport type ReceitaCompleta = Receita & {\n  // Adicionar aliases para compatibilidade com a calculadora\n  tempo_preparo: number\n  receita_ingredientes: (ReceitaIngrediente & {\n    ingredientes: Ingrediente & {\n      preco_por_unidade: number // Alias para preco_kg\n      user_id: string // Campo adicional para compatibilidade\n    }\n  })[]\n}\n\nexport type CalculoDetalhes = {\n  custoIngredientes: number\n  custoMaoDeObra: number\n  custosFixos: number\n  custoTotal: number\n  margemLucro: number\n  precoFinal: number\n  breakdown: {\n    ingrediente: string\n    quantidade: number\n    custo: number\n  }[]\n}\n\nexport type ItemOrcamento = {\n  receita_id: string\n  nome: string\n  quantidade: number\n  preco_unitario: number\n  preco_total: number\n}","size_bytes":8172},"lib/db.ts":{"content":"import { drizzle } from 'drizzle-orm/postgres-js'\nimport postgres from 'postgres'\nimport * as schema from \"@/lib/schema\"\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  )\n}\n\n// Create the connection\nconst client = postgres(process.env.DATABASE_URL, { \n  ssl: process.env.NODE_ENV === 'production' ? 'require' : 'prefer',\n  max: 1 \n})\nexport const db = drizzle(client, { schema })","size_bytes":459},"lib/schema.ts":{"content":"import { pgTable, serial, varchar, text, timestamp, boolean, numeric, integer } from 'drizzle-orm/pg-core'\nimport { relations } from 'drizzle-orm'\n\n// Tabela de usuários (profiles)\nexport const profiles = pgTable('profiles', {\n  id: varchar('id').primaryKey(), // UUID\n  email: varchar('email').notNull().unique(),\n  nome: varchar('nome').notNull(),\n  password: varchar('password').notNull(), // Hash da senha\n  plano: varchar('plano').notNull().default('free'), // 'free' ou 'pro'\n  taxa_horaria: numeric('taxa_horaria', { precision: 10, scale: 2 }).default('25.00'),\n  margem_lucro: numeric('margem_lucro', { precision: 5, scale: 2 }).default('30.00'),\n  created_at: timestamp('created_at').defaultNow(),\n  updated_at: timestamp('updated_at').defaultNow(),\n})\n\n// Tabela de ingredientes\nexport const ingredientes = pgTable('ingredientes', {\n  id: serial('id').primaryKey(),\n  user_id: varchar('user_id').notNull().references(() => profiles.id, { onDelete: 'cascade' }),\n  nome: varchar('nome').notNull(),\n  categoria: varchar('categoria').notNull().default('outros'),\n  preco: numeric('preco', { precision: 10, scale: 2 }).notNull(),\n  unidade: varchar('unidade').notNull().default('unidade'),\n  observacoes: text('observacoes'),\n  created_at: timestamp('created_at').defaultNow(),\n  updated_at: timestamp('updated_at').defaultNow(),\n})\n\n// Tabela de receitas\nexport const receitas = pgTable('receitas', {\n  id: serial('id').primaryKey(),\n  user_id: varchar('user_id').notNull().references(() => profiles.id, { onDelete: 'cascade' }),\n  nome: varchar('nome').notNull(),\n  descricao: text('descricao'),\n  rendimento: integer('rendimento').notNull().default(1),\n  tempo_preparo: integer('tempo_preparo').notNull().default(60), // em minutos\n  complexidade: integer('complexidade').notNull().default(1), // 1-5\n  categoria: varchar('categoria').notNull().default('doces'),\n  created_at: timestamp('created_at').defaultNow(),\n  updated_at: timestamp('updated_at').defaultNow(),\n})\n\n// Tabela de ingredientes das receitas\nexport const receita_ingredientes = pgTable('receita_ingredientes', {\n  id: serial('id').primaryKey(),\n  receita_id: integer('receita_id').notNull().references(() => receitas.id, { onDelete: 'cascade' }),\n  ingrediente_id: integer('ingrediente_id').notNull().references(() => ingredientes.id, { onDelete: 'cascade' }),\n  quantidade: numeric('quantidade', { precision: 10, scale: 3 }).notNull(),\n  unidade: varchar('unidade').notNull(),\n})\n\n// Relations\nexport const profilesRelations = relations(profiles, ({ many }) => ({\n  ingredientes: many(ingredientes),\n  receitas: many(receitas),\n}))\n\nexport const ingredientesRelations = relations(ingredientes, ({ one, many }) => ({\n  user: one(profiles, {\n    fields: [ingredientes.user_id],\n    references: [profiles.id],\n  }),\n  receita_ingredientes: many(receita_ingredientes),\n}))\n\nexport const receitasRelations = relations(receitas, ({ one, many }) => ({\n  user: one(profiles, {\n    fields: [receitas.user_id],\n    references: [profiles.id],\n  }),\n  ingredientes: many(receita_ingredientes),\n}))\n\nexport const receitaIngredientesRelations = relations(receita_ingredientes, ({ one }) => ({\n  receita: one(receitas, {\n    fields: [receita_ingredientes.receita_id],\n    references: [receitas.id],\n  }),\n  ingrediente: one(ingredientes, {\n    fields: [receita_ingredientes.ingrediente_id],\n    references: [ingredientes.id],\n  }),\n}))\n\n// Types\nexport type Profile = typeof profiles.$inferSelect\nexport type InsertProfile = typeof profiles.$inferInsert\nexport type Ingrediente = typeof ingredientes.$inferSelect\nexport type InsertIngrediente = typeof ingredientes.$inferInsert\nexport type Receita = typeof receitas.$inferSelect\nexport type InsertReceita = typeof receitas.$inferInsert","size_bytes":3749},"lib/supabase-client.ts":{"content":"import { createClientComponentClient } from '@supabase/auth-helpers-nextjs'\nimport { Database } from '@/lib/database-types'\n\n// Client Component (para use no navegador)\nexport const supabase = createClientComponentClient<Database>()\n\n// Utility functions para auth\nexport const getCurrentUser = async () => {\n  const { data: { user } } = await supabase.auth.getUser()\n  return user\n}\n\nexport const signOut = async () => {\n  await supabase.auth.signOut()\n}\n\n// Helper para upload de imagens\nexport const uploadImage = async (file: File, bucket: string, path: string) => {\n  const { data, error } = await supabase.storage\n    .from(bucket)\n    .upload(path, file, {\n      upsert: true\n    })\n  \n  if (error) throw error\n  \n  const { data: { publicUrl } } = supabase.storage\n    .from(bucket)\n    .getPublicUrl(path)\n    \n  return publicUrl\n}\n\n// Helper para buscar perfil do usuário\nexport const getUserProfile = async (userId: string) => {\n  const { data, error } = await supabase\n    .from('profiles')\n    .select('*')\n    .eq('id', userId)\n    .single()\n    \n  if (error && error.code !== 'PGRST116') throw error\n  return data\n}\n\n// Helper para atualizar perfil\nexport const updateUserProfile = async (userId: string, updates: any) => {\n  const { data, error } = await supabase\n    .from('profiles')\n    .update(updates)\n    .eq('id', userId)\n    .select()\n    .single()\n    \n  if (error) throw error\n  return data\n}","size_bytes":1418},"lib/utils-lib.ts":{"content":"import { type ClassValue, clsx } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n\n// Debounce function\nexport function debounce<T extends (...args: any[]) => any>(\n  func: T,\n  wait: number\n): (...args: Parameters<T>) => void {\n  let timeout: NodeJS.Timeout | null = null\n  return (...args: Parameters<T>) => {\n    if (timeout) clearTimeout(timeout)\n    timeout = setTimeout(() => func(...args), wait)\n  }\n}\n\n// Slugify function para URLs amigáveis\nexport function slugify(text: string): string {\n  return text\n    .toString()\n    .normalize('NFD')\n    .replace(/[\\u0300-\\u036f]/g, '')\n    .toLowerCase()\n    .trim()\n    .replace(/\\s+/g, '-')\n    .replace(/[^\\w\\-]+/g, '')\n    .replace(/\\-\\-+/g, '-')\n    .replace(/^-+/, '')\n    .replace(/-+$/, '')\n}\n\n// Validar email\nexport function isValidEmail(email: string): boolean {\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/\n  return emailRegex.test(email)\n}\n\n// Validar telefone brasileiro\nexport function isValidPhoneBR(phone: string): boolean {\n  const phoneRegex = /^(\\+55\\s?)?(\\(?[1-9][1-9]\\)?\\s?)?(\\d{4,5}-?\\d{4})$/\n  return phoneRegex.test(phone.replace(/\\s/g, ''))\n}\n\n// Formatar telefone brasileiro\nexport function formatPhoneBR(phone: string): string {\n  const cleaned = phone.replace(/\\D/g, '')\n  \n  if (cleaned.length === 11) {\n    return cleaned.replace(/(\\d{2})(\\d{5})(\\d{4})/, '($1) $2-$3')\n  }\n  \n  if (cleaned.length === 10) {\n    return cleaned.replace(/(\\d{2})(\\d{4})(\\d{4})/, '($1) $2-$3')\n  }\n  \n  return phone\n}\n\n// Formatar CPF\nexport function formatCPF(cpf: string): string {\n  const cleaned = cpf.replace(/\\D/g, '')\n  return cleaned.replace(/(\\d{3})(\\d{3})(\\d{3})(\\d{2})/, '$1.$2.$3-$4')\n}\n\n// Validar CPF\nexport function isValidCPF(cpf: string): boolean {\n  const cleaned = cpf.replace(/\\D/g, '')\n  \n  if (cleaned.length !== 11 || /^(\\d)\\1+$/.test(cleaned)) {\n    return false\n  }\n  \n  let sum = 0\n  for (let i = 0; i < 9; i++) {\n    sum += parseInt(cleaned.charAt(i)) * (10 - i)\n  }\n  \n  let digit = 11 - (sum % 11)\n  if (digit === 10 || digit === 11) digit = 0\n  \n  if (digit !== parseInt(cleaned.charAt(9))) return false\n  \n  sum = 0\n  for (let i = 0; i < 10; i++) {\n    sum += parseInt(cleaned.charAt(i)) * (11 - i)\n  }\n  \n  digit = 11 - (sum % 11)\n  if (digit === 10 || digit === 11) digit = 0\n  \n  return digit === parseInt(cleaned.charAt(10))\n}\n\n// Capitalizar primeira letra\nexport function capitalize(str: string): string {\n  return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase()\n}\n\n// Capitalizar primeira letra de cada palavra\nexport function capitalizeWords(str: string): string {\n  return str.replace(/\\w\\S*/g, (txt) => \n    txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase()\n  )\n}\n\n// Truncar texto\nexport function truncate(str: string, length: number = 100): string {\n  if (str.length <= length) return str\n  return str.substring(0, length).trim() + '...'\n}\n\n// Gerar ID único\nexport function generateId(length: number = 8): string {\n  const chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'\n  let result = ''\n  for (let i = 0; i < length; i++) {\n    result += chars.charAt(Math.floor(Math.random() * chars.length))\n  }\n  return result\n}\n\n// Calcular tempo de leitura\nexport function calculateReadingTime(text: string): number {\n  const wordsPerMinute = 200\n  const words = text.trim().split(/\\s+/).length\n  return Math.ceil(words / wordsPerMinute)\n}\n\n// Converter bytes para formato legível\nexport function formatBytes(bytes: number, decimals: number = 2): string {\n  if (bytes === 0) return '0 Bytes'\n  \n  const k = 1024\n  const dm = decimals < 0 ? 0 : decimals\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB']\n  \n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  \n  return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i]\n}\n\n// Aguardar por um tempo específico\nexport function sleep(ms: number): Promise<void> {\n  return new Promise(resolve => setTimeout(resolve, ms))\n}\n\n// Copiar texto para clipboard\nexport async function copyToClipboard(text: string): Promise<boolean> {\n  try {\n    await navigator.clipboard.writeText(text)\n    return true\n  } catch (err) {\n    // Fallback para navegadores antigos\n    const textArea = document.createElement('textarea')\n    textArea.value = text\n    textArea.style.position = 'fixed'\n    textArea.style.left = '-999999px'\n    textArea.style.top = '-999999px'\n    document.body.appendChild(textArea)\n    textArea.focus()\n    textArea.select()\n    \n    try {\n      const successful = document.execCommand('copy')\n      document.body.removeChild(textArea)\n      return successful\n    } catch (err) {\n      document.body.removeChild(textArea)\n      return false\n    }\n  }\n}\n\n// Scroll suave para elemento\nexport function scrollToElement(elementId: string, offset: number = 0): void {\n  const element = document.getElementById(elementId)\n  if (element) {\n    const top = element.offsetTop - offset\n    window.scrollTo({\n      top,\n      behavior: 'smooth'\n    })\n  }\n}\n\n// Detectar dispositivo mobile\nexport function isMobile(): boolean {\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n    navigator.userAgent\n  )\n}\n\n// Obter informações do dispositivo\nexport function getDeviceInfo() {\n  const ua = navigator.userAgent\n  return {\n    isMobile: isMobile(),\n    isTablet: /iPad|Android(?=.*Mobile)/i.test(ua),\n    isDesktop: !isMobile(),\n    browser: getBrowserName(),\n    os: getOperatingSystem()\n  }\n}\n\nfunction getBrowserName(): string {\n  const ua = navigator.userAgent\n  if (ua.includes('Chrome')) return 'Chrome'\n  if (ua.includes('Firefox')) return 'Firefox'\n  if (ua.includes('Safari')) return 'Safari'\n  if (ua.includes('Edge')) return 'Edge'\n  return 'Unknown'\n}\n\nfunction getOperatingSystem(): string {\n  const ua = navigator.userAgent\n  if (ua.includes('Windows')) return 'Windows'\n  if (ua.includes('Mac')) return 'macOS'\n  if (ua.includes('Linux')) return 'Linux'\n  if (ua.includes('Android')) return 'Android'\n  if (ua.includes('iOS')) return 'iOS'\n  return 'Unknown'\n}\n\n// Validar se um objeto está vazio\nexport function isEmpty(obj: any): boolean {\n  if (obj == null) return true\n  if (Array.isArray(obj)) return obj.length === 0\n  if (typeof obj === 'object') return Object.keys(obj).length === 0\n  if (typeof obj === 'string') return obj.trim().length === 0\n  return false\n}\n\n// Remover acentos de string\nexport function removeAccents(str: string): string {\n  return str.normalize('NFD').replace(/[\\u0300-\\u036f]/g, '')\n}\n\n// Filtrar array por busca de texto\nexport function filterBySearch<T>(\n  items: T[],\n  searchTerm: string,\n  searchFields: (keyof T)[]\n): T[] {\n  if (!searchTerm.trim()) return items\n  \n  const normalizedSearch = removeAccents(searchTerm.toLowerCase())\n  \n  return items.filter(item =>\n    searchFields.some(field => {\n      const value = item[field]\n      if (typeof value === 'string') {\n        return removeAccents(value.toLowerCase()).includes(normalizedSearch)\n      }\n      return false\n    })\n  )\n}\n\n// Agrupar array por campo\nexport function groupBy<T, K extends keyof T>(\n  items: T[],\n  key: K\n): Record<string, T[]> {\n  return items.reduce((groups, item) => {\n    const groupKey = String(item[key])\n    if (!groups[groupKey]) {\n      groups[groupKey] = []\n    }\n    groups[groupKey].push(item)\n    return groups\n  }, {} as Record<string, T[]>)\n}\n\n// Ordenar array por múltiplos campos\nexport function sortBy<T>(\n  items: T[],\n  ...sortKeys: { key: keyof T; direction?: 'asc' | 'desc' }[]\n): T[] {\n  return [...items].sort((a, b) => {\n    for (const { key, direction = 'asc' } of sortKeys) {\n      const aVal = a[key]\n      const bVal = b[key]\n      \n      if (aVal < bVal) return direction === 'asc' ? -1 : 1\n      if (aVal > bVal) return direction === 'asc' ? 1 : -1\n    }\n    return 0\n  })\n}","size_bytes":7864},"lib/utils.ts":{"content":"import { type ClassValue, clsx } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n\nexport function isValidEmail(email: string): boolean {\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/\n  return emailRegex.test(email)\n}","size_bytes":305},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@/lib/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });\n","size_bytes":481},"app/dashboard/page.tsx":{"content":"'use client'\n\nimport { useAuth } from '@/components/auth/local-auth-provider'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport Link from 'next/link'\nimport { \n  Calculator, \n  ChefHat, \n  TrendingUp, \n  DollarSign, \n  Clock,\n  ArrowRight,\n  Crown,\n  Plus,\n  BarChart3,\n  Zap,\n  Target,\n  Package,\n  FileText,\n  Users\n} from 'lucide-react'\nimport { useEffect, useState } from 'react'\nimport { formatarMoeda } from '@/lib/calculations-lib'\n\ninterface DashboardStats {\n  totalReceitas: number\n  receitasAtivas: number\n  ultimoCalculoValor: number | null\n  mediaMargemLucro: number\n  totalIngredientes: number\n  ingredientesAtivos: number\n  totalOrcamentos: number\n  valorTotalOrcamentos: number\n  orcamentosPendentes: number\n}\n\nexport default function DashboardPage() {\n  const { user } = useAuth()\n  const [stats, setStats] = useState<DashboardStats>({\n    totalReceitas: 0,\n    receitasAtivas: 0,\n    ultimoCalculoValor: null,\n    mediaMargemLucro: 0,\n    totalIngredientes: 0,\n    ingredientesAtivos: 0,\n    totalOrcamentos: 0,\n    valorTotalOrcamentos: 0,\n    orcamentosPendentes: 0\n  })\n  const [loading, setLoading] = useState(true)\n\n  const isPro = user?.plano === 'pro'\n\n  useEffect(() => {\n    if (user) {\n      loadDashboardData()\n    }\n  }, [user])\n\n  const loadDashboardData = async () => {\n    try {\n      // TODO: Implementar carregamento de dados usando nossa API local\n      // Por enquanto, usando dados mock para demonstrar funcionalidade\n      setStats({\n        totalReceitas: 5,\n        receitasAtivas: 3,\n        ultimoCalculoValor: 45.50,\n        mediaMargemLucro: 30,\n        totalIngredientes: 12,\n        ingredientesAtivos: 10,\n        totalOrcamentos: 3,\n        valorTotalOrcamentos: 230.75,\n        orcamentosPendentes: 1\n      })\n    } catch (error) {\n      console.error('Erro ao carregar dados do dashboard:', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const quickActions = [\n    {\n      title: 'Calcular Preço',\n      description: 'Calcule o preço de uma receita',\n      icon: Calculator,\n      href: '/dashboard/calculadora',\n      color: 'bg-primary',\n      highlight: true\n    },\n    {\n      title: 'Nova Receita',\n      description: 'Cadastre uma nova receita',\n      icon: Plus,\n      href: '/dashboard/receitas?action=new',\n      color: 'bg-green-500'\n    },\n    {\n      title: 'Ver Receitas',\n      description: 'Gerenciar suas receitas',\n      icon: ChefHat,\n      href: '/dashboard/receitas',\n      color: 'bg-blue-500'\n    },\n    {\n      title: 'Relatórios',\n      description: 'Análises do seu negócio',\n      icon: BarChart3,\n      href: '/dashboard/relatorios',\n      color: 'bg-purple-500',\n      isPro: true\n    },\n  ]\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-primary\"></div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"space-y-8\">\n      {/* Header */}\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n        <div>\n          <h1 className=\"text-3xl font-display font-bold text-gray-900\">\n            Olá, {user?.nome?.split(' ')[0]}! 👋\n          </h1>\n          <p className=\"text-gray-600 mt-1\">\n            Bem-vinda ao seu painel de controle\n          </p>\n        </div>\n        <div className=\"flex items-center gap-3\">\n          <Badge variant={isPro ? \"default\" : \"secondary\"} className=\"flex items-center gap-1\">\n            {isPro ? <Crown className=\"h-3 w-3\" /> : null}\n            {isPro ? 'Plano PRO' : 'Plano Gratuito'}\n          </Badge>\n          {!isPro && (\n            <Link href=\"/dashboard/upgrade\">\n              <Button size=\"sm\" className=\"bg-gradient-doce\">\n                <Crown className=\"h-4 w-4 mr-2\" />\n                Fazer Upgrade\n              </Button>\n            </Link>\n          )}\n        </div>\n      </div>\n\n      {/* Stats Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Receitas</CardTitle>\n            <ChefHat className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{stats.totalReceitas}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              {stats.receitasAtivas} ativas\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Ingredientes</CardTitle>\n            <Package className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{stats.totalIngredientes}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              {stats.ingredientesAtivos} em estoque\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Último Cálculo</CardTitle>\n            <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">\n              {stats.ultimoCalculoValor ? formatarMoeda(stats.ultimoCalculoValor) : 'N/A'}\n            </div>\n            <p className=\"text-xs text-muted-foreground\">\n              Margem: {stats.mediaMargemLucro}%\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Orçamentos</CardTitle>\n            <FileText className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{stats.totalOrcamentos}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              {stats.orcamentosPendentes} pendentes\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Quick Actions */}\n      <div>\n        <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">Ações Rápidas</h2>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n          {quickActions.map((action) => {\n            const Icon = action.icon\n            const isProFeature = action.isPro && !isPro\n            \n            return (\n              <Link key={action.title} href={isProFeature ? '/dashboard/upgrade' : action.href}>\n                <Card className={`cursor-pointer transition-all duration-200 hover:shadow-md ${\n                  action.highlight ? 'ring-2 ring-primary ring-opacity-20' : ''\n                } ${isProFeature ? 'opacity-60' : ''}`}>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center space-x-4\">\n                      <div className={`flex-shrink-0 p-3 rounded-lg ${action.color} text-white`}>\n                        <Icon className=\"h-6 w-6\" />\n                      </div>\n                      <div className=\"flex-1\">\n                        <h3 className=\"font-semibold text-gray-900 flex items-center gap-2\">\n                          {action.title}\n                          {isProFeature && <Crown className=\"h-4 w-4 text-primary\" />}\n                        </h3>\n                        <p className=\"text-sm text-gray-600\">{action.description}</p>\n                        {isProFeature && (\n                          <Badge variant=\"secondary\" className=\"mt-2 text-xs\">\n                            PRO\n                          </Badge>\n                        )}\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </Link>\n            )\n          })}\n        </div>\n      </div>\n\n      {/* Recent Activity */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n        <Card>\n          <CardHeader>\n            <CardTitle>Receitas Recentes</CardTitle>\n            <CardDescription>Suas últimas receitas cadastradas</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <div className=\"text-sm text-gray-600 p-4 rounded-lg bg-gray-50\">\n              Você ainda não tem receitas cadastradas. \n              <Link href=\"/dashboard/receitas\" className=\"text-primary hover:underline ml-1\">\n                Cadastre sua primeira receita\n              </Link>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Tips & Dicas</CardTitle>\n            <CardDescription>Maximize seus lucros</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"flex items-start space-x-3\">\n              <div className=\"flex-shrink-0 w-2 h-2 rounded-full bg-primary mt-2\"></div>\n              <div>\n                <p className=\"text-sm font-medium\">Calcule sua margem ideal</p>\n                <p className=\"text-xs text-gray-600\">Mantenha entre 30-50% para garantir lucro</p>\n              </div>\n            </div>\n            <div className=\"flex items-start space-x-3\">\n              <div className=\"flex-shrink-0 w-2 h-2 rounded-full bg-primary mt-2\"></div>\n              <div>\n                <p className=\"text-sm font-medium\">Atualize preços regularmente</p>\n                <p className=\"text-xs text-gray-600\">Ingredientes podem variar de preço</p>\n              </div>\n            </div>\n            <div className=\"flex items-start space-x-3\">\n              <div className=\"flex-shrink-0 w-2 h-2 rounded-full bg-primary mt-2\"></div>\n              <div>\n                <p className=\"text-sm font-medium\">Use o plano PRO</p>\n                <p className=\"text-xs text-gray-600\">Acesse relatórios e recursos avançados</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  )\n}","size_bytes":10369},"components/auth/auth-provider.tsx":{"content":"'use client'\n\nimport { createContext, useContext, useEffect, useState } from 'react'\nimport { User } from '@supabase/supabase-js'\nimport { supabase, getUserProfile } from '@/lib/supabase-client'\nimport { useRouter } from 'next/navigation'\n\ntype Profile = {\n  id: string\n  nome: string\n  email?: string\n  plano: 'free' | 'pro'\n  valor_hora: number\n  margem_padrao: number\n  created_at: string\n  updated_at: string\n}\n\ntype AuthContextType = {\n  user: User | null\n  profile: Profile | null\n  loading: boolean\n  signOut: () => Promise<void>\n  signUp: (email: string, password: string, nome: string) => Promise<void>\n  signIn: (email: string, password: string) => Promise<void>\n}\n\nconst AuthContext = createContext<AuthContextType>({\n  user: null,\n  profile: null,\n  loading: true,\n  signOut: async () => {},\n  signUp: async () => {},\n  signIn: async () => {},\n})\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const [user, setUser] = useState<User | null>(null)\n  const [profile, setProfile] = useState<Profile | null>(null)\n  const [loading, setLoading] = useState(true)\n  const router = useRouter()\n\n  useEffect(() => {\n    // Get initial session\n    const getInitialSession = async () => {\n      const { data: { session } } = await supabase.auth.getSession()\n      const currentUser = session?.user ?? null\n      setUser(currentUser)\n      \n      if (currentUser) {\n        try {\n          const userProfile = await getUserProfile(currentUser.id)\n          setProfile(userProfile)\n        } catch (error) {\n          console.error('Erro ao carregar perfil:', error)\n        }\n      }\n      \n      setLoading(false)\n    }\n\n    getInitialSession()\n\n    // Listen for auth changes\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(\n      async (event, session) => {\n        const currentUser = session?.user ?? null\n        setUser(currentUser)\n        \n        if (currentUser) {\n          try {\n            const userProfile = await getUserProfile(currentUser.id)\n            setProfile(userProfile)\n          } catch (error) {\n            console.error('Erro ao carregar perfil:', error)\n            setProfile(null)\n          }\n        } else {\n          setProfile(null)\n        }\n        \n        setLoading(false)\n\n        if (event === 'SIGNED_IN') {\n          router.push('/dashboard')\n        } else if (event === 'SIGNED_OUT') {\n          router.push('/')\n        }\n      }\n    )\n\n    return () => subscription.unsubscribe()\n  }, [router])\n\n  const signOut = async () => {\n    await supabase.auth.signOut()\n  }\n\n  const signUp = async (email: string, password: string, nome: string) => {\n    try {\n      const { data, error } = await supabase.auth.signUp({\n        email,\n        password,\n        options: {\n          data: {\n            nome: nome\n          },\n          emailRedirectTo: undefined // Remove verificação de email\n        }\n      })\n\n      if (error) {\n        throw error\n      }\n\n      // Se o usuário foi criado mas precisa de confirmação, vamos fazer login direto\n      if (data.user && !data.session) {\n        // Tentar fazer login direto\n        const { data: signInData, error: signInError } = await supabase.auth.signInWithPassword({\n          email,\n          password\n        })\n        \n        if (signInError) {\n          console.error('Erro no login automático:', signInError)\n          throw new Error('Conta criada! Tente fazer login.')\n        }\n      }\n\n      // Criar perfil do usuário na tabela profiles\n      const userId = data.user?.id || data.session?.user?.id\n      if (userId) {\n        const { error: profileError } = await supabase\n          .from('profiles')\n          .insert({\n            id: userId,\n            nome: nome,\n            email: email,\n            plano: 'free'\n          })\n\n        if (profileError) {\n          console.error('Erro ao criar perfil:', profileError)\n        }\n      }\n    } catch (error) {\n      console.error('Erro no cadastro:', error)\n      throw error\n    }\n  }\n\n  const signIn = async (email: string, password: string) => {\n    try {\n      const { error } = await supabase.auth.signInWithPassword({\n        email,\n        password\n      })\n\n      if (error) {\n        throw error\n      }\n    } catch (error) {\n      console.error('Erro no login:', error)\n      throw error\n    }\n  }\n\n  return (\n    <AuthContext.Provider value={{ user, profile, loading, signOut, signUp, signIn }}>\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext)\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider')\n  }\n  return context\n}","size_bytes":4680},"components/auth/local-auth-provider.tsx":{"content":"'use client'\n\nimport { createContext, useContext, useEffect, useState } from 'react'\nimport { useRouter } from 'next/navigation'\n\ntype User = {\n  id: string\n  nome: string\n  email: string\n  plano: string\n}\n\ntype AuthContextType = {\n  user: User | null\n  loading: boolean\n  signOut: () => void\n  signUp: (email: string, password: string, nome: string) => Promise<void>\n  signIn: (email: string, password: string) => Promise<void>\n}\n\nconst AuthContext = createContext<AuthContextType>({\n  user: null,\n  loading: true,\n  signOut: () => {},\n  signUp: async () => {},\n  signIn: async () => {},\n})\n\nexport function LocalAuthProvider({ children }: { children: React.ReactNode }) {\n  const [user, setUser] = useState<User | null>(null)\n  const [loading, setLoading] = useState(true)\n  const router = useRouter()\n\n  useEffect(() => {\n    // Verificar se usuário está logado - só no lado cliente\n    const checkAuth = () => {\n      try {\n        // Garantir que estamos no lado cliente\n        if (typeof window !== 'undefined') {\n          const savedUser = localStorage.getItem('doce_user')\n          if (savedUser) {\n            setUser(JSON.parse(savedUser))\n          }\n        }\n      } catch (error) {\n        console.error('Erro ao verificar autenticação:', error)\n        if (typeof window !== 'undefined') {\n          localStorage.removeItem('doce_user')\n        }\n      } finally {\n        setLoading(false)\n      }\n    }\n\n    checkAuth()\n  }, [])\n\n  const signUp = async (email: string, password: string, nome: string) => {\n    try {\n      setLoading(true)\n      \n      // Chamada para API de cadastro\n      const response = await fetch('/api/auth/register', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ email, password, nome }),\n      })\n      \n      const data = await response.json()\n      \n      if (!response.ok) {\n        throw new Error(data.error || 'Erro no cadastro')\n      }\n      \n      // Salvar usuário e token\n      const userForState = data.user\n      setUser(userForState)\n      \n      if (typeof window !== 'undefined') {\n        localStorage.setItem('doce_user', JSON.stringify(userForState))\n        localStorage.setItem('doce_token', data.token)\n        // Definir cookie também para o middleware (sem secure para funcionar em desenvolvimento)\n        document.cookie = `doce_token=${data.token}; path=/; max-age=${7 * 24 * 60 * 60}; samesite=lax`\n      }\n      \n      // Redirecionar para dashboard\n      router.push('/dashboard')\n    } catch (error) {\n      console.error('Erro no cadastro:', error)\n      throw error\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const signIn = async (email: string, password: string) => {\n    console.log('🚀 signIn chamado com:', { email })\n    \n    try {\n      setLoading(true)\n      \n      console.log('🔄 LocalAuthProvider: Iniciando login...')\n      \n      // Chamada para API de login\n      console.log('📡 Fazendo fetch para /api/auth/login')\n      const response = await fetch('/api/auth/login', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ email, password }),\n      })\n      \n      console.log('📥 Resposta recebida, status:', response.status)\n      const data = await response.json()\n      console.log('📄 Data recebida:', data)\n      \n      if (!response.ok || !data.success) {\n        console.log('❌ Erro na resposta')\n        throw new Error(data.error || 'Erro no login')\n      }\n      \n      // Salvar usuário e token\n      const userForState = {\n        id: data.user.id,\n        nome: data.user.nome,\n        email: data.user.email,\n        plano: data.user.plano || 'free'\n      }\n      \n      console.log('💾 Definindo usuário:', userForState)\n      setUser(userForState)\n      \n      if (typeof window !== 'undefined') {\n        localStorage.setItem('doce_user', JSON.stringify(userForState))\n        localStorage.setItem('doce_token', data.token)\n        // Definir cookie também para o middleware (sem secure para funcionar em desenvolvimento)\n        document.cookie = `doce_token=${data.token}; path=/; max-age=${7 * 24 * 60 * 60}; samesite=lax`\n        console.log('💾 Dados salvos no localStorage e cookie')\n      }\n      \n      console.log('🔄 Redirecionando para /dashboard...')\n      // Redirecionar para dashboard\n      router.push('/dashboard')\n      console.log('✅ Redirecionamento executado')\n    } catch (error) {\n      console.error('💥 LocalAuthProvider: Erro no login:', error)\n      throw error\n    } finally {\n      console.log('🔄 Finalizando (setLoading false)')\n      setLoading(false)\n    }\n  }\n\n  const signOut = () => {\n    if (typeof window !== 'undefined') {\n      localStorage.removeItem('doce_user')\n      localStorage.removeItem('doce_token')\n      // Remover cookie também\n      document.cookie = 'doce_token=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;'\n    }\n    setUser(null)\n    router.push('/')\n  }\n\n  return (\n    <AuthContext.Provider value={{ user, loading, signOut, signUp, signIn }}>\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext)\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider')\n  }\n  return context\n}","size_bytes":5359},"components/auth/simple-auth-provider.tsx":{"content":"'use client'\n\nimport { createContext, useContext, useEffect, useState } from 'react'\nimport { useRouter } from 'next/navigation'\n// Removido import de lib/auth para evitar erro de DATABASE_URL no cliente\n\ntype Profile = {\n  id: string\n  nome: string\n  email: string\n  plano: string\n  taxa_horaria: string\n  margem_lucro: string\n  created_at: Date\n  updated_at: Date\n}\n\ntype AuthContextType = {\n  user: Profile | null\n  loading: boolean\n  signOut: () => void\n  signUp: (email: string, password: string, nome: string) => Promise<void>\n  signIn: (email: string, password: string) => Promise<void>\n}\n\nconst AuthContext = createContext<AuthContextType>({\n  user: null,\n  loading: true,\n  signOut: () => {},\n  signUp: async () => {},\n  signIn: async () => {},\n})\n\nexport function SimpleAuthProvider({ children }: { children: React.ReactNode }) {\n  const [user, setUser] = useState<Profile | null>(null)\n  const [loading, setLoading] = useState(true)\n  const router = useRouter()\n\n  useEffect(() => {\n    // Verificar se usuário está logado\n    const checkAuth = async () => {\n      try {\n        const token = localStorage.getItem('auth_token')\n        if (token) {\n          // Por simplicidade, vamos apenas verificar se o token existe\n          // Em um app real, você validaria o token no servidor\n          try {\n            const payload = JSON.parse(atob(token.split('.')[1]))\n            if (payload.exp * 1000 > Date.now()) {\n              setUser({\n                id: payload.userId,\n                email: payload.email,\n                nome: payload.nome,\n                plano: 'free',\n                taxa_horaria: '25.00',\n                margem_lucro: '30.00',\n                created_at: new Date(),\n                updated_at: new Date()\n              })\n            } else {\n              localStorage.removeItem('auth_token')\n            }\n          } catch {\n            localStorage.removeItem('auth_token')\n          }\n        }\n      } catch (error) {\n        console.error('Erro ao verificar autenticação:', error)\n        localStorage.removeItem('auth_token')\n      } finally {\n        setLoading(false)\n      }\n    }\n\n    checkAuth()\n  }, [])\n\n  const signUp = async (email: string, password: string, nome: string) => {\n    try {\n      setLoading(true)\n      const response = await fetch('/api/auth/register', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email, password, nome })\n      })\n      \n      const result = await response.json()\n      \n      if (!response.ok) {\n        throw new Error(result.error || 'Erro no cadastro')\n      }\n      \n      // Salvar token e usuário\n      localStorage.setItem('auth_token', result.token)\n      setUser(result.user)\n      \n      // Redirecionar para dashboard\n      router.push('/dashboard')\n    } catch (error) {\n      console.error('Erro no cadastro:', error)\n      throw error\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const signIn = async (email: string, password: string) => {\n    try {\n      setLoading(true)\n      const response = await fetch('/api/auth/login', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email, password })\n      })\n      \n      const result = await response.json()\n      \n      if (!response.ok) {\n        throw new Error(result.error || 'Erro no login')\n      }\n      \n      // Salvar token e usuário\n      localStorage.setItem('auth_token', result.token)\n      setUser(result.user)\n      \n      // Redirecionar para dashboard\n      router.push('/dashboard')\n    } catch (error) {\n      console.error('Erro no login:', error)\n      throw error\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const signOut = () => {\n    localStorage.removeItem('auth_token')\n    setUser(null)\n    router.push('/')\n  }\n\n  return (\n    <AuthContext.Provider value={{ user, loading, signOut, signUp, signIn }}>\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext)\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider')\n  }\n  return context\n}","size_bytes":4179},"components/layout/dashboard-layout.tsx":{"content":"'use client'\n\nimport { useAuth } from '@/components/auth/auth-provider'\nimport { Sidebar } from '@/components/layout/sidebar'\nimport { Header } from '@/components/layout/header'\nimport { Loader2 } from 'lucide-react'\n\nexport default function DashboardLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  const { user, loading } = useAuth()\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-soft\">\n        <div className=\"text-center\">\n          <Loader2 className=\"h-12 w-12 animate-spin text-primary mx-auto mb-4\" />\n          <p className=\"text-gray-600\">Carregando...</p>\n        </div>\n      </div>\n    )\n  }\n\n  if (!user) {\n    return null // Middleware já redirecionará para login\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-soft\">\n      <div className=\"flex\">\n        {/* Sidebar */}\n        <Sidebar />\n        \n        {/* Main content */}\n        <div className=\"flex-1 ml-64\">\n          <Header />\n          <main className=\"p-6\">\n            {children}\n          </main>\n        </div>\n      </div>\n    </div>\n  )\n}","size_bytes":1115},"components/layout/header.tsx":{"content":"'use client'\n\nimport { useAuth } from '@/components/auth/auth-provider'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu'\nimport { Bell, Search, User, Settings, LogOut, Crown, HelpCircle } from 'lucide-react'\nimport Link from 'next/link'\nimport { usePathname } from 'next/navigation'\n\nconst pageNames: { [key: string]: string } = {\n  '/dashboard': 'Dashboard',\n  '/dashboard/calculadora': 'Calculadora de Preços',\n  '/dashboard/receitas': 'Minhas Receitas',\n  '/dashboard/ingredientes': 'Base de Ingredientes',\n  '/dashboard/orcamentos': 'Orçamentos',\n  '/dashboard/relatorios': 'Relatórios',\n  '/dashboard/configuracoes': 'Configurações',\n  '/dashboard/ajuda': 'Central de Ajuda',\n}\n\nexport function Header() {\n  const { profile, signOut } = useAuth()\n  const pathname = usePathname()\n  \n  const currentPageName = pageNames[pathname] || 'Dashboard'\n  const isPro = profile?.plano === 'pro'\n\n  const handleSignOut = async () => {\n    await signOut()\n  }\n\n  return (\n    <header className=\"sticky top-0 z-40 bg-white/80 backdrop-blur-sm border-b border-gray-200 h-16\">\n      <div className=\"flex items-center justify-between h-full px-6\">\n        {/* Page title */}\n        <div className=\"flex items-center space-x-4\">\n          <h1 className=\"text-2xl font-display font-semibold text-gray-900\">\n            {currentPageName}\n          </h1>\n          \n          {/* Pro badge se for página PRO */}\n          {(pathname.includes('orcamentos') || pathname.includes('relatorios')) && (\n            <Badge className=\"bg-gradient-doce text-white\">\n              <Crown className=\"h-3 w-3 mr-1\" />\n              PRO\n            </Badge>\n          )}\n        </div>\n\n        {/* Right side */}\n        <div className=\"flex items-center space-x-4\">\n          {/* Search (future feature) */}\n          <Button variant=\"ghost\" size=\"icon\" className=\"hidden md:flex\">\n            <Search className=\"h-5 w-5\" />\n          </Button>\n\n          {/* Notifications (future feature) */}\n          <Button variant=\"ghost\" size=\"icon\" className=\"relative\">\n            <Bell className=\"h-5 w-5\" />\n            {/* Notification dot */}\n            <div className=\"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full border-2 border-white\" />\n          </Button>\n\n          {/* Upgrade button for free users */}\n          {!isPro && (\n            <Link href=\"/dashboard/upgrade\">\n              <Button variant=\"doce\" size=\"sm\" className=\"hidden md:flex\">\n                <Crown className=\"h-4 w-4 mr-2\" />\n                Upgrade PRO\n              </Button>\n            </Link>\n          )}\n\n          {/* User menu */}\n          <DropdownMenu>\n            <DropdownMenuTrigger asChild>\n              <Button variant=\"ghost\" className=\"relative h-10 w-10 rounded-full\">\n                <div className=\"w-10 h-10 bg-gradient-doce rounded-full flex items-center justify-center text-white font-medium\">\n                  {profile?.nome?.charAt(0)?.toUpperCase() || 'U'}\n                </div>\n              </Button>\n            </DropdownMenuTrigger>\n            \n            <DropdownMenuContent className=\"w-56\" align=\"end\" forceMount>\n              <DropdownMenuLabel className=\"font-normal\">\n                <div className=\"flex flex-col space-y-1\">\n                  <p className=\"text-sm font-medium leading-none\">\n                    {profile?.nome || 'Usuário'}\n                  </p>\n                  <p className=\"text-xs leading-none text-muted-foreground\">\n                    {profile?.email}\n                  </p>\n                  <div className=\"flex items-center space-x-2 mt-2\">\n                    <Badge \n                      variant={isPro ? \"default\" : \"secondary\"} \n                      className={isPro ? \"bg-gradient-doce text-white\" : \"\"}\n                    >\n                      {isPro && <Crown className=\"h-3 w-3 mr-1\" />}\n                      {isPro ? 'Profissional' : 'Gratuito'}\n                    </Badge>\n                  </div>\n                </div>\n              </DropdownMenuLabel>\n              \n              <DropdownMenuSeparator />\n              \n              <DropdownMenuItem asChild>\n                <Link href=\"/dashboard/configuracoes\" className=\"cursor-pointer\">\n                  <User className=\"mr-2 h-4 w-4\" />\n                  <span>Perfil</span>\n                </Link>\n              </DropdownMenuItem>\n              \n              <DropdownMenuItem asChild>\n                <Link href=\"/dashboard/configuracoes\" className=\"cursor-pointer\">\n                  <Settings className=\"mr-2 h-4 w-4\" />\n                  <span>Configurações</span>\n                </Link>\n              </DropdownMenuItem>\n\n              <DropdownMenuItem asChild>\n                <Link href=\"/dashboard/ajuda\" className=\"cursor-pointer\">\n                  <HelpCircle className=\"mr-2 h-4 w-4\" />\n                  <span>Ajuda</span>\n                </Link>\n              </DropdownMenuItem>\n              \n              {!isPro && (\n                <>\n                  <DropdownMenuSeparator />\n                  <DropdownMenuItem asChild>\n                    <Link href=\"/dashboard/upgrade\" className=\"cursor-pointer text-primary\">\n                      <Crown className=\"mr-2 h-4 w-4\" />\n                      <span>Upgrade para PRO</span>\n                    </Link>\n                  </DropdownMenuItem>\n                </>\n              )}\n              \n              <DropdownMenuSeparator />\n              \n              <DropdownMenuItem \n                className=\"cursor-pointer text-red-600 focus:text-red-600\"\n                onClick={handleSignOut}\n              >\n                <LogOut className=\"mr-2 h-4 w-4\" />\n                <span>Sair</span>\n              </DropdownMenuItem>\n            </DropdownMenuContent>\n          </DropdownMenu>\n        </div>\n      </div>\n    </header>\n  )\n}","size_bytes":6067},"components/layout/sidebar.tsx":{"content":"'use client'\n\nimport { useAuth } from '@/components/auth/auth-provider'\nimport { Badge } from '@/components/ui/badge'\nimport Link from 'next/link'\nimport { usePathname } from 'next/navigation'\nimport { cn } from '@/lib/utils'\nimport {\n  LayoutDashboard,\n  Calculator,\n  ChefHat,\n  Package,\n  FileText,\n  Settings,\n  Cake,\n  Crown,\n  HelpCircle,\n  BarChart3\n} from 'lucide-react'\n\nconst navigation = [\n  {\n    name: 'Dashboard',\n    href: '/dashboard',\n    icon: LayoutDashboard,\n    description: 'Visão geral do negócio'\n  },\n  {\n    name: 'Calculadora',\n    href: '/dashboard/calculadora',\n    icon: Calculator,\n    description: 'Calcular preços',\n    highlight: true\n  },\n  {\n    name: 'Receitas',\n    href: '/dashboard/receitas',\n    icon: ChefHat,\n    description: 'Gerenciar receitas'\n  },\n  {\n    name: 'Ingredientes',\n    href: '/dashboard/ingredientes',\n    icon: Package,\n    description: 'Base de ingredientes'\n  },\n  {\n    name: 'Orçamentos',\n    href: '/dashboard/orcamentos',\n    icon: FileText,\n    description: 'Orçamentos para clientes',\n    pro: true\n  },\n  {\n    name: 'Relatórios',\n    href: '/dashboard/relatorios',\n    icon: BarChart3,\n    description: 'Análises e relatórios',\n    pro: true\n  },\n]\n\nconst bottomNavigation = [\n  {\n    name: 'Configurações',\n    href: '/dashboard/configuracoes',\n    icon: Settings,\n    description: 'Suas configurações'\n  },\n  {\n    name: 'Ajuda',\n    href: '/dashboard/ajuda',\n    icon: HelpCircle,\n    description: 'Central de ajuda'\n  },\n]\n\nexport function Sidebar() {\n  const pathname = usePathname()\n  const { profile } = useAuth()\n\n  const isPro = profile?.plano === 'pro'\n\n  return (\n    <div className=\"fixed inset-y-0 left-0 z-50 w-64 bg-white border-r border-gray-200 shadow-sm\">\n      <div className=\"flex flex-col h-full\">\n        {/* Logo */}\n        <div className=\"flex items-center h-16 px-4 border-b border-gray-200\">\n          <Link href=\"/dashboard\" className=\"flex items-center space-x-2\">\n            <Cake className=\"h-8 w-8 text-primary\" />\n            <div>\n              <span className=\"text-xl font-display font-bold text-gray-900\">DoceCalc</span>\n              {isPro && (\n                <Badge className=\"ml-2 bg-gradient-doce text-white text-xs\">\n                  <Crown className=\"h-3 w-3 mr-1\" />\n                  PRO\n                </Badge>\n              )}\n            </div>\n          </Link>\n        </div>\n\n        {/* User info */}\n        <div className=\"p-4 border-b border-gray-100\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"w-10 h-10 bg-gradient-doce rounded-full flex items-center justify-center text-white font-medium\">\n              {profile?.nome?.charAt(0)?.toUpperCase() || 'U'}\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              <p className=\"text-sm font-medium text-gray-900 truncate\">\n                {profile?.nome || 'Usuário'}\n              </p>\n              <p className=\"text-xs text-gray-600 truncate\">\n                Plano {isPro ? 'Profissional' : 'Gratuito'}\n              </p>\n            </div>\n          </div>\n          \n          {!isPro && (\n            <Link href=\"/dashboard/upgrade\">\n              <div className=\"mt-3 p-2 bg-gradient-to-r from-primary/10 to-rosa-500/10 rounded-lg border border-primary/20 cursor-pointer hover:from-primary/15 hover:to-rosa-500/15 transition-colors\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"text-xs\">\n                    <p className=\"font-medium text-primary\">Upgrade para PRO</p>\n                    <p className=\"text-gray-600\">Desbloquear tudo</p>\n                  </div>\n                  <Crown className=\"h-4 w-4 text-primary\" />\n                </div>\n              </div>\n            </Link>\n          )}\n        </div>\n\n        {/* Navigation */}\n        <nav className=\"flex-1 px-4 py-4 space-y-1 overflow-y-auto custom-scrollbar\">\n          {navigation.map((item) => {\n            const isActive = pathname === item.href\n            const needsPro = item.pro && !isPro\n            \n            return (\n              <Link\n                key={item.name}\n                href={needsPro ? '/dashboard/upgrade' : item.href}\n                className={cn(\n                  'group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200',\n                  isActive\n                    ? 'bg-primary text-white shadow-sm'\n                    : needsPro\n                    ? 'text-gray-400 hover:text-gray-500 cursor-pointer'\n                    : 'text-gray-700 hover:bg-gray-100 hover:text-gray-900',\n                  item.highlight && !isActive && !needsPro && 'ring-1 ring-primary/30 bg-primary/5'\n                )}\n              >\n                <item.icon \n                  className={cn(\n                    'mr-3 h-5 w-5 flex-shrink-0',\n                    isActive ? 'text-white' : needsPro ? 'text-gray-400' : 'text-gray-500'\n                  )} \n                />\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between\">\n                    <span>{item.name}</span>\n                    {item.pro && (\n                      <Crown className=\"h-3 w-3 text-primary opacity-60\" />\n                    )}\n                    {item.highlight && !isActive && (\n                      <div className=\"w-2 h-2 bg-primary rounded-full animate-pulse\" />\n                    )}\n                  </div>\n                  <p className={cn(\n                    'text-xs mt-0.5',\n                    isActive ? 'text-white/80' : needsPro ? 'text-gray-400' : 'text-gray-500'\n                  )}>\n                    {item.description}\n                  </p>\n                </div>\n              </Link>\n            )\n          })}\n        </nav>\n\n        {/* Bottom navigation */}\n        <div className=\"border-t border-gray-200 p-4 space-y-1\">\n          {bottomNavigation.map((item) => {\n            const isActive = pathname === item.href\n            \n            return (\n              <Link\n                key={item.name}\n                href={item.href}\n                className={cn(\n                  'group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors',\n                  isActive\n                    ? 'bg-primary text-white'\n                    : 'text-gray-700 hover:bg-gray-100 hover:text-gray-900'\n                )}\n              >\n                <item.icon \n                  className={cn(\n                    'mr-3 h-5 w-5 flex-shrink-0',\n                    isActive ? 'text-white' : 'text-gray-500'\n                  )} \n                />\n                <div>\n                  <span>{item.name}</span>\n                  <p className={cn(\n                    'text-xs',\n                    isActive ? 'text-white/80' : 'text-gray-500'\n                  )}>\n                    {item.description}\n                  </p>\n                </div>\n              </Link>\n            )\n          })}\n        </div>\n      </div>\n    </div>\n  )\n}","size_bytes":7098},"components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n        success:\n          \"border-transparent bg-green-100 text-green-800 hover:bg-green-200\",\n        warning:\n          \"border-transparent bg-yellow-100 text-yellow-800 hover:bg-yellow-200\",\n        info:\n          \"border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }","size_bytes":1412},"components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n        doce: \"bg-gradient-doce text-white hover:shadow-lg hover:shadow-doce-500/25 hover:scale-105 active:scale-95\",\n        success: \"bg-green-600 text-white hover:bg-green-700\",\n        warning: \"bg-yellow-600 text-white hover:bg-yellow-700\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        xl: \"h-12 rounded-lg px-10 text-base\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }","size_bytes":2127},"components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm card-doce\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h3\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <p\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }","size_bytes":1886},"components/ui/dropdown-menu.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}","size_bytes":7308},"components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nexport interface InputProps\n  extends React.InputHTMLAttributes<HTMLInputElement> {}\n\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 input-focus\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }","size_bytes":835},"components/ui/label.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }","size_bytes":723},"components/ui/tabs.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }","size_bytes":1895},"components/ui/toast.tsx":{"content":"'use client'\n\nimport * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}","size_bytes":4852},"components/ui/toaster.tsx":{"content":"\"use client\";\n\nimport { useToast } from \"@/hooks/use-toast\"\nimport { Toast, ToastClose, ToastDescription, ToastProvider, ToastTitle, ToastViewport } from \"./toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, variant }) {\n        return (\n          <Toast key={id} variant={variant}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":766},"components/ui/use-toast.ts":{"content":"'use client'\n\nimport * as React from \"react\"\nimport type { ComponentProps } from \"react\"\n\nconst TOAST_LIMIT = 3\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: React.ReactElement\n  variant?: 'default' | 'destructive'\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n} & ComponentProps<\"div\">\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_VALUE\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }","size_bytes":3842},"app/auth/login/page.tsx":{"content":"'use client'\n\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { useAuth } from '@/components/auth/local-auth-provider'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Label } from '@/components/ui/label'\nimport Link from 'next/link'\nimport { Cake, Eye, EyeOff, Loader2 } from 'lucide-react'\n\nexport default function LoginPage() {\n  const [email, setEmail] = useState('')\n  const [password, setPassword] = useState('')\n  const [showPassword, setShowPassword] = useState(false)\n  const [isLoading, setIsLoading] = useState(false)\n\n  const { signIn } = useAuth()\n  const router = useRouter()\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n\n    if (!email || !password) {\n      alert('Preencha email e senha')\n      return\n    }\n\n    setIsLoading(true)\n    try {\n      await signIn(email, password)\n      // signIn já redireciona para dashboard em caso de sucesso\n    } catch (err: any) {\n      alert(err.message || 'Erro ao entrar')\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center p-4 bg-gradient-soft\">\n      <div className=\"w-full max-w-md\">\n        <div className=\"text-center mb-6 sm:mb-8\">\n          <Link href=\"/\" className=\"inline-flex items-center space-x-2 mb-4\">\n            <Cake className=\"h-8 w-8 text-primary\" />\n            <span className=\"text-2xl font-bold text-gray-900\">DoceCalc</span>\n          </Link>\n          <p className=\"text-gray-600\">Entre na sua conta</p>\n        </div>\n\n        <Card className=\"shadow-lg\">\n          <CardHeader className=\"text-center px-6 pt-8 pb-6\">\n            <CardTitle className=\"text-xl mb-2\">Bem-vinda de volta! 🎂</CardTitle>\n            <CardDescription>Acesse sua conta para continuar calculando preços</CardDescription>\n          </CardHeader>\n\n          <CardContent className=\"px-6 pb-8\">\n            <form onSubmit={handleSubmit} className=\"space-y-5\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"email\">Email</Label>\n                <Input\n                  id=\"email\"\n                  type=\"email\"\n                  placeholder=\"seu@email.com\"\n                  value={email}\n                  onChange={(e) => setEmail(e.target.value)}\n                  disabled={isLoading}\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"password\">Senha</Label>\n                <div className=\"relative\">\n                  <Input\n                    id=\"password\"\n                    type={showPassword ? 'text' : 'password'}\n                    placeholder=\"Sua senha\"\n                    value={password}\n                    onChange={(e) => setPassword(e.target.value)}\n                    disabled={isLoading}\n                  />\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowPassword(!showPassword)}\n                    className=\"absolute inset-y-0 right-0 pr-3 flex items-center\"\n                    tabIndex={-1}\n                  >\n                    {showPassword ? <EyeOff className=\"h-4 w-4 text-gray-400\" /> : <Eye className=\"h-4 w-4 text-gray-400\" />}\n                  </button>\n                </div>\n              </div>\n\n              <Button type=\"submit\" disabled={isLoading}>\n                {isLoading ? (\n                  <>\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    Entrando...\n                  </>\n                ) : (\n                  'Entrar'\n                )}\n              </Button>\n            </form>\n\n            <div className=\"mt-6 text-center\">\n              <p>\n                Não tem uma conta?{' '}\n                <Link href=\"/auth/register\" className=\"text-primary hover:underline\">\n                  Cadastre-se grátis\n                </Link>\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n\n        <div className=\"text-center mt-6\">\n          <Link href=\"/\" className=\"text-gray-600 hover:text-primary\">\n            ← Voltar para o início\n          </Link>\n        </div>\n      </div>\n    </div>\n  )\n}\n","size_bytes":4346},"app/auth/register/page.tsx":{"content":"'use client'\n\nimport { useState } from 'react'\nimport { useAuth } from '@/components/auth/local-auth-provider'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Label } from '@/components/ui/label'\nimport Link from 'next/link'\nimport { useRouter } from 'next/navigation'\nimport { Cake, Eye, EyeOff, Loader2, CheckCircle } from 'lucide-react'\nimport { isValidEmail } from '@/lib/utils'\n\nexport default function RegisterPage() {\n  const [formData, setFormData] = useState({\n    nome: '',\n    email: '',\n    password: '',\n    confirmPassword: ''\n  })\n  const [showPassword, setShowPassword] = useState(false)\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false)\n  const [isLoading, setIsLoading] = useState(false)\n  \n  const { signUp } = useAuth()\n  const router = useRouter()\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setFormData(prev => ({\n      ...prev,\n      [e.target.name]: e.target.value\n    }))\n  }\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    \n    // Validações\n    if (!formData.nome.trim()) {\n      alert(\"Por favor, insira seu nome.\")\n      return\n    }\n\n    if (!formData.email || !isValidEmail(formData.email)) {\n      alert(\"Por favor, insira um email válido.\")\n      return\n    }\n\n    if (formData.password.length < 6) {\n      alert(\"A senha deve ter pelo menos 6 caracteres.\")\n      return\n    }\n\n    if (formData.password !== formData.confirmPassword) {\n      alert(\"As senhas não coincidem. Por favor, confirme sua senha corretamente.\")\n      return\n    }\n\n    setIsLoading(true)\n    \n    try {\n      await signUp(formData.email, formData.password, formData.nome)\n      // Sucesso - usuário receberá email de confirmação\n    } catch (error) {\n      // Erro já tratado no AuthProvider\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const getPasswordStrength = (password: string) => {\n    if (password.length === 0) return { strength: 0, label: '' }\n    if (password.length < 6) return { strength: 1, label: 'Muito fraca' }\n    if (password.length < 8) return { strength: 2, label: 'Fraca' }\n    if (password.length >= 8 && /[A-Z]/.test(password) && /[0-9]/.test(password)) {\n      return { strength: 4, label: 'Forte' }\n    }\n    return { strength: 3, label: 'Média' }\n  }\n\n  const passwordStrength = getPasswordStrength(formData.password)\n\n  return (\n    <div className=\"min-h-screen bg-gradient-soft flex items-center justify-center p-4 safe-area-inset\">\n      <div className=\"w-full max-w-md\">\n        {/* Logo */}\n        <div className=\"text-center mb-6 sm:mb-8\">\n          <Link href=\"/\" className=\"inline-flex items-center space-x-2 mb-4 hover:opacity-80 transition-opacity\">\n            <Cake className=\"h-8 w-8 text-primary\" />\n            <span className=\"text-2xl font-display font-bold text-gray-900\">DoceCalc</span>\n          </Link>\n          <p className=\"text-gray-600 text-sm sm:text-base\">Crie sua conta gratuita</p>\n        </div>\n\n        <Card className=\"auth-card shadow-lg\">\n          <CardHeader className=\"text-center px-6 pt-8 pb-6\">\n            <CardTitle className=\"text-xl sm:text-2xl text-gray-900 mb-2\">Bem-vinda ao DoceCalc! 🎉</CardTitle>\n            <CardDescription className=\"text-gray-600 text-sm sm:text-base\">\n              Comece grátis e transforme sua confeitaria em um negócio lucrativo\n            </CardDescription>\n          </CardHeader>\n          \n          <CardContent className=\"px-6 pb-8\">\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"nome\" className=\"text-sm font-medium text-gray-700\">Nome completo</Label>\n                <Input\n                  id=\"nome\"\n                  name=\"nome\"\n                  type=\"text\"\n                  placeholder=\"Seu nome completo\"\n                  value={formData.nome}\n                  onChange={handleChange}\n                  disabled={isLoading}\n                  className=\"input-focus h-11 text-base\"\n                  autoComplete=\"name\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"email\" className=\"text-sm font-medium text-gray-700\">Email</Label>\n                <Input\n                  id=\"email\"\n                  name=\"email\"\n                  type=\"email\"\n                  placeholder=\"seu@email.com\"\n                  value={formData.email}\n                  onChange={handleChange}\n                  disabled={isLoading}\n                  className=\"input-focus h-11 text-base\"\n                  autoComplete=\"email\"\n                />\n              </div>\n              \n              <div className=\"space-y-2\">\n                <Label htmlFor=\"password\" className=\"text-sm font-medium text-gray-700\">Senha</Label>\n                <div className=\"relative\">\n                  <Input\n                    id=\"password\"\n                    name=\"password\"\n                    type={showPassword ? \"text\" : \"password\"}\n                    placeholder=\"Crie uma senha\"\n                    value={formData.password}\n                    onChange={handleChange}\n                    disabled={isLoading}\n                    className=\"input-focus pr-11 h-11 text-base\"\n                    autoComplete=\"new-password\"\n                  />\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowPassword(!showPassword)}\n                    className=\"absolute inset-y-0 right-0 pr-3 flex items-center hover:text-gray-600 transition-colors\"\n                    disabled={isLoading}\n                    tabIndex={-1}\n                  >\n                    {showPassword ? (\n                      <EyeOff className=\"h-4 w-4 text-gray-400\" />\n                    ) : (\n                      <Eye className=\"h-4 w-4 text-gray-400\" />\n                    )}\n                  </button>\n                </div>\n                \n                {/* Indicador de força da senha melhorado */}\n                {formData.password && (\n                  <div className=\"space-y-2 mt-3\">\n                    <div className=\"flex space-x-1\">\n                      {[1, 2, 3, 4].map((level) => (\n                        <div\n                          key={level}\n                          className={`password-strength-bar ${\n                            level <= passwordStrength.strength\n                              ? passwordStrength.strength <= 2\n                                ? 'bg-red-500'\n                                : passwordStrength.strength === 3\n                                ? 'bg-yellow-500'\n                                : 'bg-green-500'\n                              : 'bg-gray-200'\n                          }`}\n                        />\n                      ))}\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <p className={`text-xs font-medium ${\n                        passwordStrength.strength <= 2\n                          ? 'text-red-600'\n                          : passwordStrength.strength === 3\n                          ? 'text-yellow-600'\n                          : 'text-green-600'\n                      }`}>\n                        Força: {passwordStrength.label}\n                      </p>\n                      {passwordStrength.strength >= 3 && (\n                        <CheckCircle className=\"h-3 w-3 text-green-500\" />\n                      )}\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"confirmPassword\" className=\"text-sm font-medium text-gray-700\">Confirmar senha</Label>\n                <div className=\"relative\">\n                  <Input\n                    id=\"confirmPassword\"\n                    name=\"confirmPassword\"\n                    type={showConfirmPassword ? \"text\" : \"password\"}\n                    placeholder=\"Confirme sua senha\"\n                    value={formData.confirmPassword}\n                    onChange={handleChange}\n                    disabled={isLoading}\n                    className=\"input-focus pr-11 h-11 text-base\"\n                    autoComplete=\"new-password\"\n                  />\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowConfirmPassword(!showConfirmPassword)}\n                    className=\"absolute inset-y-0 right-0 pr-3 flex items-center hover:text-gray-600 transition-colors\"\n                    disabled={isLoading}\n                    tabIndex={-1}\n                  >\n                    {showConfirmPassword ? (\n                      <EyeOff className=\"h-4 w-4 text-gray-400\" />\n                    ) : (\n                      <Eye className=\"h-4 w-4 text-gray-400\" />\n                    )}\n                  </button>\n                </div>\n                {formData.confirmPassword && (\n                  <div className=\"flex items-center space-x-2 mt-2\">\n                    {formData.password === formData.confirmPassword ? (\n                      <>\n                        <CheckCircle className=\"h-4 w-4 text-green-500\" />\n                        <span className=\"text-sm text-green-600 font-medium\">Senhas coincidem</span>\n                      </>\n                    ) : (\n                      <>\n                        <div className=\"h-4 w-4 rounded-full border-2 border-red-500 flex items-center justify-center\">\n                          <div className=\"h-1.5 w-1.5 bg-red-500 rounded-full\"></div>\n                        </div>\n                        <span className=\"text-sm text-red-600 font-medium\">Senhas não coincidem</span>\n                      </>\n                    )}\n                  </div>\n                )}\n              </div>\n\n              <Button \n                type=\"submit\" \n                className=\"w-full h-11 text-base font-medium mt-6\" \n                variant=\"doce\"\n                disabled={isLoading || !formData.nome.trim() || !formData.email || !formData.password || formData.password !== formData.confirmPassword}\n              >\n                {isLoading ? (\n                  <>\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    Criando conta...\n                  </>\n                ) : (\n                  'Criar conta gratuita'\n                )}\n              </Button>\n            </form>\n\n            {/* Benefícios do cadastro */}\n            <div className=\"mt-6 p-4 bg-green-50/80 rounded-xl border border-green-200/60\">\n              <h4 className=\"font-semibold text-green-800 mb-3 text-sm\">✨ Seu plano gratuito inclui:</h4>\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-2\">\n                <div className=\"flex items-center\">\n                  <CheckCircle className=\"h-3.5 w-3.5 mr-2 text-green-600\" />\n                  <span className=\"text-xs text-green-700\">3 receitas cadastradas</span>\n                </div>\n                <div className=\"flex items-center\">\n                  <CheckCircle className=\"h-3.5 w-3.5 mr-2 text-green-600\" />\n                  <span className=\"text-xs text-green-700\">Calculadora de preços</span>\n                </div>\n                <div className=\"flex items-center\">\n                  <CheckCircle className=\"h-3.5 w-3.5 mr-2 text-green-600\" />\n                  <span className=\"text-xs text-green-700\">Base de ingredientes</span>\n                </div>\n                <div className=\"flex items-center\">\n                  <CheckCircle className=\"h-3.5 w-3.5 mr-2 text-green-600\" />\n                  <span className=\"text-xs text-green-700\">Suporte por email</span>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"mt-6 text-center\">\n              <p className=\"text-gray-600 text-sm sm:text-base\">\n                Já tem uma conta?{' '}\n                <Link href=\"/auth/login\" className=\"text-primary hover:underline font-medium transition-colors\">\n                  Faça login\n                </Link>\n              </p>\n            </div>\n\n            <div className=\"mt-4 text-center\">\n              <p className=\"text-xs text-gray-500 leading-relaxed\">\n                Ao criar uma conta, você concorda com nossos{' '}\n                <Link href=\"/termos\" className=\"text-primary hover:underline\">\n                  Termos de Uso\n                </Link>{' '}\n                e{' '}\n                <Link href=\"/privacidade\" className=\"text-primary hover:underline\">\n                  Política de Privacidade\n                </Link>\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Voltar para home */}\n        <div className=\"text-center mt-6\">\n          <Link href=\"/\" className=\"text-gray-600 hover:text-primary transition-colors text-sm inline-flex items-center\">\n            ← Voltar para o início\n          </Link>\n        </div>\n      </div>\n    </div>\n  )\n}\n","size_bytes":13177},"app/dashboard/calculadora/page.tsx":{"content":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useAuth } from '@/components/auth/auth-provider'\nimport { useSearchParams } from 'next/navigation'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { \n  Calculator, \n  Plus, \n  Minus, \n  Save, \n  Download, \n  Clock,\n  DollarSign,\n  TrendingUp,\n  ShoppingCart,\n  Users,\n  Zap,\n  AlertCircle,\n  CheckCircle,\n  BarChart3,\n  PieChart,\n  FileText\n} from 'lucide-react'\nimport { useToast } from '@/hooks/use-toast'\nimport { \n  calcularPrecoReceita,\n  MULTIPLICADORES_COMPLEXIDADE,\n  CUSTOS_FIXOS_TOTAL,\n  sugerirMargemLucro,\n  calcularPrecoCompetitivo,\n  analisarRentabilidade,\n  formatarMoeda,\n  formatarQuantidade\n} from '@/lib/calculations-lib'\nimport { ReceitaCompleta, CalculoDetalhes } from '@/lib/database-types'\nimport { supabase } from '@/lib/supabase-client'\n\n// Tipos para a calculadora\ntype IngredienteCalculadora = {\n  id: string\n  nome: string\n  preco_por_unidade: number\n  unidade: string\n  categoria?: string\n}\n\ntype ReceitaCalculadora = {\n  id: string\n  nome: string\n  complexidade: 'simples' | 'media' | 'complexa'\n  tempo_preparo: number\n  rendimento: number\n  ingredientes: {\n    ingrediente: IngredienteCalculadora\n    quantidade: number\n  }[]\n}\n\nexport default function CalculadoraPage() {\n  const { profile } = useAuth()\n  const { toast } = useToast()\n  const searchParams = useSearchParams()\n\n  // Estados principais\n  const [activeTab, setActiveTab] = useState('rapida')\n  const [isCalculating, setIsCalculating] = useState(false)\n  const [resultado, setResultado] = useState<CalculoDetalhes | null>(null)\n  \n  // Estados para receita carregada\n  const [receitaCarregada, setReceitaCarregada] = useState<ReceitaCompleta | null>(null)\n  const [loadingReceita, setLoadingReceita] = useState(false)\n\n  // Estados para cálculo rápido\n  const [nomeReceita, setNomeReceita] = useState('')\n  const [complexidade, setComplexidade] = useState<'simples' | 'media' | 'complexa'>('simples')\n  const [tempoPreparo, setTempoPreparo] = useState(60)\n  const [rendimento, setRendimento] = useState(1)\n  const [valorHora, setValorHora] = useState(profile?.valor_hora || 15)\n  const [margemLucro, setMargemLucro] = useState(profile?.margem_padrao || 0.6)\n  const [quantidadeProduzir, setQuantidadeProduzir] = useState(1)\n  const [incluirTransporte, setIncluirTransporte] = useState(false)\n\n  // Estados para ingredientes\n  const [ingredientes, setIngredientes] = useState<{\n    nome: string\n    quantidade: number\n    unidade: string\n    preco: number\n  }[]>([\n    { nome: '', quantidade: 0, unidade: 'g', preco: 0 }\n  ])\n\n  const isPro = profile?.plano === 'pro'\n  const receitaId = searchParams.get('receita')\n\n  // Carregar receita específica se houver parâmetro na URL\n  useEffect(() => {\n    if (receitaId && profile?.id) {\n      carregarReceitaEspecifica(receitaId)\n    }\n  }, [receitaId, profile?.id])\n\n  const carregarReceitaEspecifica = async (id: string) => {\n    try {\n      setLoadingReceita(true)\n      \n      // Buscar receita com ingredientes\n      const { data: receita, error: receitaError } = await supabase\n        .from('receitas')\n        .select('*')\n        .eq('id', id)\n        .eq('user_id', profile?.id)\n        .single()\n\n      if (receitaError) throw receitaError\n\n      // Buscar ingredientes da receita\n      const { data: ingredientesData, error: ingredientesError } = await supabase\n        .from('receita_ingredientes')\n        .select(`\n          *,\n          ingredientes (*)\n        `)\n        .eq('receita_id', id)\n\n      if (ingredientesError) throw ingredientesError\n\n      // Montar receita completa\n      const receitaCompleta: ReceitaCompleta = {\n        ...receita,\n        tempo_preparo: receita.tempo_producao,\n        receita_ingredientes: (ingredientesData || []).map(item => ({\n          id: item.id,\n          receita_id: item.receita_id,\n          ingrediente_id: item.ingrediente_id,\n          quantidade: item.quantidade,\n          created_at: item.created_at,\n          ingredientes: {\n            ...item.ingredientes,\n            preco_por_unidade: item.ingredientes.preco_kg,\n            user_id: profile?.id || ''\n          }\n        }))\n      }\n\n      setReceitaCarregada(receitaCompleta)\n      \n      // Preencher formulário com dados da receita\n      setNomeReceita(receita.nome)\n      setComplexidade(receita.complexidade)\n      setTempoPreparo(receita.tempo_producao)\n      setRendimento(receita.rendimento)\n      \n      // Preencher ingredientes se existirem\n      if (ingredientesData && ingredientesData.length > 0) {\n        const ingredientesFormatados = ingredientesData.map(item => ({\n          nome: item.ingredientes.nome,\n          quantidade: item.quantidade,\n          unidade: item.ingredientes.unidade === 'unidades' ? 'unidades' : \n                   item.ingredientes.unidade === 'ml' ? 'ml' : 'g',\n          preco: item.ingredientes.preco_kg\n        }))\n        setIngredientes(ingredientesFormatados)\n      }\n\n      toast({\n        title: \"Receita carregada! 🎂\",\n        description: `Dados de \"${receita.nome}\" carregados com sucesso.`,\n      })\n\n    } catch (error) {\n      console.error('Erro ao carregar receita:', error)\n      toast({\n        title: \"Erro ao carregar receita\",\n        description: \"Não foi possível carregar os dados da receita.\",\n        variant: \"destructive\",\n      })\n    } finally {\n      setLoadingReceita(false)\n    }\n  }\n\n  const salvarResultadosNaReceita = async () => {\n    if (!receitaCarregada || !resultado) {\n      toast({\n        title: \"Erro\",\n        description: \"Nenhuma receita carregada ou resultado de cálculo disponível.\",\n        variant: \"destructive\",\n      })\n      return\n    }\n\n    try {\n      // Atualizar receita com custos calculados\n      const { error } = await supabase\n        .from('receitas')\n        .update({\n          custo_calculado: resultado.custoTotal,\n          preco_sugerido: resultado.precoFinal,\n          updated_at: new Date().toISOString()\n        })\n        .eq('id', receitaCarregada.id)\n\n      if (error) throw error\n\n      // Salvar no histórico de cálculos se for PRO\n      if (isPro) {\n        const { error: historicoError } = await supabase\n          .from('calculos_salvos')\n          .insert({\n            user_id: profile?.id,\n            receita_id: receitaCarregada.id,\n            quantidade_produzida: quantidadeProduzir,\n            preco_unitario: resultado.precoFinal / quantidadeProduzir,\n            preco_total: resultado.precoFinal,\n            detalhes: {\n              custoIngredientes: resultado.custoIngredientes,\n              custoMaoDeObra: resultado.custoMaoDeObra,\n              custosFixos: resultado.custosFixos,\n              custoTotal: resultado.custoTotal,\n              margemLucro: resultado.margemLucro,\n              valorHora,\n              incluirTransporte,\n              breakdown: resultado.breakdown\n            }\n          })\n\n        if (historicoError) {\n          console.error('Erro ao salvar histórico:', historicoError)\n        }\n      }\n\n      // Atualizar estado local\n      setReceitaCarregada(prev => prev ? {\n        ...prev,\n        custo_calculado: resultado.custoTotal,\n        preco_sugerido: resultado.precoFinal\n      } : null)\n\n      toast({\n        title: \"Resultados salvos! ✅\",\n        description: `Custos atualizados para \"${receitaCarregada.nome}\".`,\n      })\n\n    } catch (error) {\n      console.error('Erro ao salvar resultados:', error)\n      toast({\n        title: \"Erro ao salvar\",\n        description: \"Não foi possível salvar os resultados na receita.\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  // Função para adicionar ingrediente\n  const adicionarIngrediente = () => {\n    if (!isPro && ingredientes.length >= 3) {\n      toast({\n        title: \"Limite do Plano Gratuito\",\n        description: \"Upgrade para PRO para adicionar mais ingredientes ilimitados.\",\n        variant: \"destructive\",\n      })\n      return\n    }\n\n    setIngredientes([\n      ...ingredientes,\n      { nome: '', quantidade: 0, unidade: 'g', preco: 0 }\n    ])\n  }\n\n  // Função para remover ingrediente\n  const removerIngrediente = (index: number) => {\n    if (ingredientes.length > 1) {\n      setIngredientes(ingredientes.filter((_, i) => i !== index))\n    }\n  }\n\n  // Função para atualizar ingrediente\n  const atualizarIngrediente = (index: number, campo: string, valor: any) => {\n    const novosIngredientes = [...ingredientes]\n    novosIngredientes[index] = { ...novosIngredientes[index], [campo]: valor }\n    setIngredientes(novosIngredientes)\n  }\n\n  // Função para calcular preço\n  const calcularPreco = () => {\n    if (!nomeReceita.trim()) {\n      toast({\n        title: \"Campo obrigatório\",\n        description: \"Por favor, digite o nome da receita.\",\n        variant: \"destructive\",\n      })\n      return\n    }\n\n    const ingredientesValidos = ingredientes.filter(ing => \n      ing.nome.trim() && ing.quantidade > 0 && ing.preco > 0\n    )\n\n    if (ingredientesValidos.length === 0) {\n      toast({\n        title: \"Ingredientes necessários\",\n        description: \"Adicione pelo menos um ingrediente válido.\",\n        variant: \"destructive\",\n      })\n      return\n    }\n\n    setIsCalculating(true)\n\n    // Simular uma receita completa para o cálculo\n    const receitaSimulada: ReceitaCompleta = {\n      id: 'temp',\n      user_id: profile?.id || '',\n      nome: nomeReceita,\n      descricao: '',\n      tempo_producao: tempoPreparo,\n      tempo_preparo: tempoPreparo, // Alias para compatibilidade\n      complexidade,\n      rendimento,\n      imagem_url: null,\n      categoria: '',\n      ativa: true,\n      custo_calculado: null,\n      preco_sugerido: null,\n      created_at: new Date().toISOString(),\n      updated_at: new Date().toISOString(),\n      receita_ingredientes: ingredientesValidos.map((ing, index) => ({\n        id: `temp_${index}`,\n        receita_id: 'temp',\n        ingrediente_id: `temp_ing_${index}`,\n        quantidade: ing.quantidade,\n        created_at: new Date().toISOString(),\n        ingredientes: {\n          id: `temp_ing_${index}`,\n          nome: ing.nome,\n          categoria_id: null,\n          preco_kg: ing.preco,\n          preco_por_unidade: ing.preco, // Alias para compatibilidade\n          unidade: ing.unidade as 'g' | 'ml' | 'unidades',\n          densidade: 1,\n          ativo: true,\n          created_at: new Date().toISOString(),\n          updated_at: new Date().toISOString(),\n          user_id: profile?.id || ''\n        }\n      }))\n    }\n\n    setTimeout(() => {\n      try {\n        const calculo = calcularPrecoReceita(\n          receitaSimulada,\n          valorHora,\n          margemLucro,\n          quantidadeProduzir,\n          incluirTransporte\n        )\n\n        setResultado(calculo)\n        toast({\n          title: \"Cálculo realizado! 🎂\",\n          description: `Preço final: ${formatarMoeda(calculo.precoFinal)}`,\n        })\n      } catch (error) {\n        console.error('Erro no cálculo:', error)\n        toast({\n          title: \"Erro no cálculo\",\n          description: \"Verifique os dados e tente novamente.\",\n          variant: \"destructive\",\n        })\n      } finally {\n        setIsCalculating(false)\n      }\n    }, 1000)\n  }\n\n  // Função para salvar cálculo (PRO)\n  const salvarCalculo = () => {\n    if (!isPro) {\n      toast({\n        title: \"Funcionalidade PRO\",\n        description: \"Upgrade para PRO para salvar seus cálculos.\",\n        variant: \"destructive\",\n      })\n      return\n    }\n\n    // Implementar salvamento no banco\n    toast({\n      title: \"Cálculo salvo!\",\n      description: \"Você pode acessar seus cálculos salvos na aba histórico.\",\n    })\n  }\n\n  // Função para gerar relatório PDF (PRO)\n  const gerarRelatorio = () => {\n    if (!isPro) {\n      toast({\n        title: \"Funcionalidade PRO\",\n        description: \"Upgrade para PRO para gerar relatórios em PDF.\",\n        variant: \"destructive\",\n      })\n      return\n    }\n\n    // Implementar geração de PDF\n    toast({\n      title: \"Relatório gerado!\",\n      description: \"O download do PDF iniciará em instantes.\",\n    })\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-soft py-8 px-4\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"text-center mb-8\">\n          <div className=\"flex items-center justify-center space-x-2 mb-4\">\n            <Calculator className=\"h-8 w-8 text-primary\" />\n            <h1 className=\"text-3xl font-display font-bold text-gray-900\">\n              Calculadora de Preços\n            </h1>\n          </div>\n          <p className=\"text-gray-600 max-w-2xl mx-auto\">\n            Calcule o preço ideal para suas receitas considerando ingredientes, \n            mão de obra, custos fixos e margem de lucro\n          </p>\n          \n          {!isPro && (\n            <div className=\"mt-4\">\n              <Badge variant=\"outline\" className=\"bg-yellow-50 text-yellow-800 border-yellow-200\">\n                <Zap className=\"h-3 w-3 mr-1\" />\n                Plano Gratuito - Máximo 3 ingredientes\n              </Badge>\n            </div>\n          )}\n          \n          {/* Indicador de receita carregada */}\n          {receitaCarregada && (\n            <div className=\"mt-4\">\n              <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 max-w-2xl mx-auto\">\n                <div className=\"flex items-center justify-center space-x-2\">\n                  <CheckCircle className=\"h-5 w-5 text-blue-600\" />\n                  <span className=\"text-blue-800 font-medium\">\n                    Receita carregada: {receitaCarregada.nome}\n                  </span>\n                </div>\n                <p className=\"text-sm text-blue-600 text-center mt-1\">\n                  Dados preenchidos automaticamente. Você pode calcular o preço e salvar os resultados na receita.\n                </p>\n              </div>\n            </div>\n          )}\n        </div>\n\n        <div className=\"grid grid-cols-1 xl:grid-cols-3 gap-8\">\n          {/* Formulário Principal */}\n          <div className=\"xl:col-span-2\">\n            <Tabs value={activeTab} onValueChange={setActiveTab}>\n              <TabsList className=\"grid w-full grid-cols-2\">\n                <TabsTrigger value=\"rapida\">Cálculo Rápido</TabsTrigger>\n                <TabsTrigger value=\"avancado\" disabled={!isPro}>\n                  Cálculo Avançado {!isPro && '(PRO)'}\n                </TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"rapida\" className=\"space-y-6\">\n                {/* Informações da Receita */}\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center space-x-2\">\n                      <FileText className=\"h-5 w-5\" />\n                      <span>Informações da Receita</span>\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      <div>\n                        <Label htmlFor=\"nome\">Nome da Receita</Label>\n                        <Input\n                          id=\"nome\"\n                          value={nomeReceita}\n                          onChange={(e) => setNomeReceita(e.target.value)}\n                          placeholder=\"Ex: Brigadeiro Gourmet\"\n                        />\n                      </div>\n                      <div>\n                        <Label htmlFor=\"complexidade\">Complexidade</Label>\n                        <select \n                          id=\"complexidade\"\n                          value={complexidade} \n                          onChange={(e) => setComplexidade(e.target.value as 'simples' | 'media' | 'complexa')}\n                          className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n                        >\n                          <option value=\"simples\">Simples (1x)</option>\n                          <option value=\"media\">Média (1.5x)</option>\n                          <option value=\"complexa\">Complexa (2x)</option>\n                        </select>\n                      </div>\n                      <div>\n                        <Label htmlFor=\"tempo\">Tempo de Preparo (min)</Label>\n                        <Input\n                          id=\"tempo\"\n                          type=\"number\"\n                          value={tempoPreparo}\n                          onChange={(e) => setTempoPreparo(Number(e.target.value))}\n                          min=\"1\"\n                        />\n                      </div>\n                      <div>\n                        <Label htmlFor=\"rendimento\">Rendimento (unidades)</Label>\n                        <Input\n                          id=\"rendimento\"\n                          type=\"number\"\n                          value={rendimento}\n                          onChange={(e) => setRendimento(Number(e.target.value))}\n                          min=\"1\"\n                        />\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                {/* Ingredientes */}\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center space-x-2\">\n                        <ShoppingCart className=\"h-5 w-5\" />\n                        <span>Ingredientes</span>\n                      </div>\n                      <Button onClick={adicionarIngrediente} size=\"sm\" variant=\"outline\">\n                        <Plus className=\"h-4 w-4 mr-1\" />\n                        Adicionar\n                      </Button>\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    {ingredientes.map((ingrediente, index) => (\n                      <div key={index} className=\"grid grid-cols-12 gap-2 items-end\">\n                        <div className=\"col-span-4\">\n                          <Label className=\"text-xs\">Nome</Label>\n                          <Input\n                            value={ingrediente.nome}\n                            onChange={(e) => atualizarIngrediente(index, 'nome', e.target.value)}\n                            placeholder=\"Ex: Chocolate\"\n                            className=\"h-8 text-xs\"\n                          />\n                        </div>\n                        <div className=\"col-span-2\">\n                          <Label className=\"text-xs\">Qtd</Label>\n                          <Input\n                            type=\"number\"\n                            value={ingrediente.quantidade}\n                            onChange={(e) => atualizarIngrediente(index, 'quantidade', Number(e.target.value))}\n                            min=\"0\"\n                            step=\"0.1\"\n                            className=\"h-8 text-xs\"\n                          />\n                        </div>\n                        <div className=\"col-span-2\">\n                          <Label className=\"text-xs\">Unidade</Label>\n                          <select\n                            value={ingrediente.unidade}\n                            onChange={(e) => atualizarIngrediente(index, 'unidade', e.target.value)}\n                            className=\"flex h-8 w-full rounded-md border border-input bg-background px-2 py-1 text-xs ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n                          >\n                            <option value=\"g\">g</option>\n                            <option value=\"kg\">kg</option>\n                            <option value=\"ml\">ml</option>\n                            <option value=\"l\">L</option>\n                            <option value=\"unidades\">un</option>\n                          </select>\n                        </div>\n                        <div className=\"col-span-3\">\n                          <Label className=\"text-xs\">Preço/Unidade (R$)</Label>\n                          <Input\n                            type=\"number\"\n                            value={ingrediente.preco}\n                            onChange={(e) => atualizarIngrediente(index, 'preco', Number(e.target.value))}\n                            min=\"0\"\n                            step=\"0.01\"\n                            className=\"h-8 text-xs\"\n                          />\n                        </div>\n                        <div className=\"col-span-1\">\n                          <Button\n                            onClick={() => removerIngrediente(index)}\n                            size=\"sm\"\n                            variant=\"ghost\"\n                            disabled={ingredientes.length === 1}\n                          >\n                            <Minus className=\"h-4 w-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                    ))}\n                  </CardContent>\n                </Card>\n\n                {/* Parâmetros de Cálculo */}\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center space-x-2\">\n                      <TrendingUp className=\"h-5 w-5\" />\n                      <span>Parâmetros de Cálculo</span>\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                      <div>\n                        <Label htmlFor=\"valorHora\">Valor/Hora (R$)</Label>\n                        <Input\n                          id=\"valorHora\"\n                          type=\"number\"\n                          value={valorHora}\n                          onChange={(e) => setValorHora(Number(e.target.value))}\n                          min=\"0\"\n                          step=\"0.50\"\n                        />\n                      </div>\n                      <div>\n                        <Label htmlFor=\"margem\">Margem de Lucro (%)</Label>\n                        <Input\n                          id=\"margem\"\n                          type=\"number\"\n                          value={Math.round(margemLucro * 100)}\n                          onChange={(e) => setMargemLucro(Number(e.target.value) / 100)}\n                          min=\"0\"\n                          max=\"300\"\n                        />\n                      </div>\n                      <div>\n                        <Label htmlFor=\"quantidade\">Quantidade a Produzir</Label>\n                        <Input\n                          id=\"quantidade\"\n                          type=\"number\"\n                          value={quantidadeProduzir}\n                          onChange={(e) => setQuantidadeProduzir(Number(e.target.value))}\n                          min=\"1\"\n                        />\n                      </div>\n                    </div>\n                    \n                    <div className=\"flex items-center space-x-2\">\n                      <input\n                        type=\"checkbox\"\n                        id=\"transporte\"\n                        checked={incluirTransporte}\n                        onChange={(e) => setIncluirTransporte(e.target.checked)}\n                        className=\"rounded\"\n                      />\n                      <Label htmlFor=\"transporte\" className=\"text-sm\">\n                        Incluir custos de transporte/entrega\n                      </Label>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                {/* Botão de Cálculo */}\n                <div className=\"text-center\">\n                  <Button\n                    onClick={calcularPreco}\n                    disabled={isCalculating}\n                    size=\"lg\"\n                    variant=\"doce\"\n                    className=\"min-w-48\"\n                  >\n                    {isCalculating ? (\n                      <>\n                        <div className=\"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2\" />\n                        Calculando...\n                      </>\n                    ) : (\n                      <>\n                        <Calculator className=\"h-5 w-5 mr-2\" />\n                        Calcular Preço\n                      </>\n                    )}\n                  </Button>\n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"avancado\">\n                <Card>\n                  <CardContent className=\"text-center py-12\">\n                    <div className=\"mx-auto w-16 h-16 bg-gradient-doce rounded-full flex items-center justify-center mb-4\">\n                      <Zap className=\"h-8 w-8 text-white\" />\n                    </div>\n                    <h3 className=\"text-xl font-semibold mb-2\">Cálculo Avançado - PRO</h3>\n                    <p className=\"text-gray-600 mb-6\">\n                      Acesse receitas salvas, análise competitiva, otimização de custos e muito mais.\n                    </p>\n                    <Button variant=\"doce\" size=\"lg\">\n                      Upgrade para PRO\n                    </Button>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n            </Tabs>\n          </div>\n\n          {/* Resultados */}\n          <div className=\"space-y-6\">\n            {resultado ? (\n              <>\n                {/* Resumo */}\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center space-x-2\">\n                      <DollarSign className=\"h-5 w-5\" />\n                      <span>Resultado</span>\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-center mb-6\">\n                      <div className=\"text-3xl font-bold text-primary mb-2\">\n                        {formatarMoeda(resultado.precoFinal)}\n                      </div>\n                      <p className=\"text-sm text-gray-600\">\n                        Preço final por unidade\n                      </p>\n                    </div>\n\n                    <div className=\"space-y-3\">\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm text-gray-600\">Ingredientes:</span>\n                        <span className=\"font-medium\">{formatarMoeda(resultado.custoIngredientes)}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm text-gray-600\">Mão de obra:</span>\n                        <span className=\"font-medium\">{formatarMoeda(resultado.custoMaoDeObra)}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm text-gray-600\">Custos fixos:</span>\n                        <span className=\"font-medium\">{formatarMoeda(resultado.custosFixos)}</span>\n                      </div>\n                      <hr />\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm text-gray-600\">Custo total:</span>\n                        <span className=\"font-medium\">{formatarMoeda(resultado.custoTotal)}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm text-gray-600\">Margem ({Math.round(margemLucro * 100)}%):</span>\n                        <span className=\"font-medium text-green-600\">\n                          +{formatarMoeda(resultado.precoFinal - resultado.custoTotal)}\n                        </span>\n                      </div>\n                    </div>\n\n                    <div className=\"mt-6 space-y-2\">\n                      {receitaCarregada && (\n                        <Button \n                          onClick={salvarResultadosNaReceita}\n                          variant=\"doce\" \n                          size=\"sm\" \n                          className=\"w-full\"\n                        >\n                          <Save className=\"h-4 w-4 mr-2\" />\n                          Salvar na Receita: {receitaCarregada.nome}\n                        </Button>\n                      )}\n                      <Button \n                        onClick={salvarCalculo}\n                        variant=\"outline\" \n                        size=\"sm\" \n                        className=\"w-full\"\n                        disabled={!isPro}\n                      >\n                        <Save className=\"h-4 w-4 mr-2\" />\n                        Salvar no Histórico {!isPro && '(PRO)'}\n                      </Button>\n                      <Button \n                        onClick={gerarRelatorio}\n                        variant=\"outline\" \n                        size=\"sm\" \n                        className=\"w-full\"\n                        disabled={!isPro}\n                      >\n                        <Download className=\"h-4 w-4 mr-2\" />\n                        Gerar PDF {!isPro && '(PRO)'}\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                {/* Breakdown dos Ingredientes */}\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center space-x-2\">\n                      <PieChart className=\"h-5 w-5\" />\n                      <span>Detalhamento</span>\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-2\">\n                      {resultado.breakdown.map((item, index) => (\n                        <div key={index} className=\"flex justify-between text-sm\">\n                          <span className=\"text-gray-600 truncate mr-2\">\n                            {formatarQuantidade(item.quantidade, ingredientes[index]?.unidade || 'g')} {item.ingrediente}\n                          </span>\n                          <span className=\"font-medium\">\n                            {formatarMoeda(item.custo)}\n                          </span>\n                        </div>\n                      ))}\n                    </div>\n                  </CardContent>\n                </Card>\n              </>\n            ) : (\n              <Card>\n                <CardContent className=\"text-center py-12\">\n                  <Calculator className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                  <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n                    Pronto para calcular!\n                  </h3>\n                  <p className=\"text-gray-600\">\n                    Preencha os dados da receita e clique em \"Calcular Preço\" \n                    para ver o resultado detalhado.\n                  </p>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Dicas */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center space-x-2\">\n                  <AlertCircle className=\"h-5 w-5\" />\n                  <span>Dicas</span>\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-2 text-sm text-gray-600\">\n                  <p>• Considere sazonalidade dos ingredientes</p>\n                  <p>• Margem de 60-80% é comum para doces artesanais</p>\n                  <p>• Inclua tempo de resfriamento/descanso</p>\n                  <p>• Pesquise preços da concorrência</p>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}","size_bytes":32257},"app/dashboard/ingredientes/page.tsx":{"content":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useAuth } from '@/components/auth/auth-provider'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { \n  Plus, \n  Search, \n  Edit,\n  Trash2,\n  Package,\n  Tag,\n  DollarSign,\n  Scale,\n  Eye,\n  EyeOff,\n  Filter,\n  X,\n  Save,\n  Palette,\n  ChefHat\n} from 'lucide-react'\nimport { useToast } from '@/hooks/use-toast'\nimport { supabase } from '@/lib/supabase-client'\nimport { formatarMoeda } from '@/lib/calculations-lib'\n\ntype Categoria = {\n  id: string\n  user_id: string\n  nome: string\n  cor: string\n  icone: string\n  created_at: string\n}\n\ntype Ingrediente = {\n  id: string\n  user_id: string\n  nome: string\n  categoria_id: string | null\n  preco_kg: number\n  unidade: 'g' | 'ml' | 'unidades'\n  densidade: number\n  ativo: boolean\n  created_at: string\n  updated_at: string\n  categoria?: Categoria\n}\n\nexport default function IngredientesPage() {\n  const { profile } = useAuth()\n  const { toast } = useToast()\n  \n  // Estados principais\n  const [ingredientes, setIngredientes] = useState<Ingrediente[]>([])\n  const [categorias, setCategorias] = useState<Categoria[]>([])\n  const [loading, setLoading] = useState(true)\n  const [searchTerm, setSearchTerm] = useState('')\n  const [filterCategoria, setFilterCategoria] = useState('')\n  const [showInactive, setShowInactive] = useState(false)\n  \n  // Estados do formulário\n  const [showForm, setShowForm] = useState(false)\n  const [editingIngrediente, setEditingIngrediente] = useState<Ingrediente | null>(null)\n  const [showCategoriaForm, setShowCategoriaForm] = useState(false)\n  const [editingCategoria, setEditingCategoria] = useState<Categoria | null>(null)\n  \n  // Form data\n  const [formData, setFormData] = useState({\n    nome: '',\n    categoria_id: '',\n    preco_kg: 0,\n    unidade: 'g' as 'g' | 'ml' | 'unidades',\n    densidade: 1,\n    ativo: true\n  })\n\n  const [categoriaFormData, setCategoriaFormData] = useState({\n    nome: '',\n    cor: '#3b82f6',\n    icone: 'Package'\n  })\n\n  const isPro = profile?.plano === 'pro'\n\n  useEffect(() => {\n    if (profile?.id) {\n      loadCategorias()\n      loadIngredientes()\n    }\n  }, [profile?.id])\n\n  const loadCategorias = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('categorias_ingredientes')\n        .select('*')\n        .eq('user_id', profile?.id)\n        .order('nome')\n\n      if (error) throw error\n      setCategorias(data || [])\n    } catch (error) {\n      console.error('Erro ao carregar categorias:', error)\n      toast({\n        title: \"Erro ao carregar categorias\",\n        description: \"Não foi possível carregar as categorias de ingredientes.\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const loadIngredientes = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('ingredientes')\n        .select(`\n          *,\n          categoria:categorias_ingredientes(*)\n        `)\n        .eq('user_id', profile?.id)\n        .order('nome')\n\n      if (error) throw error\n\n      const ingredientesFormatados = (data || []).map(item => ({\n        ...item,\n        categoria: item.categoria\n      }))\n\n      setIngredientes(ingredientesFormatados)\n    } catch (error) {\n      console.error('Erro ao carregar ingredientes:', error)\n      toast({\n        title: \"Erro ao carregar ingredientes\",\n        description: \"Não foi possível carregar os ingredientes.\",\n        variant: \"destructive\",\n      })\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleSaveIngrediente = async () => {\n    if (!formData.nome.trim()) {\n      toast({\n        title: \"Campo obrigatório\",\n        description: \"O nome do ingrediente é obrigatório.\",\n        variant: \"destructive\",\n      })\n      return\n    }\n\n    if (formData.preco_kg <= 0) {\n      toast({\n        title: \"Preço inválido\",\n        description: \"O preço deve ser maior que zero.\",\n        variant: \"destructive\",\n      })\n      return\n    }\n\n    // Validar se categoria pertence ao usuário (se categoria foi selecionada)\n    if (formData.categoria_id) {\n      const categoriaValida = categorias.find(cat => cat.id === formData.categoria_id)\n      if (!categoriaValida) {\n        toast({\n          title: \"Categoria inválida\",\n          description: \"A categoria selecionada não existe ou não pertence a você.\",\n          variant: \"destructive\",\n        })\n        return\n      }\n    }\n\n    try {\n      const ingredienteData = {\n        ...formData,\n        user_id: profile?.id,\n        categoria_id: formData.categoria_id || null,\n        updated_at: new Date().toISOString()\n      }\n\n      let result\n      if (editingIngrediente) {\n        result = await supabase\n          .from('ingredientes')\n          .update(ingredienteData)\n          .eq('id', editingIngrediente.id)\n          .eq('user_id', profile?.id) // Garantir que só pode editar seus próprios ingredientes\n          .select()\n          .single()\n      } else {\n        result = await supabase\n          .from('ingredientes')\n          .insert(ingredienteData)\n          .select()\n          .single()\n      }\n\n      if (result.error) throw result.error\n\n      toast({\n        title: editingIngrediente ? \"Ingrediente atualizado!\" : \"Ingrediente criado! 🥄\",\n        description: `${formData.nome} foi ${editingIngrediente ? 'atualizado' : 'criado'} com sucesso.`,\n      })\n\n      // Reset form\n      setFormData({\n        nome: '',\n        categoria_id: '',\n        preco_kg: 0,\n        unidade: 'g',\n        densidade: 1,\n        ativo: true\n      })\n      setShowForm(false)\n      setEditingIngrediente(null)\n      \n      // Reload ingredients\n      loadIngredientes()\n\n    } catch (error) {\n      console.error('Erro ao salvar ingrediente:', error)\n      toast({\n        title: \"Erro ao salvar ingrediente\",\n        description: \"Não foi possível salvar o ingrediente.\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleSaveCategoria = async () => {\n    if (!categoriaFormData.nome.trim()) {\n      toast({\n        title: \"Campo obrigatório\",\n        description: \"O nome da categoria é obrigatório.\",\n        variant: \"destructive\",\n      })\n      return\n    }\n\n    try {\n      const categoriaData = {\n        ...categoriaFormData,\n        user_id: profile?.id\n      }\n\n      let result\n      if (editingCategoria) {\n        result = await supabase\n          .from('categorias_ingredientes')\n          .update(categoriaData)\n          .eq('id', editingCategoria.id)\n          .eq('user_id', profile?.id) // Garantir que só pode editar suas próprias categorias\n          .select()\n          .single()\n      } else {\n        result = await supabase\n          .from('categorias_ingredientes')\n          .insert(categoriaData)\n          .select()\n          .single()\n      }\n\n      if (result.error) throw result.error\n\n      toast({\n        title: editingCategoria ? \"Categoria atualizada!\" : \"Categoria criada! 🏷️\",\n        description: `${categoriaFormData.nome} foi ${editingCategoria ? 'atualizada' : 'criada'} com sucesso.`,\n      })\n\n      // Reset form\n      setCategoriaFormData({\n        nome: '',\n        cor: '#3b82f6',\n        icone: 'Package'\n      })\n      setShowCategoriaForm(false)\n      setEditingCategoria(null)\n      \n      // Reload categories\n      loadCategorias()\n\n    } catch (error) {\n      console.error('Erro ao salvar categoria:', error)\n      toast({\n        title: \"Erro ao salvar categoria\",\n        description: \"Não foi possível salvar a categoria.\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleEditIngrediente = (ingrediente: Ingrediente) => {\n    setFormData({\n      nome: ingrediente.nome,\n      categoria_id: ingrediente.categoria_id || '',\n      preco_kg: ingrediente.preco_kg,\n      unidade: ingrediente.unidade,\n      densidade: ingrediente.densidade,\n      ativo: ingrediente.ativo\n    })\n    setEditingIngrediente(ingrediente)\n    setShowForm(true)\n  }\n\n  const handleEditCategoria = (categoria: Categoria) => {\n    setCategoriaFormData({\n      nome: categoria.nome,\n      cor: categoria.cor,\n      icone: categoria.icone\n    })\n    setEditingCategoria(categoria)\n    setShowCategoriaForm(true)\n  }\n\n  const handleDeleteIngrediente = async (ingrediente: Ingrediente) => {\n    if (!confirm(`Tem certeza que deseja excluir \"${ingrediente.nome}\"?`)) return\n\n    try {\n      // Verificar se o ingrediente está sendo usado em alguma receita\n      const { data: receitasUsando, error: checkError } = await supabase\n        .from('receita_ingredientes')\n        .select(`\n          id,\n          receita_id,\n          receitas!inner(nome, user_id)\n        `)\n        .eq('ingrediente_id', ingrediente.id)\n        .eq('receitas.user_id', profile?.id) // Só verificar receitas do usuário logado\n        .limit(1)\n\n      if (checkError) throw checkError\n\n      if (receitasUsando && receitasUsando.length > 0) {\n        const nomeReceita = (receitasUsando[0] as any).receitas?.nome\n        toast({\n          title: \"Não é possível excluir\",\n          description: `Este ingrediente está sendo usado na receita \"${nomeReceita}\" e outras. Remova-o das receitas primeiro.`,\n          variant: \"destructive\",\n        })\n        return\n      }\n\n      // Se não está sendo usado, pode excluir\n      const { error } = await supabase\n        .from('ingredientes')\n        .delete()\n        .eq('id', ingrediente.id)\n        .eq('user_id', profile?.id) // Garantir que só pode excluir seus próprios ingredientes\n\n      if (error) throw error\n\n      toast({\n        title: \"Ingrediente excluído\",\n        description: `${ingrediente.nome} foi excluído com sucesso.`,\n      })\n\n      loadIngredientes()\n    } catch (error) {\n      console.error('Erro ao excluir ingrediente:', error)\n      toast({\n        title: \"Erro ao excluir ingrediente\",\n        description: \"Não foi possível excluir o ingrediente.\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleToggleAtivo = async (ingrediente: Ingrediente) => {\n    try {\n      const { error } = await supabase\n        .from('ingredientes')\n        .update({ \n          ativo: !ingrediente.ativo,\n          updated_at: new Date().toISOString()\n        })\n        .eq('id', ingrediente.id)\n        .eq('user_id', profile?.id) // Garantir que só pode alterar seus próprios ingredientes\n\n      if (error) throw error\n\n      toast({\n        title: ingrediente.ativo ? \"Ingrediente desativado\" : \"Ingrediente ativado\",\n        description: `${ingrediente.nome} foi ${ingrediente.ativo ? 'desativado' : 'ativado'}.`,\n      })\n\n      loadIngredientes()\n    } catch (error) {\n      console.error('Erro ao alterar status:', error)\n      toast({\n        title: \"Erro ao alterar status\",\n        description: \"Não foi possível alterar o status do ingrediente.\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  // Filter ingredients\n  const ingredientesFiltrados = ingredientes.filter(ingrediente => {\n    const matchesSearch = ingrediente.nome.toLowerCase().includes(searchTerm.toLowerCase())\n    const matchesCategoria = !filterCategoria || ingrediente.categoria_id === filterCategoria\n    const matchesActive = showInactive || ingrediente.ativo\n    \n    return matchesSearch && matchesCategoria && matchesActive\n  })\n\n  const getUnidadeLabel = (unidade: string) => {\n    switch (unidade) {\n      case 'g': return 'Gramas (g)'\n      case 'ml': return 'Mililitros (ml)'\n      case 'unidades': return 'Unidades'\n      default: return unidade\n    }\n  }\n\n  const getIconForCategoria = (icone: string) => {\n    const icons: { [key: string]: any } = {\n      Package,\n      Tag,\n      ChefHat,\n      Scale\n    }\n    const IconComponent = icons[icone] || Package\n    return <IconComponent className=\"h-4 w-4\" />\n  }\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-soft flex items-center justify-center\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" />\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-soft py-8 px-4\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"text-center mb-8\">\n          <div className=\"flex items-center justify-center space-x-2 mb-4\">\n            <Package className=\"h-8 w-8 text-primary\" />\n            <h1 className=\"text-3xl font-display font-bold text-gray-900\">\n              Banco de Ingredientes\n            </h1>\n          </div>\n          <p className=\"text-gray-600 max-w-2xl mx-auto\">\n            Gerencie seus ingredientes, categorias e preços para cálculos precisos\n          </p>\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex flex-col sm:flex-row gap-4 mb-8\">\n          <Button \n            onClick={() => setShowForm(true)}\n            variant=\"doce\" \n            size=\"lg\"\n          >\n            <Plus className=\"h-5 w-5 mr-2\" />\n            Novo Ingrediente\n          </Button>\n          \n          <Button \n            onClick={() => setShowCategoriaForm(true)}\n            variant=\"outline\" \n            size=\"lg\"\n          >\n            <Tag className=\"h-5 w-5 mr-2\" />\n            Nova Categoria\n          </Button>\n        </div>\n\n        {/* Formulário de Ingrediente */}\n        {showForm && (\n          <Card className=\"mb-8\">\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle>\n                    {editingIngrediente ? 'Editar Ingrediente' : 'Novo Ingrediente'}\n                  </CardTitle>\n                  <CardDescription>\n                    {editingIngrediente ? 'Atualize os dados do ingrediente' : 'Adicione um novo ingrediente ao banco de dados'}\n                  </CardDescription>\n                </div>\n                <Button \n                  variant=\"ghost\" \n                  size=\"sm\"\n                  onClick={() => {\n                    setShowForm(false)\n                    setEditingIngrediente(null)\n                    setFormData({\n                      nome: '',\n                      categoria_id: '',\n                      preco_kg: 0,\n                      unidade: 'g',\n                      densidade: 1,\n                      ativo: true\n                    })\n                  }}\n                >\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <Label htmlFor=\"nome\">Nome do Ingrediente</Label>\n                  <Input\n                    id=\"nome\"\n                    value={formData.nome}\n                    onChange={(e) => setFormData(prev => ({ ...prev, nome: e.target.value }))}\n                    placeholder=\"Ex: Açúcar Cristal\"\n                  />\n                </div>\n                <div>\n                  <Label htmlFor=\"categoria\">Categoria</Label>\n                  <select\n                    id=\"categoria\"\n                    value={formData.categoria_id}\n                    onChange={(e) => setFormData(prev => ({ ...prev, categoria_id: e.target.value }))}\n                    className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n                  >\n                    <option value=\"\">Sem categoria</option>\n                    {categorias.map(categoria => (\n                      <option key={categoria.id} value={categoria.id}>\n                        {categoria.nome}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n                <div>\n                  <Label htmlFor=\"preco\">Preço por Kg/L (R$)</Label>\n                  <Input\n                    id=\"preco\"\n                    type=\"number\"\n                    value={formData.preco_kg}\n                    onChange={(e) => setFormData(prev => ({ ...prev, preco_kg: Number(e.target.value) }))}\n                    min=\"0\"\n                    step=\"0.01\"\n                    placeholder=\"0.00\"\n                  />\n                </div>\n                <div>\n                  <Label htmlFor=\"unidade\">Unidade de Medida</Label>\n                  <select\n                    id=\"unidade\"\n                    value={formData.unidade}\n                    onChange={(e) => setFormData(prev => ({ ...prev, unidade: e.target.value as any }))}\n                    className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n                  >\n                    <option value=\"g\">Gramas (g)</option>\n                    <option value=\"ml\">Mililitros (ml)</option>\n                    <option value=\"unidades\">Unidades</option>\n                  </select>\n                </div>\n                <div>\n                  <Label htmlFor=\"densidade\">Densidade</Label>\n                  <Input\n                    id=\"densidade\"\n                    type=\"number\"\n                    value={formData.densidade}\n                    onChange={(e) => setFormData(prev => ({ ...prev, densidade: Number(e.target.value) }))}\n                    min=\"0.1\"\n                    step=\"0.1\"\n                    placeholder=\"1.0\"\n                  />\n                  <p className=\"text-xs text-gray-500 mt-1\">\n                    Para conversões entre peso e volume (padrão: 1.0)\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"flex items-center space-x-2\">\n                <input\n                  type=\"checkbox\"\n                  id=\"ativo\"\n                  checked={formData.ativo}\n                  onChange={(e) => setFormData(prev => ({ ...prev, ativo: e.target.checked }))}\n                  className=\"rounded\"\n                />\n                <Label htmlFor=\"ativo\" className=\"text-sm\">\n                  Ingrediente ativo (disponível para uso)\n                </Label>\n              </div>\n\n              <div className=\"flex gap-4\">\n                <Button onClick={handleSaveIngrediente} variant=\"doce\">\n                  <Save className=\"h-4 w-4 mr-2\" />\n                  {editingIngrediente ? 'Atualizar Ingrediente' : 'Criar Ingrediente'}\n                </Button>\n                <Button \n                  onClick={() => {\n                    setShowForm(false)\n                    setEditingIngrediente(null)\n                    setFormData({\n                      nome: '',\n                      categoria_id: '',\n                      preco_kg: 0,\n                      unidade: 'g',\n                      densidade: 1,\n                      ativo: true\n                    })\n                  }}\n                  variant=\"outline\"\n                >\n                  Cancelar\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Formulário de Categoria */}\n        {showCategoriaForm && (\n          <Card className=\"mb-8\">\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle>\n                    {editingCategoria ? 'Editar Categoria' : 'Nova Categoria'}\n                  </CardTitle>\n                  <CardDescription>\n                    {editingCategoria ? 'Atualize os dados da categoria' : 'Crie uma nova categoria para organizar ingredientes'}\n                  </CardDescription>\n                </div>\n                <Button \n                  variant=\"ghost\" \n                  size=\"sm\"\n                  onClick={() => {\n                    setShowCategoriaForm(false)\n                    setEditingCategoria(null)\n                    setCategoriaFormData({\n                      nome: '',\n                      cor: '#3b82f6',\n                      icone: 'Package'\n                    })\n                  }}\n                >\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                <div>\n                  <Label htmlFor=\"nomeCategoria\">Nome da Categoria</Label>\n                  <Input\n                    id=\"nomeCategoria\"\n                    value={categoriaFormData.nome}\n                    onChange={(e) => setCategoriaFormData(prev => ({ ...prev, nome: e.target.value }))}\n                    placeholder=\"Ex: Açúcares\"\n                  />\n                </div>\n                <div>\n                  <Label htmlFor=\"cor\">Cor</Label>\n                  <div className=\"flex items-center space-x-2\">\n                    <input\n                      type=\"color\"\n                      id=\"cor\"\n                      value={categoriaFormData.cor}\n                      onChange={(e) => setCategoriaFormData(prev => ({ ...prev, cor: e.target.value }))}\n                      className=\"w-10 h-10 rounded border\"\n                    />\n                    <Input\n                      value={categoriaFormData.cor}\n                      onChange={(e) => setCategoriaFormData(prev => ({ ...prev, cor: e.target.value }))}\n                      placeholder=\"#3b82f6\"\n                      className=\"flex-1\"\n                    />\n                  </div>\n                </div>\n                <div>\n                  <Label htmlFor=\"icone\">Ícone</Label>\n                  <select\n                    id=\"icone\"\n                    value={categoriaFormData.icone}\n                    onChange={(e) => setCategoriaFormData(prev => ({ ...prev, icone: e.target.value }))}\n                    className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n                  >\n                    <option value=\"Package\">Pacote</option>\n                    <option value=\"Tag\">Etiqueta</option>\n                    <option value=\"ChefHat\">Chef</option>\n                    <option value=\"Scale\">Balança</option>\n                  </select>\n                </div>\n              </div>\n\n              <div className=\"flex gap-4\">\n                <Button onClick={handleSaveCategoria} variant=\"doce\">\n                  <Save className=\"h-4 w-4 mr-2\" />\n                  {editingCategoria ? 'Atualizar Categoria' : 'Criar Categoria'}\n                </Button>\n                <Button \n                  onClick={() => {\n                    setShowCategoriaForm(false)\n                    setEditingCategoria(null)\n                    setCategoriaFormData({\n                      nome: '',\n                      cor: '#3b82f6',\n                      icone: 'Package'\n                    })\n                  }}\n                  variant=\"outline\"\n                >\n                  Cancelar\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Filtros */}\n        <Card className=\"mb-8\">\n          <CardContent className=\"pt-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n              <div className=\"md:col-span-2\">\n                <div className=\"relative\">\n                  <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4\" />\n                  <Input\n                    placeholder=\"Pesquisar ingredientes...\"\n                    value={searchTerm}\n                    onChange={(e) => setSearchTerm(e.target.value)}\n                    className=\"pl-10\"\n                  />\n                </div>\n              </div>\n              <div>\n                <select\n                  value={filterCategoria}\n                  onChange={(e) => setFilterCategoria(e.target.value)}\n                  className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n                >\n                  <option value=\"\">Todas categorias</option>\n                  {categorias.map(categoria => (\n                    <option key={categoria.id} value={categoria.id}>\n                      {categoria.nome}\n                    </option>\n                  ))}\n                </select>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <input\n                  type=\"checkbox\"\n                  id=\"showInactive\"\n                  checked={showInactive}\n                  onChange={(e) => setShowInactive(e.target.checked)}\n                  className=\"rounded\"\n                />\n                <Label htmlFor=\"showInactive\" className=\"text-sm\">\n                  Mostrar inativos\n                </Label>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Lista de Ingredientes */}\n        {ingredientes.length === 0 ? (\n          <Card>\n            <CardContent className=\"text-center py-12\">\n              <Package className=\"h-16 w-16 text-gray-400 mx-auto mb-4\" />\n              <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">\n                Nenhum ingrediente encontrado\n              </h3>\n              <p className=\"text-gray-600 mb-6\">\n                Comece criando seus primeiros ingredientes para usar nas receitas.\n              </p>\n              <Button onClick={() => setShowForm(true)} variant=\"doce\">\n                <Plus className=\"h-5 w-5 mr-2\" />\n                Criar Primeiro Ingrediente\n              </Button>\n            </CardContent>\n          </Card>\n        ) : ingredientesFiltrados.length === 0 ? (\n          <Card>\n            <CardContent className=\"text-center py-12\">\n              <Search className=\"h-16 w-16 text-gray-400 mx-auto mb-4\" />\n              <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">\n                Nenhum resultado encontrado\n              </h3>\n              <p className=\"text-gray-600\">\n                Tente ajustar os filtros ou termo de pesquisa.\n              </p>\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {ingredientesFiltrados.map((ingrediente) => (\n              <Card key={ingrediente.id} className={`hover:shadow-lg transition-shadow ${!ingrediente.ativo ? 'opacity-60' : ''}`}>\n                <CardHeader className=\"pb-3\">\n                  <div className=\"flex items-start justify-between\">\n                    <div className=\"flex-1\">\n                      <CardTitle className=\"text-lg mb-2 flex items-center space-x-2\">\n                        <span>{ingrediente.nome}</span>\n                        {!ingrediente.ativo && (\n                          <Badge variant=\"outline\" className=\"text-xs text-red-600\">\n                            Inativo\n                          </Badge>\n                        )}\n                      </CardTitle>\n                      \n                      {ingrediente.categoria && (\n                        <div className=\"flex items-center space-x-2 mb-2\">\n                          <div \n                            className=\"w-4 h-4 rounded flex items-center justify-center\"\n                            style={{ backgroundColor: ingrediente.categoria.cor }}\n                          >\n                            {getIconForCategoria(ingrediente.categoria.icone)}\n                          </div>\n                          <Badge variant=\"outline\" className=\"text-xs\">\n                            {ingrediente.categoria.nome}\n                          </Badge>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </CardHeader>\n                \n                <CardContent className=\"space-y-4\">\n                  <div className=\"space-y-2 text-sm\">\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-600\">Preço:</span>\n                      <span className=\"font-medium\">{formatarMoeda(ingrediente.preco_kg)}/kg</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-600\">Unidade:</span>\n                      <span className=\"font-medium\">{getUnidadeLabel(ingrediente.unidade)}</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-600\">Densidade:</span>\n                      <span className=\"font-medium\">{ingrediente.densidade}</span>\n                    </div>\n                  </div>\n\n                  <div className=\"flex flex-wrap gap-2\">\n                    <Button \n                      size=\"sm\" \n                      variant=\"outline\"\n                      onClick={() => handleEditIngrediente(ingrediente)}\n                    >\n                      <Edit className=\"h-4 w-4 mr-1\" />\n                      Editar\n                    </Button>\n                    <Button \n                      size=\"sm\" \n                      variant=\"outline\"\n                      onClick={() => handleToggleAtivo(ingrediente)}\n                    >\n                      {ingrediente.ativo ? (\n                        <EyeOff className=\"h-4 w-4 mr-1\" />\n                      ) : (\n                        <Eye className=\"h-4 w-4 mr-1\" />\n                      )}\n                      {ingrediente.ativo ? 'Desativar' : 'Ativar'}\n                    </Button>\n                    <Button \n                      size=\"sm\" \n                      variant=\"outline\"\n                      onClick={() => handleDeleteIngrediente(ingrediente)}\n                      className=\"text-red-600 hover:text-red-700\"\n                    >\n                      <Trash2 className=\"h-4 w-4 mr-1\" />\n                      Excluir\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}","size_bytes":30625},"app/dashboard/orcamentos/page.tsx":{"content":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useAuth } from '@/components/auth/auth-provider'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { \n  Plus, \n  Search, \n  Edit,\n  Trash2,\n  FileText,\n  DollarSign,\n  Users,\n  Eye,\n  Calendar,\n  CheckCircle,\n  Clock,\n  XCircle,\n  Download,\n  Send,\n  Filter,\n  X,\n  Save,\n  Calculator,\n  Crown\n} from 'lucide-react'\nimport { useToast } from '@/hooks/use-toast'\nimport { supabase } from '@/lib/supabase-client'\nimport { formatarMoeda } from '@/lib/calculations-lib'\n\ntype StatusOrcamento = 'pendente' | 'aprovado' | 'rejeitado' | 'concluido'\n\ntype ItemOrcamento = {\n  receita_id: string\n  nome_receita: string\n  quantidade: number\n  preco_unitario: number\n  subtotal: number\n}\n\ntype Orcamento = {\n  id: string\n  user_id: string\n  cliente_nome: string\n  cliente_contato: string | null\n  itens: ItemOrcamento[]\n  valor_total: number\n  status: StatusOrcamento\n  observacoes: string | null\n  valido_ate: string | null\n  created_at: string\n  updated_at: string\n}\n\ntype Receita = {\n  id: string\n  nome: string\n  preco_sugerido: number | null\n  custo_calculado: number | null\n}\n\nexport default function OrcamentosPage() {\n  const { profile } = useAuth()\n  const { toast } = useToast()\n  \n  // Estados principais\n  const [orcamentos, setOrcamentos] = useState<Orcamento[]>([])\n  const [receitas, setReceitas] = useState<Receita[]>([])\n  const [loading, setLoading] = useState(true)\n  const [searchTerm, setSearchTerm] = useState('')\n  const [filterStatus, setFilterStatus] = useState('')\n  \n  // Estados do formulário\n  const [showForm, setShowForm] = useState(false)\n  const [editingOrcamento, setEditingOrcamento] = useState<Orcamento | null>(null)\n  const [showDetails, setShowDetails] = useState<Orcamento | null>(null)\n  \n  // Form data\n  const [formData, setFormData] = useState({\n    cliente_nome: '',\n    cliente_contato: '',\n    observacoes: '',\n    valido_ate: ''\n  })\n\n  const [itensOrcamento, setItensOrcamento] = useState<ItemOrcamento[]>([])\n\n  const isPro = profile?.plano === 'pro'\n\n  useEffect(() => {\n    if (profile?.id) {\n      loadOrcamentos()\n      loadReceitas()\n    }\n  }, [profile?.id])\n\n  const loadOrcamentos = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('orcamentos')\n        .select('*')\n        .eq('user_id', profile?.id)\n        .order('created_at', { ascending: false })\n\n      if (error) throw error\n      setOrcamentos(data || [])\n    } catch (error) {\n      console.error('Erro ao carregar orçamentos:', error)\n      toast({\n        title: \"Erro ao carregar orçamentos\",\n        description: \"Não foi possível carregar os orçamentos.\",\n        variant: \"destructive\",\n      })\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const loadReceitas = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('receitas')\n        .select('id, nome, preco_sugerido, custo_calculado')\n        .eq('user_id', profile?.id)\n        .eq('ativa', true)\n        .order('nome')\n\n      if (error) throw error\n      setReceitas(data || [])\n    } catch (error) {\n      console.error('Erro ao carregar receitas:', error)\n    }\n  }\n\n  const adicionarItem = () => {\n    setItensOrcamento([\n      ...itensOrcamento,\n      {\n        receita_id: '',\n        nome_receita: '',\n        quantidade: 1,\n        preco_unitario: 0,\n        subtotal: 0\n      }\n    ])\n  }\n\n  const removerItem = (index: number) => {\n    setItensOrcamento(itensOrcamento.filter((_, i) => i !== index))\n  }\n\n  const atualizarItem = (index: number, campo: string, valor: any) => {\n    const novosItens = [...itensOrcamento]\n    \n    if (campo === 'receita_id') {\n      const receita = receitas.find(r => r.id === valor)\n      if (receita) {\n        novosItens[index] = {\n          ...novosItens[index],\n          receita_id: valor,\n          nome_receita: receita.nome,\n          preco_unitario: receita.preco_sugerido || receita.custo_calculado || 0\n        }\n      }\n    } else {\n      novosItens[index] = { ...novosItens[index], [campo]: valor }\n    }\n\n    // Recalcular subtotal\n    if (campo === 'quantidade' || campo === 'preco_unitario' || campo === 'receita_id') {\n      novosItens[index].subtotal = novosItens[index].quantidade * novosItens[index].preco_unitario\n    }\n\n    setItensOrcamento(novosItens)\n  }\n\n  const calcularTotal = () => {\n    return itensOrcamento.reduce((total, item) => total + item.subtotal, 0)\n  }\n\n  const handleSaveOrcamento = async () => {\n    if (!formData.cliente_nome.trim()) {\n      toast({\n        title: \"Campo obrigatório\",\n        description: \"O nome do cliente é obrigatório.\",\n        variant: \"destructive\",\n      })\n      return\n    }\n\n    if (itensOrcamento.length === 0) {\n      toast({\n        title: \"Itens necessários\",\n        description: \"Adicione pelo menos um item ao orçamento.\",\n        variant: \"destructive\",\n      })\n      return\n    }\n\n    const itensValidos = itensOrcamento.filter(item => \n      item.receita_id && item.quantidade > 0 && item.preco_unitario > 0\n    )\n\n    if (itensValidos.length === 0) {\n      toast({\n        title: \"Itens inválidos\",\n        description: \"Verifique se todos os itens têm receita, quantidade e preço válidos.\",\n        variant: \"destructive\",\n      })\n      return\n    }\n\n    try {\n      const orcamentoData = {\n        ...formData,\n        user_id: profile?.id,\n        itens: itensValidos,\n        valor_total: calcularTotal(),\n        updated_at: new Date().toISOString()\n      }\n\n      let result\n      if (editingOrcamento) {\n        result = await supabase\n          .from('orcamentos')\n          .update(orcamentoData)\n          .eq('id', editingOrcamento.id)\n          .eq('user_id', profile?.id)\n          .select()\n          .single()\n      } else {\n        // Para novos orçamentos, definir status e created_at explicitamente\n        const novoOrcamentoData = {\n          ...orcamentoData,\n          status: 'pendente',\n          created_at: new Date().toISOString()\n        }\n        \n        result = await supabase\n          .from('orcamentos')\n          .insert(novoOrcamentoData)\n          .select()\n          .single()\n      }\n\n      if (result.error) throw result.error\n\n      toast({\n        title: editingOrcamento ? \"Orçamento atualizado!\" : \"Orçamento criado! 💼\",\n        description: `Orçamento para ${formData.cliente_nome} foi ${editingOrcamento ? 'atualizado' : 'criado'} com sucesso.`,\n      })\n\n      // Reset form\n      setFormData({\n        cliente_nome: '',\n        cliente_contato: '',\n        observacoes: '',\n        valido_ate: ''\n      })\n      setItensOrcamento([])\n      setShowForm(false)\n      setEditingOrcamento(null)\n      \n      // Reload orçamentos\n      loadOrcamentos()\n\n    } catch (error) {\n      console.error('Erro ao salvar orçamento:', error)\n      toast({\n        title: \"Erro ao salvar orçamento\",\n        description: \"Não foi possível salvar o orçamento.\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleEditOrcamento = (orcamento: Orcamento) => {\n    setFormData({\n      cliente_nome: orcamento.cliente_nome,\n      cliente_contato: orcamento.cliente_contato || '',\n      observacoes: orcamento.observacoes || '',\n      valido_ate: orcamento.valido_ate || ''\n    })\n    setItensOrcamento(orcamento.itens)\n    setEditingOrcamento(orcamento)\n    setShowForm(true)\n  }\n\n  const handleUpdateStatus = async (orcamento: Orcamento, novoStatus: StatusOrcamento) => {\n    try {\n      const { error } = await supabase\n        .from('orcamentos')\n        .update({ \n          status: novoStatus,\n          updated_at: new Date().toISOString()\n        })\n        .eq('id', orcamento.id)\n        .eq('user_id', profile?.id)\n\n      if (error) throw error\n\n      toast({\n        title: \"Status atualizado\",\n        description: `Orçamento marcado como ${novoStatus}.`,\n      })\n\n      loadOrcamentos()\n    } catch (error) {\n      console.error('Erro ao atualizar status:', error)\n      toast({\n        title: \"Erro ao atualizar status\",\n        description: \"Não foi possível atualizar o status do orçamento.\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleDeleteOrcamento = async (orcamento: Orcamento) => {\n    if (!confirm(`Tem certeza que deseja excluir o orçamento para \"${orcamento.cliente_nome}\"?`)) return\n\n    try {\n      const { error } = await supabase\n        .from('orcamentos')\n        .delete()\n        .eq('id', orcamento.id)\n        .eq('user_id', profile?.id)\n\n      if (error) throw error\n\n      toast({\n        title: \"Orçamento excluído\",\n        description: `Orçamento para ${orcamento.cliente_nome} foi excluído.`,\n      })\n\n      loadOrcamentos()\n    } catch (error) {\n      console.error('Erro ao excluir orçamento:', error)\n      toast({\n        title: \"Erro ao excluir orçamento\",\n        description: \"Não foi possível excluir o orçamento.\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const gerarPdfOrcamento = (orcamento: Orcamento) => {\n    const htmlContent = `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <meta charset=\"utf-8\">\n      <title>Orçamento - ${orcamento.cliente_nome}</title>\n      <style>\n        body { \n          font-family: Arial, sans-serif; \n          padding: 20px; \n          color: #333;\n          line-height: 1.6;\n        }\n        .header { \n          text-align: center; \n          border-bottom: 2px solid #e91e63; \n          padding-bottom: 20px; \n          margin-bottom: 30px; \n        }\n        .logo { \n          font-size: 24px; \n          font-weight: bold; \n          color: #e91e63; \n        }\n        .client-info { \n          background-color: #f8f9fa; \n          padding: 15px; \n          border-radius: 8px; \n          margin-bottom: 20px; \n        }\n        .items-table { \n          width: 100%; \n          border-collapse: collapse; \n          margin: 20px 0; \n        }\n        .items-table th, .items-table td { \n          border: 1px solid #ddd; \n          padding: 12px; \n          text-align: left; \n        }\n        .items-table th { \n          background-color: #e91e63; \n          color: white; \n        }\n        .total { \n          text-align: right; \n          font-size: 18px; \n          font-weight: bold; \n          margin-top: 20px; \n          padding: 15px; \n          background-color: #f8f9fa; \n          border-radius: 8px; \n        }\n        .footer { \n          margin-top: 30px; \n          padding-top: 20px; \n          border-top: 1px solid #ddd; \n          text-align: center; \n          color: #666; \n          font-size: 12px; \n        }\n        .status { \n          display: inline-block; \n          padding: 4px 12px; \n          border-radius: 16px; \n          font-size: 12px; \n          font-weight: bold; \n        }\n        .status.pendente { background-color: #fff3cd; color: #856404; }\n        .status.aprovado { background-color: #d4edda; color: #155724; }\n        .status.rejeitado { background-color: #f8d7da; color: #721c24; }\n        .status.concluido { background-color: #d1ecf1; color: #0c5460; }\n        @media print {\n          body { margin: 0; }\n          .no-print { display: none; }\n        }\n      </style>\n    </head>\n    <body>\n      <div class=\"header\">\n        <div class=\"logo\">🍰 DoceCalc</div>\n        <h2>Orçamento Profissional</h2>\n        <p>Data: ${new Date(orcamento.created_at).toLocaleDateString('pt-BR')}</p>\n      </div>\n\n      <div class=\"client-info\">\n        <h3>Dados do Cliente</h3>\n        <p><strong>Nome:</strong> ${orcamento.cliente_nome}</p>\n        ${orcamento.cliente_contato ? `<p><strong>Contato:</strong> ${orcamento.cliente_contato}</p>` : ''}\n        <p><strong>Status:</strong> \n          <span class=\"status ${orcamento.status}\">${orcamento.status.toUpperCase()}</span>\n        </p>\n        ${orcamento.valido_ate ? `<p><strong>Válido até:</strong> ${new Date(orcamento.valido_ate).toLocaleDateString('pt-BR')}</p>` : ''}\n      </div>\n\n      <h3>Itens do Orçamento</h3>\n      <table class=\"items-table\">\n        <thead>\n          <tr>\n            <th>Item</th>\n            <th>Quantidade</th>\n            <th>Preço Unitário</th>\n            <th>Subtotal</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${orcamento.itens.map(item => `\n            <tr>\n              <td>${item.nome_receita}</td>\n              <td>${item.quantidade}</td>\n              <td>R$ ${item.preco_unitario.toFixed(2)}</td>\n              <td>R$ ${item.subtotal.toFixed(2)}</td>\n            </tr>\n          `).join('')}\n        </tbody>\n      </table>\n\n      <div class=\"total\">\n        <p>Valor Total: R$ ${orcamento.valor_total.toFixed(2)}</p>\n      </div>\n\n      ${orcamento.observacoes ? `\n        <div style=\"margin-top: 20px;\">\n          <h3>Observações</h3>\n          <p>${orcamento.observacoes}</p>\n        </div>\n      ` : ''}\n\n      <div class=\"footer\">\n        <p>Orçamento gerado pelo DoceCalc - Sistema de Gestão para Confeiteiras</p>\n        <p>Este orçamento é válido conforme condições especificadas.</p>\n      </div>\n\n      <div class=\"no-print\" style=\"margin-top: 30px; text-align: center;\">\n        <button onclick=\"window.print()\" style=\"background: #e91e63; color: white; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; font-size: 16px;\">\n          🖨️ Imprimir / Salvar PDF\n        </button>\n        <button onclick=\"window.close()\" style=\"background: #6c757d; color: white; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; font-size: 16px; margin-left: 10px;\">\n          ✕ Fechar\n        </button>\n      </div>\n    </body>\n    </html>\n    `\n\n    const newWindow = window.open('', '_blank')\n    if (newWindow) {\n      newWindow.document.write(htmlContent)\n      newWindow.document.close()\n    } else {\n      toast({\n        title: \"Erro ao exportar\",\n        description: \"Não foi possível abrir a janela de exportação. Verifique se pop-ups estão permitidos.\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  // Filter orçamentos\n  const orcamentosFiltrados = orcamentos.filter(orcamento => {\n    const matchesSearch = orcamento.cliente_nome.toLowerCase().includes(searchTerm.toLowerCase())\n    const matchesStatus = !filterStatus || orcamento.status === filterStatus\n    \n    return matchesSearch && matchesStatus\n  })\n\n  const getStatusBadge = (status: StatusOrcamento) => {\n    const configs = {\n      pendente: { color: 'bg-yellow-100 text-yellow-800', icon: Clock, text: 'Pendente' },\n      aprovado: { color: 'bg-green-100 text-green-800', icon: CheckCircle, text: 'Aprovado' },\n      rejeitado: { color: 'bg-red-100 text-red-800', icon: XCircle, text: 'Rejeitado' },\n      concluido: { color: 'bg-blue-100 text-blue-800', icon: CheckCircle, text: 'Concluído' }\n    }\n    \n    const config = configs[status]\n    const Icon = config.icon\n    \n    return (\n      <Badge className={`${config.color} border-0`}>\n        <Icon className=\"h-3 w-3 mr-1\" />\n        {config.text}\n      </Badge>\n    )\n  }\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('pt-BR')\n  }\n\n  if (!isPro) {\n    return (\n      <div className=\"min-h-screen bg-gradient-soft flex items-center justify-center py-8 px-4\">\n        <Card className=\"max-w-lg mx-auto text-center\">\n          <CardHeader>\n            <div className=\"w-16 h-16 bg-gradient-doce rounded-full flex items-center justify-center mx-auto mb-4\">\n              <Crown className=\"h-8 w-8 text-white\" />\n            </div>\n            <CardTitle className=\"text-2xl\">Funcionalidade PRO</CardTitle>\n            <CardDescription>\n              O sistema de orçamentos profissionais está disponível apenas no plano PRO\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4 text-sm text-gray-600\">\n              <div className=\"flex items-center space-x-3\">\n                <CheckCircle className=\"h-5 w-5 text-green-500\" />\n                <span>Orçamentos ilimitados para clientes</span>\n              </div>\n              <div className=\"flex items-center space-x-3\">\n                <CheckCircle className=\"h-5 w-5 text-green-500\" />\n                <span>Controle de status e validade</span>\n              </div>\n              <div className=\"flex items-center space-x-3\">\n                <CheckCircle className=\"h-5 w-5 text-green-500\" />\n                <span>Exportação em PDF profissional</span>\n              </div>\n              <div className=\"flex items-center space-x-3\">\n                <CheckCircle className=\"h-5 w-5 text-green-500\" />\n                <span>Histórico completo de orçamentos</span>\n              </div>\n            </div>\n            \n            <Button asChild className=\"w-full mt-6\" variant=\"doce\">\n              <a href=\"/dashboard/upgrade\">\n                <Crown className=\"h-4 w-4 mr-2\" />\n                Fazer Upgrade para PRO\n              </a>\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    )\n  }\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-soft flex items-center justify-center\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" />\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-soft py-8 px-4\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"text-center mb-8\">\n          <div className=\"flex items-center justify-center space-x-2 mb-4\">\n            <FileText className=\"h-8 w-8 text-primary\" />\n            <h1 className=\"text-3xl font-display font-bold text-gray-900\">\n              Orçamentos Profissionais\n            </h1>\n            <Badge className=\"bg-gradient-doce text-white\">\n              <Crown className=\"h-3 w-3 mr-1\" />\n              PRO\n            </Badge>\n          </div>\n          <p className=\"text-gray-600 max-w-2xl mx-auto\">\n            Crie e gerencie orçamentos profissionais para seus clientes com controle completo de status e validade\n          </p>\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex flex-col sm:flex-row gap-4 mb-8\">\n          <Button \n            onClick={() => setShowForm(true)}\n            variant=\"doce\" \n            size=\"lg\"\n          >\n            <Plus className=\"h-5 w-5 mr-2\" />\n            Novo Orçamento\n          </Button>\n        </div>\n\n        {/* Filters */}\n        <Card className=\"mb-8\">\n          <CardContent className=\"p-4\">\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <div>\n                <Label htmlFor=\"search\">Buscar Cliente</Label>\n                <div className=\"relative\">\n                  <Search className=\"absolute left-3 top-3 h-4 w-4 text-gray-400\" />\n                  <Input\n                    id=\"search\"\n                    value={searchTerm}\n                    onChange={(e) => setSearchTerm(e.target.value)}\n                    placeholder=\"Nome do cliente...\"\n                    className=\"pl-10\"\n                  />\n                </div>\n              </div>\n              <div>\n                <Label htmlFor=\"status\">Status</Label>\n                <select\n                  id=\"status\"\n                  value={filterStatus}\n                  onChange={(e) => setFilterStatus(e.target.value)}\n                  className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n                >\n                  <option value=\"\">Todos os status</option>\n                  <option value=\"pendente\">Pendente</option>\n                  <option value=\"aprovado\">Aprovado</option>\n                  <option value=\"rejeitado\">Rejeitado</option>\n                  <option value=\"concluido\">Concluído</option>\n                </select>\n              </div>\n              <div className=\"flex items-end\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => {\n                    setSearchTerm('')\n                    setFilterStatus('')\n                  }}\n                  className=\"w-full\"\n                >\n                  <X className=\"h-4 w-4 mr-2\" />\n                  Limpar Filtros\n                </Button>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Formulário de Orçamento */}\n        {showForm && (\n          <Card className=\"mb-8\">\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle>\n                    {editingOrcamento ? 'Editar Orçamento' : 'Novo Orçamento'}\n                  </CardTitle>\n                  <CardDescription>\n                    {editingOrcamento ? 'Atualize os dados do orçamento' : 'Crie um novo orçamento para seu cliente'}\n                  </CardDescription>\n                </div>\n                <Button \n                  variant=\"ghost\" \n                  size=\"sm\"\n                  onClick={() => {\n                    setShowForm(false)\n                    setEditingOrcamento(null)\n                    setFormData({\n                      cliente_nome: '',\n                      cliente_contato: '',\n                      observacoes: '',\n                      valido_ate: ''\n                    })\n                    setItensOrcamento([])\n                  }}\n                >\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-6\">\n              {/* Dados do Cliente */}\n              <div>\n                <h3 className=\"text-lg font-semibold mb-4 flex items-center\">\n                  <Users className=\"h-5 w-5 mr-2\" />\n                  Dados do Cliente\n                </h3>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div>\n                    <Label htmlFor=\"cliente\">Nome do Cliente *</Label>\n                    <Input\n                      id=\"cliente\"\n                      value={formData.cliente_nome}\n                      onChange={(e) => setFormData(prev => ({ ...prev, cliente_nome: e.target.value }))}\n                      placeholder=\"Nome completo ou empresa\"\n                    />\n                  </div>\n                  <div>\n                    <Label htmlFor=\"contato\">Contato</Label>\n                    <Input\n                      id=\"contato\"\n                      value={formData.cliente_contato}\n                      onChange={(e) => setFormData(prev => ({ ...prev, cliente_contato: e.target.value }))}\n                      placeholder=\"Telefone ou email\"\n                    />\n                  </div>\n                  <div>\n                    <Label htmlFor=\"validade\">Válido até</Label>\n                    <Input\n                      id=\"validade\"\n                      type=\"date\"\n                      value={formData.valido_ate}\n                      onChange={(e) => setFormData(prev => ({ ...prev, valido_ate: e.target.value }))}\n                    />\n                  </div>\n                </div>\n              </div>\n\n              {/* Itens do Orçamento */}\n              <div>\n                <div className=\"flex items-center justify-between mb-4\">\n                  <h3 className=\"text-lg font-semibold flex items-center\">\n                    <Calculator className=\"h-5 w-5 mr-2\" />\n                    Itens do Orçamento\n                  </h3>\n                  <Button onClick={adicionarItem} size=\"sm\" variant=\"outline\">\n                    <Plus className=\"h-4 w-4 mr-1\" />\n                    Adicionar Item\n                  </Button>\n                </div>\n                \n                <div className=\"space-y-4\">\n                  {itensOrcamento.map((item, index) => (\n                    <div key={index} className=\"grid grid-cols-12 gap-2 items-end p-4 border rounded-lg\">\n                      <div className=\"col-span-4\">\n                        <Label className=\"text-xs\">Receita</Label>\n                        <select\n                          value={item.receita_id}\n                          onChange={(e) => atualizarItem(index, 'receita_id', e.target.value)}\n                          className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n                        >\n                          <option value=\"\">Selecione uma receita</option>\n                          {receitas.map(receita => (\n                            <option key={receita.id} value={receita.id}>\n                              {receita.nome}\n                            </option>\n                          ))}\n                        </select>\n                      </div>\n                      <div className=\"col-span-2\">\n                        <Label className=\"text-xs\">Quantidade</Label>\n                        <Input\n                          type=\"number\"\n                          value={item.quantidade}\n                          onChange={(e) => atualizarItem(index, 'quantidade', Number(e.target.value))}\n                          min=\"1\"\n                          className=\"h-10\"\n                        />\n                      </div>\n                      <div className=\"col-span-2\">\n                        <Label className=\"text-xs\">Preço Unit. (R$)</Label>\n                        <Input\n                          type=\"number\"\n                          value={item.preco_unitario}\n                          onChange={(e) => atualizarItem(index, 'preco_unitario', Number(e.target.value))}\n                          min=\"0\"\n                          step=\"0.01\"\n                          className=\"h-10\"\n                        />\n                      </div>\n                      <div className=\"col-span-3\">\n                        <Label className=\"text-xs\">Subtotal</Label>\n                        <div className=\"h-10 px-3 py-2 bg-gray-50 rounded-md flex items-center text-sm font-medium\">\n                          {formatarMoeda(item.subtotal)}\n                        </div>\n                      </div>\n                      <div className=\"col-span-1\">\n                        <Button\n                          onClick={() => removerItem(index)}\n                          size=\"sm\"\n                          variant=\"ghost\"\n                          className=\"text-red-500 hover:text-red-700\"\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    </div>\n                  ))}\n                  \n                  {itensOrcamento.length === 0 && (\n                    <div className=\"text-center py-8 text-gray-500\">\n                      <Calculator className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                      <p>Nenhum item adicionado ainda</p>\n                      <p className=\"text-sm\">Clique em \"Adicionar Item\" para começar</p>\n                    </div>\n                  )}\n                </div>\n                \n                {itensOrcamento.length > 0 && (\n                  <div className=\"mt-4 p-4 bg-gray-50 rounded-lg\">\n                    <div className=\"flex justify-between items-center text-lg font-semibold\">\n                      <span>Total do Orçamento:</span>\n                      <span className=\"text-primary\">{formatarMoeda(calcularTotal())}</span>\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {/* Observações */}\n              <div>\n                <Label htmlFor=\"observacoes\">Observações</Label>\n                <textarea\n                  id=\"observacoes\"\n                  value={formData.observacoes}\n                  onChange={(e) => setFormData(prev => ({ ...prev, observacoes: e.target.value }))}\n                  placeholder=\"Observações adicionais, condições de pagamento, etc.\"\n                  className=\"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n                />\n              </div>\n\n              <div className=\"flex gap-4\">\n                <Button onClick={handleSaveOrcamento} variant=\"doce\">\n                  <Save className=\"h-4 w-4 mr-2\" />\n                  {editingOrcamento ? 'Atualizar Orçamento' : 'Criar Orçamento'}\n                </Button>\n                <Button \n                  onClick={() => {\n                    setShowForm(false)\n                    setEditingOrcamento(null)\n                    setFormData({\n                      cliente_nome: '',\n                      cliente_contato: '',\n                      observacoes: '',\n                      valido_ate: ''\n                    })\n                    setItensOrcamento([])\n                  }}\n                  variant=\"outline\"\n                >\n                  Cancelar\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Lista de Orçamentos */}\n        <div className=\"space-y-4\">\n          {orcamentosFiltrados.length === 0 ? (\n            <Card>\n              <CardContent className=\"py-12 text-center\">\n                <FileText className=\"h-12 w-12 mx-auto text-gray-300 mb-4\" />\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\n                  {searchTerm || filterStatus ? 'Nenhum orçamento encontrado' : 'Nenhum orçamento criado ainda'}\n                </h3>\n                <p className=\"text-gray-500 mb-6\">\n                  {searchTerm || filterStatus \n                    ? 'Tente ajustar os filtros de busca'\n                    : 'Crie seu primeiro orçamento para começar a gerenciar propostas para clientes'\n                  }\n                </p>\n                {!searchTerm && !filterStatus && (\n                  <Button onClick={() => setShowForm(true)} variant=\"doce\">\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    Criar Primeiro Orçamento\n                  </Button>\n                )}\n              </CardContent>\n            </Card>\n          ) : (\n            orcamentosFiltrados.map(orcamento => (\n              <Card key={orcamento.id} className=\"hover:shadow-lg transition-shadow\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center space-x-4 mb-2\">\n                        <h3 className=\"text-lg font-semibold text-gray-900\">\n                          {orcamento.cliente_nome}\n                        </h3>\n                        {getStatusBadge(orcamento.status)}\n                      </div>\n                      \n                      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm text-gray-600 mb-4\">\n                        <div className=\"flex items-center\">\n                          <DollarSign className=\"h-4 w-4 mr-1\" />\n                          <span className=\"font-medium\">{formatarMoeda(orcamento.valor_total)}</span>\n                        </div>\n                        <div className=\"flex items-center\">\n                          <FileText className=\"h-4 w-4 mr-1\" />\n                          <span>{orcamento.itens.length} {orcamento.itens.length === 1 ? 'item' : 'itens'}</span>\n                        </div>\n                        <div className=\"flex items-center\">\n                          <Calendar className=\"h-4 w-4 mr-1\" />\n                          <span>Criado em {formatDate(orcamento.created_at)}</span>\n                        </div>\n                        {orcamento.valido_ate && (\n                          <div className=\"flex items-center\">\n                            <Clock className=\"h-4 w-4 mr-1\" />\n                            <span>Válido até {formatDate(orcamento.valido_ate)}</span>\n                          </div>\n                        )}\n                      </div>\n\n                      {orcamento.cliente_contato && (\n                        <p className=\"text-sm text-gray-600 mb-2\">\n                          <strong>Contato:</strong> {orcamento.cliente_contato}\n                        </p>\n                      )}\n                    </div>\n\n                    <div className=\"flex items-center space-x-2\">\n                      <Button\n                        onClick={() => setShowDetails(orcamento)}\n                        size=\"sm\"\n                        variant=\"outline\"\n                      >\n                        <Eye className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        onClick={() => gerarPdfOrcamento(orcamento)}\n                        size=\"sm\"\n                        variant=\"outline\"\n                        className=\"text-primary hover:bg-primary/10\"\n                        title=\"Exportar PDF\"\n                      >\n                        <Download className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        onClick={() => handleEditOrcamento(orcamento)}\n                        size=\"sm\"\n                        variant=\"outline\"\n                      >\n                        <Edit className=\"h-4 w-4\" />\n                      </Button>\n                      \n                      {/* Status Actions */}\n                      {orcamento.status === 'pendente' && (\n                        <>\n                          <Button\n                            onClick={() => handleUpdateStatus(orcamento, 'aprovado')}\n                            size=\"sm\"\n                            variant=\"outline\"\n                            className=\"text-green-600 hover:bg-green-50\"\n                          >\n                            <CheckCircle className=\"h-4 w-4\" />\n                          </Button>\n                          <Button\n                            onClick={() => handleUpdateStatus(orcamento, 'rejeitado')}\n                            size=\"sm\"\n                            variant=\"outline\"\n                            className=\"text-red-600 hover:bg-red-50\"\n                          >\n                            <XCircle className=\"h-4 w-4\" />\n                          </Button>\n                        </>\n                      )}\n                      \n                      {orcamento.status === 'aprovado' && (\n                        <Button\n                          onClick={() => handleUpdateStatus(orcamento, 'concluido')}\n                          size=\"sm\"\n                          variant=\"outline\"\n                          className=\"text-blue-600 hover:bg-blue-50\"\n                        >\n                          <CheckCircle className=\"h-4 w-4\" />\n                        </Button>\n                      )}\n                      \n                      <Button\n                        onClick={() => handleDeleteOrcamento(orcamento)}\n                        size=\"sm\"\n                        variant=\"outline\"\n                        className=\"text-red-600 hover:bg-red-50\"\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            ))\n          )}\n        </div>\n\n        {/* Modal de Detalhes */}\n        {showDetails && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n            <Card className=\"max-w-4xl w-full max-h-[90vh] overflow-y-auto\">\n              <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <CardTitle className=\"flex items-center space-x-2\">\n                      <FileText className=\"h-5 w-5\" />\n                      <span>Detalhes do Orçamento</span>\n                    </CardTitle>\n                    <CardDescription>\n                      Orçamento para {showDetails.cliente_nome}\n                    </CardDescription>\n                  </div>\n                  <Button \n                    variant=\"ghost\" \n                    size=\"sm\"\n                    onClick={() => setShowDetails(null)}\n                  >\n                    <X className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                {/* Informações do Cliente */}\n                <div>\n                  <h3 className=\"font-semibold mb-3\">Informações do Cliente</h3>\n                  <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                    <div>\n                      <span className=\"text-gray-600\">Nome:</span>\n                      <p className=\"font-medium\">{showDetails.cliente_nome}</p>\n                    </div>\n                    {showDetails.cliente_contato && (\n                      <div>\n                        <span className=\"text-gray-600\">Contato:</span>\n                        <p className=\"font-medium\">{showDetails.cliente_contato}</p>\n                      </div>\n                    )}\n                    <div>\n                      <span className=\"text-gray-600\">Status:</span>\n                      <div className=\"mt-1\">{getStatusBadge(showDetails.status)}</div>\n                    </div>\n                    {showDetails.valido_ate && (\n                      <div>\n                        <span className=\"text-gray-600\">Válido até:</span>\n                        <p className=\"font-medium\">{formatDate(showDetails.valido_ate)}</p>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* Itens */}\n                <div>\n                  <h3 className=\"font-semibold mb-3\">Itens do Orçamento</h3>\n                  <div className=\"space-y-3\">\n                    {showDetails.itens.map((item, index) => (\n                      <div key={index} className=\"grid grid-cols-4 gap-4 p-3 bg-gray-50 rounded-lg text-sm\">\n                        <div>\n                          <span className=\"text-gray-600\">Receita:</span>\n                          <p className=\"font-medium\">{item.nome_receita}</p>\n                        </div>\n                        <div>\n                          <span className=\"text-gray-600\">Quantidade:</span>\n                          <p className=\"font-medium\">{item.quantidade}</p>\n                        </div>\n                        <div>\n                          <span className=\"text-gray-600\">Preço Unit.:</span>\n                          <p className=\"font-medium\">{formatarMoeda(item.preco_unitario)}</p>\n                        </div>\n                        <div>\n                          <span className=\"text-gray-600\">Subtotal:</span>\n                          <p className=\"font-medium\">{formatarMoeda(item.subtotal)}</p>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                  \n                  <div className=\"mt-4 p-4 bg-primary/10 rounded-lg\">\n                    <div className=\"flex justify-between items-center text-lg font-semibold\">\n                      <span>Total do Orçamento:</span>\n                      <span className=\"text-primary\">{formatarMoeda(showDetails.valor_total)}</span>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Observações */}\n                {showDetails.observacoes && (\n                  <div>\n                    <h3 className=\"font-semibold mb-3\">Observações</h3>\n                    <p className=\"text-sm text-gray-600 bg-gray-50 p-3 rounded-lg\">\n                      {showDetails.observacoes}\n                    </p>\n                  </div>\n                )}\n\n                <div className=\"flex gap-4\">\n                  <Button variant=\"doce\" className=\"flex-1\">\n                    <Download className=\"h-4 w-4 mr-2\" />\n                    Exportar PDF\n                  </Button>\n                  <Button variant=\"outline\" className=\"flex-1\">\n                    <Send className=\"h-4 w-4 mr-2\" />\n                    Enviar por Email\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}","size_bytes":40928},"app/dashboard/receitas/page.tsx":{"content":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useAuth } from '@/components/auth/auth-provider'\nimport { useSearchParams } from 'next/navigation'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { \n  Plus, \n  Search, \n  Filter,\n  Clock,\n  Users,\n  Edit,\n  Trash2,\n  Eye,\n  ChefHat,\n  TrendingUp,\n  AlertCircle,\n  CheckCircle,\n  Star,\n  DollarSign,\n  Calculator,\n  Copy,\n  Minus,\n  Package,\n  ShoppingCart\n} from 'lucide-react'\nimport { useToast } from '@/hooks/use-toast'\nimport { supabase, getUserProfile } from '@/lib/supabase-client'\nimport { formatarMoeda, formatarQuantidade, calcularPrecoReceita } from '@/lib/calculations-lib'\nimport { ReceitaCompleta, Ingrediente, ReceitaIngrediente } from '@/lib/database-types'\nimport Link from 'next/link'\n\ntype IngredienteReceita = {\n  id?: string\n  ingrediente_id: string\n  quantidade: number\n  ingrediente: Ingrediente\n}\n\ntype ReceitaListItem = {\n  id: string\n  nome: string\n  descricao: string | null\n  tempo_producao: number\n  complexidade: 'simples' | 'media' | 'complexa'\n  rendimento: number\n  categoria: string\n  ativa: boolean\n  custo_calculado: number | null\n  preco_sugerido: number | null\n  created_at: string\n  updated_at: string\n}\n\nexport default function ReceitasPage() {\n  const { profile } = useAuth()\n  const { toast } = useToast()\n  const searchParams = useSearchParams()\n  \n  // Estados\n  const [receitas, setReceitas] = useState<ReceitaListItem[]>([])\n  const [loading, setLoading] = useState(true)\n  const [searchTerm, setSearchTerm] = useState('')\n  const [filterCategoria, setFilterCategoria] = useState('')\n  const [filterComplexidade, setFilterComplexidade] = useState('')\n  const [showForm, setShowForm] = useState(false)\n  const [editingReceita, setEditingReceita] = useState<ReceitaListItem | null>(null)\n  \n  // Estados para ingredientes\n  const [ingredientesDisponiveis, setIngredientesDisponiveis] = useState<Ingrediente[]>([])\n  const [ingredientesReceita, setIngredientesReceita] = useState<IngredienteReceita[]>([])\n  const [loadingIngredientes, setLoadingIngredientes] = useState(false)\n  const [showIngredientSelector, setShowIngredientSelector] = useState(false)\n  \n  // Estados para vista detalhada\n  const [receitaDetalhada, setReceitaDetalhada] = useState<ReceitaListItem | null>(null)\n  const [ingredientesDetalhada, setIngredientesDetalhada] = useState<IngredienteReceita[]>([])\n  const [custoCalculadoDetalhado, setCustoCalculadoDetalhado] = useState<number | null>(null)\n  const [showDetalheModal, setShowDetalheModal] = useState(false)\n\n  // Formulário\n  const [formData, setFormData] = useState({\n    nome: '',\n    descricao: '',\n    tempo_producao: 60,\n    complexidade: 'simples' as 'simples' | 'media' | 'complexa',\n    rendimento: 1,\n    categoria: 'doces',\n    ativa: true\n  })\n\n  const isPro = profile?.plano === 'pro'\n  const action = searchParams.get('action')\n\n  useEffect(() => {\n    if (action === 'new') {\n      setShowForm(true)\n    }\n  }, [action])\n\n  useEffect(() => {\n    if (profile?.id) {\n      loadReceitas()\n      loadIngredientesDisponiveis()\n    }\n  }, [profile?.id])\n\n  const loadIngredientesDisponiveis = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('ingredientes')\n        .select('*')\n        .eq('ativo', true)\n        .order('nome')\n\n      if (error) throw error\n      setIngredientesDisponiveis(data || [])\n    } catch (error) {\n      console.error('Erro ao carregar ingredientes:', error)\n    }\n  }\n\n  const loadIngredientesReceita = async (receitaId: string) => {\n    try {\n      setLoadingIngredientes(true)\n      const { data, error } = await supabase\n        .from('receita_ingredientes')\n        .select(`\n          *,\n          ingredientes (*)\n        `)\n        .eq('receita_id', receitaId)\n\n      if (error) throw error\n      \n      const ingredientesFormatados = (data || []).map(item => ({\n        id: item.id,\n        ingrediente_id: item.ingrediente_id,\n        quantidade: item.quantidade,\n        ingrediente: item.ingredientes\n      }))\n      \n      setIngredientesReceita(ingredientesFormatados)\n    } catch (error) {\n      console.error('Erro ao carregar ingredientes da receita:', error)\n      toast({\n        title: \"Erro ao carregar ingredientes\",\n        description: \"Não foi possível carregar os ingredientes da receita.\",\n        variant: \"destructive\",\n      })\n    } finally {\n      setLoadingIngredientes(false)\n    }\n  }\n\n  const adicionarIngredienteReceita = (ingredienteId: string) => {\n    const ingrediente = ingredientesDisponiveis.find(i => i.id === ingredienteId)\n    if (!ingrediente) return\n\n    // Verificar se já existe\n    if (ingredientesReceita.some(ir => ir.ingrediente_id === ingredienteId)) {\n      toast({\n        title: \"Ingrediente já adicionado\",\n        description: \"Este ingrediente já está na receita.\",\n        variant: \"destructive\",\n      })\n      return\n    }\n\n    const novoIngrediente: IngredienteReceita = {\n      ingrediente_id: ingredienteId,\n      quantidade: 100, // valor padrão\n      ingrediente\n    }\n\n    setIngredientesReceita([...ingredientesReceita, novoIngrediente])\n    setShowIngredientSelector(false)\n  }\n\n  const atualizarQuantidadeIngrediente = (ingredienteId: string, novaQuantidade: number) => {\n    setIngredientesReceita(prev => \n      prev.map(ir => \n        ir.ingrediente_id === ingredienteId \n          ? { ...ir, quantidade: novaQuantidade }\n          : ir\n      )\n    )\n  }\n\n  const removerIngredienteReceita = (ingredienteId: string) => {\n    setIngredientesReceita(prev => \n      prev.filter(ir => ir.ingrediente_id !== ingredienteId)\n    )\n  }\n\n  const salvarIngredientesReceita = async (receitaId: string) => {\n    try {\n      // Primeiro, remover ingredientes existentes\n      await supabase\n        .from('receita_ingredientes')\n        .delete()\n        .eq('receita_id', receitaId)\n\n      // Depois, inserir os novos ingredientes\n      if (ingredientesReceita.length > 0) {\n        const ingredientesParaInserir = ingredientesReceita.map(ir => ({\n          receita_id: receitaId,\n          ingrediente_id: ir.ingrediente_id,\n          quantidade: ir.quantidade\n        }))\n\n        const { error } = await supabase\n          .from('receita_ingredientes')\n          .insert(ingredientesParaInserir)\n\n        if (error) throw error\n      }\n    } catch (error) {\n      console.error('Erro ao salvar ingredientes:', error)\n      throw error\n    }\n  }\n\n  const carregarDetalhesReceita = async (receita: ReceitaListItem) => {\n    try {\n      setReceitaDetalhada(receita)\n      setShowDetalheModal(true)\n      \n      // Carregar ingredientes da receita\n      const { data, error } = await supabase\n        .from('receita_ingredientes')\n        .select(`\n          *,\n          ingredientes (*)\n        `)\n        .eq('receita_id', receita.id)\n\n      if (error) throw error\n      \n      const ingredientesFormatados = (data || []).map(item => ({\n        id: item.id,\n        ingrediente_id: item.ingrediente_id,\n        quantidade: item.quantidade,\n        ingrediente: item.ingredientes\n      }))\n      \n      setIngredientesDetalhada(ingredientesFormatados)\n      \n      // Calcular custo se há ingredientes\n      if (ingredientesFormatados.length > 0) {\n        calcularCustoReceita(receita, ingredientesFormatados)\n      } else {\n        setCustoCalculadoDetalhado(null)\n      }\n      \n    } catch (error) {\n      console.error('Erro ao carregar detalhes da receita:', error)\n      toast({\n        title: \"Erro ao carregar detalhes\",\n        description: \"Não foi possível carregar os detalhes da receita.\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const calcularCustoReceita = (receita: ReceitaListItem, ingredientes: IngredienteReceita[]) => {\n    try {\n      // Criar uma receita completa simulada para o cálculo\n      const receitaCompleta: ReceitaCompleta = {\n        ...receita,\n        user_id: profile?.id || '',\n        imagem_url: '',\n        tempo_preparo: receita.tempo_producao,\n        receita_ingredientes: ingredientes.map(ir => ({\n          id: ir.id || '',\n          receita_id: receita.id,\n          ingrediente_id: ir.ingrediente_id,\n          quantidade: ir.quantidade,\n          created_at: '',\n          ingredientes: {\n            ...ir.ingrediente,\n            preco_por_unidade: ir.ingrediente.preco_kg,\n            user_id: profile?.id || ''\n          }\n        }))\n      }\n\n      const resultado = calcularPrecoReceita(\n        receitaCompleta,\n        profile?.valor_hora || 25,\n        profile?.margem_padrao || 0.6,\n        1,\n        false\n      )\n\n      setCustoCalculadoDetalhado(resultado.custoTotal)\n    } catch (error) {\n      console.error('Erro ao calcular custo:', error)\n      setCustoCalculadoDetalhado(null)\n    }\n  }\n\n  const loadReceitas = async () => {\n    if (!profile?.id) return\n\n    try {\n      const { data, error } = await supabase\n        .from('receitas')\n        .select('*')\n        .eq('user_id', profile.id)\n        .order('updated_at', { ascending: false })\n\n      if (error) throw error\n\n      setReceitas(data || [])\n    } catch (error) {\n      console.error('Erro ao carregar receitas:', error)\n      toast({\n        title: \"Erro ao carregar receitas\",\n        description: \"Não foi possível carregar suas receitas.\",\n        variant: \"destructive\",\n      })\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleSaveReceita = async () => {\n    if (!profile?.id) return\n\n    if (!formData.nome.trim()) {\n      toast({\n        title: \"Campo obrigatório\",\n        description: \"O nome da receita é obrigatório.\",\n        variant: \"destructive\",\n      })\n      return\n    }\n\n    // Verificar limite do plano gratuito\n    if (!isPro && !editingReceita && receitas.length >= 3) {\n      toast({\n        title: \"Limite do Plano Gratuito\",\n        description: \"Upgrade para PRO para criar receitas ilimitadas.\",\n        variant: \"destructive\",\n      })\n      return\n    }\n\n    try {\n      const receitaData = {\n        ...formData,\n        user_id: profile.id,\n        updated_at: new Date().toISOString()\n      }\n\n      let result\n      if (editingReceita) {\n        result = await supabase\n          .from('receitas')\n          .update(receitaData)\n          .eq('id', editingReceita.id)\n          .select()\n          .single()\n      } else {\n        result = await supabase\n          .from('receitas')\n          .insert(receitaData)\n          .select()\n          .single()\n      }\n\n      if (result.error) throw result.error\n\n      // Salvar ingredientes da receita\n      await salvarIngredientesReceita(result.data.id)\n\n      toast({\n        title: editingReceita ? \"Receita atualizada!\" : \"Receita criada! 🎂\",\n        description: `${formData.nome} foi ${editingReceita ? 'atualizada' : 'criada'} com sucesso.`,\n      })\n\n      // Resetar formulário\n      setFormData({\n        nome: '',\n        descricao: '',\n        tempo_producao: 60,\n        complexidade: 'simples',\n        rendimento: 1,\n        categoria: 'doces',\n        ativa: true\n      })\n      setIngredientesReceita([])\n      setShowForm(false)\n      setEditingReceita(null)\n      \n      // Recarregar receitas\n      loadReceitas()\n\n    } catch (error) {\n      console.error('Erro ao salvar receita:', error)\n      toast({\n        title: \"Erro ao salvar receita\",\n        description: \"Não foi possível salvar a receita.\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleEditReceita = (receita: ReceitaListItem) => {\n    setFormData({\n      nome: receita.nome,\n      descricao: receita.descricao || '',\n      tempo_producao: receita.tempo_producao,\n      complexidade: receita.complexidade,\n      rendimento: receita.rendimento,\n      categoria: receita.categoria,\n      ativa: receita.ativa\n    })\n    setEditingReceita(receita)\n    setShowForm(true)\n    // Carregar ingredientes da receita\n    loadIngredientesReceita(receita.id)\n  }\n\n  const handleDeleteReceita = async (receita: ReceitaListItem) => {\n    if (!confirm(`Tem certeza que deseja excluir \"${receita.nome}\"?`)) return\n\n    try {\n      const { error } = await supabase\n        .from('receitas')\n        .delete()\n        .eq('id', receita.id)\n\n      if (error) throw error\n\n      toast({\n        title: \"Receita excluída\",\n        description: `${receita.nome} foi excluída com sucesso.`,\n      })\n\n      loadReceitas()\n    } catch (error) {\n      console.error('Erro ao excluir receita:', error)\n      toast({\n        title: \"Erro ao excluir receita\",\n        description: \"Não foi possível excluir a receita.\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleDuplicateReceita = async (receita: ReceitaListItem) => {\n    if (!isPro && receitas.length >= 3) {\n      toast({\n        title: \"Limite do Plano Gratuito\",\n        description: \"Upgrade para PRO para duplicar receitas.\",\n        variant: \"destructive\",\n      })\n      return\n    }\n\n    try {\n      const { error } = await supabase\n        .from('receitas')\n        .insert({\n          nome: `${receita.nome} (Cópia)`,\n          descricao: receita.descricao,\n          tempo_producao: receita.tempo_producao,\n          complexidade: receita.complexidade,\n          rendimento: receita.rendimento,\n          categoria: receita.categoria,\n          ativa: true,\n          user_id: profile?.id\n        })\n\n      if (error) throw error\n\n      toast({\n        title: \"Receita duplicada! 🍰\",\n        description: `Cópia de ${receita.nome} criada com sucesso.`,\n      })\n\n      loadReceitas()\n    } catch (error) {\n      console.error('Erro ao duplicar receita:', error)\n      toast({\n        title: \"Erro ao duplicar receita\",\n        description: \"Não foi possível duplicar a receita.\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  // Filtrar receitas\n  const receitasFiltradas = receitas.filter(receita => {\n    const matchesSearch = receita.nome.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         (receita.descricao && receita.descricao.toLowerCase().includes(searchTerm.toLowerCase()))\n    const matchesCategoria = !filterCategoria || receita.categoria === filterCategoria\n    const matchesComplexidade = !filterComplexidade || receita.complexidade === filterComplexidade\n    \n    return matchesSearch && matchesCategoria && matchesComplexidade\n  })\n\n  const getComplexidadeColor = (complexidade: string) => {\n    switch (complexidade) {\n      case 'simples': return 'bg-green-100 text-green-800'\n      case 'media': return 'bg-yellow-100 text-yellow-800'\n      case 'complexa': return 'bg-red-100 text-red-800'\n      default: return 'bg-gray-100 text-gray-800'\n    }\n  }\n\n  const getComplexidadeLabel = (complexidade: string) => {\n    switch (complexidade) {\n      case 'simples': return 'Simples'\n      case 'media': return 'Média'\n      case 'complexa': return 'Complexa'\n      default: return complexidade\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-soft flex items-center justify-center\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" />\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-soft py-8 px-4\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"text-center mb-8\">\n          <div className=\"flex items-center justify-center space-x-2 mb-4\">\n            <ChefHat className=\"h-8 w-8 text-primary\" />\n            <h1 className=\"text-3xl font-display font-bold text-gray-900\">\n              Minhas Receitas\n            </h1>\n          </div>\n          <p className=\"text-gray-600 max-w-2xl mx-auto\">\n            Organize suas receitas, calcule custos e gerencie seu catálogo de produtos\n          </p>\n          \n          {!isPro && (\n            <div className=\"mt-4\">\n              <Badge variant=\"outline\" className=\"bg-yellow-50 text-yellow-800 border-yellow-200\">\n                <Star className=\"h-3 w-3 mr-1\" />\n                Plano Gratuito - Máximo 3 receitas\n              </Badge>\n            </div>\n          )}\n        </div>\n\n        {/* Ações Principais */}\n        <div className=\"flex flex-col sm:flex-row gap-4 mb-8\">\n          <Button \n            onClick={() => setShowForm(true)}\n            variant=\"doce\" \n            size=\"lg\"\n            disabled={!isPro && receitas.length >= 3}\n          >\n            <Plus className=\"h-5 w-5 mr-2\" />\n            Nova Receita\n          </Button>\n          \n          {!isPro && receitas.length >= 3 && (\n            <Link href=\"/dashboard/upgrade\">\n              <Button variant=\"outline\" size=\"lg\">\n                <TrendingUp className=\"h-5 w-5 mr-2\" />\n                Upgrade para PRO\n              </Button>\n            </Link>\n          )}\n        </div>\n\n        {showForm ? (\n          /* Formulário de Receita */\n          <Card className=\"mb-8\">\n            <CardHeader>\n              <CardTitle>\n                {editingReceita ? 'Editar Receita' : 'Nova Receita'}\n              </CardTitle>\n              <CardDescription>\n                {editingReceita ? 'Atualize os dados da receita' : 'Crie uma nova receita para seu catálogo'}\n              </CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <Label htmlFor=\"nome\">Nome da Receita</Label>\n                  <Input\n                    id=\"nome\"\n                    value={formData.nome}\n                    onChange={(e) => setFormData(prev => ({ ...prev, nome: e.target.value }))}\n                    placeholder=\"Ex: Brigadeiro Gourmet\"\n                  />\n                </div>\n                <div>\n                  <Label htmlFor=\"categoria\">Categoria</Label>\n                  <select\n                    id=\"categoria\"\n                    value={formData.categoria}\n                    onChange={(e) => setFormData(prev => ({ ...prev, categoria: e.target.value }))}\n                    className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n                  >\n                    <option value=\"doces\">Doces</option>\n                    <option value=\"bolos\">Bolos</option>\n                    <option value=\"tortas\">Tortas</option>\n                    <option value=\"salgados\">Salgados</option>\n                    <option value=\"bebidas\">Bebidas</option>\n                    <option value=\"outros\">Outros</option>\n                  </select>\n                </div>\n                <div>\n                  <Label htmlFor=\"complexidade\">Complexidade</Label>\n                  <select\n                    id=\"complexidade\"\n                    value={formData.complexidade}\n                    onChange={(e) => setFormData(prev => ({ ...prev, complexidade: e.target.value as any }))}\n                    className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n                  >\n                    <option value=\"simples\">Simples</option>\n                    <option value=\"media\">Média</option>\n                    <option value=\"complexa\">Complexa</option>\n                  </select>\n                </div>\n                <div>\n                  <Label htmlFor=\"tempo\">Tempo de Produção (min)</Label>\n                  <Input\n                    id=\"tempo\"\n                    type=\"number\"\n                    value={formData.tempo_producao}\n                    onChange={(e) => setFormData(prev => ({ ...prev, tempo_producao: Number(e.target.value) }))}\n                    min=\"1\"\n                  />\n                </div>\n                <div>\n                  <Label htmlFor=\"rendimento\">Rendimento (unidades)</Label>\n                  <Input\n                    id=\"rendimento\"\n                    type=\"number\"\n                    value={formData.rendimento}\n                    onChange={(e) => setFormData(prev => ({ ...prev, rendimento: Number(e.target.value) }))}\n                    min=\"1\"\n                  />\n                </div>\n              </div>\n              \n              <div>\n                <Label htmlFor=\"descricao\">Descrição (Opcional)</Label>\n                <textarea\n                  id=\"descricao\"\n                  value={formData.descricao}\n                  onChange={(e) => setFormData(prev => ({ ...prev, descricao: e.target.value }))}\n                  placeholder=\"Descreva sua receita, ingredientes especiais, dicas...\"\n                  className=\"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\"\n                  rows={3}\n                />\n              </div>\n\n              {/* Gestão de Ingredientes */}\n              <div className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <Label className=\"text-base font-medium\">Ingredientes da Receita</Label>\n                  <Button \n                    type=\"button\"\n                    onClick={() => setShowIngredientSelector(true)}\n                    variant=\"outline\" \n                    size=\"sm\"\n                  >\n                    <Plus className=\"h-4 w-4 mr-1\" />\n                    Adicionar Ingrediente\n                  </Button>\n                </div>\n\n                {ingredientesReceita.length === 0 ? (\n                  <div className=\"border-2 border-dashed border-gray-200 rounded-lg p-6 text-center\">\n                    <Package className=\"h-8 w-8 text-gray-400 mx-auto mb-2\" />\n                    <p className=\"text-sm text-gray-500\">\n                      Nenhum ingrediente adicionado ainda. Clique em \"Adicionar Ingrediente\" para começar.\n                    </p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {ingredientesReceita.map((ingredienteReceita) => (\n                      <div \n                        key={ingredienteReceita.ingrediente_id} \n                        className=\"flex items-center gap-3 p-3 border rounded-lg\"\n                      >\n                        <div className=\"flex-1\">\n                          <p className=\"font-medium\">{ingredienteReceita.ingrediente.nome}</p>\n                          <p className=\"text-sm text-gray-500\">\n                            {formatarMoeda(ingredienteReceita.ingrediente.preco_kg)}/kg · {ingredienteReceita.ingrediente.unidade}\n                          </p>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                          <Input\n                            type=\"number\"\n                            value={ingredienteReceita.quantidade}\n                            onChange={(e) => atualizarQuantidadeIngrediente(\n                              ingredienteReceita.ingrediente_id, \n                              Number(e.target.value)\n                            )}\n                            min=\"0\"\n                            step=\"0.1\"\n                            className=\"w-20 h-8 text-sm\"\n                          />\n                          <span className=\"text-sm text-gray-500 min-w-8\">\n                            {ingredienteReceita.ingrediente.unidade}\n                          </span>\n                          <Button\n                            type=\"button\"\n                            onClick={() => removerIngredienteReceita(ingredienteReceita.ingrediente_id)}\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            className=\"text-red-600 hover:text-red-700\"\n                          >\n                            <Trash2 className=\"h-4 w-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n\n                {/* Modal de seleção de ingredientes */}\n                {showIngredientSelector && (\n                  <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n                    <div className=\"bg-white rounded-lg max-w-md w-full m-4 max-h-96\">\n                      <div className=\"p-4 border-b\">\n                        <div className=\"flex items-center justify-between\">\n                          <h3 className=\"font-medium\">Selecionar Ingrediente</h3>\n                          <Button\n                            type=\"button\"\n                            onClick={() => setShowIngredientSelector(false)}\n                            variant=\"ghost\"\n                            size=\"sm\"\n                          >\n                            <Minus className=\"h-4 w-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                      <div className=\"p-4 max-h-64 overflow-y-auto\">\n                        {ingredientesDisponiveis.length === 0 ? (\n                          <p className=\"text-sm text-gray-500 text-center py-4\">\n                            Nenhum ingrediente disponível\n                          </p>\n                        ) : (\n                          <div className=\"space-y-2\">\n                            {ingredientesDisponiveis\n                              .filter(ing => !ingredientesReceita.some(ir => ir.ingrediente_id === ing.id))\n                              .map((ingrediente) => (\n                                <button\n                                  key={ingrediente.id}\n                                  type=\"button\"\n                                  onClick={() => adicionarIngredienteReceita(ingrediente.id)}\n                                  className=\"w-full text-left p-2 rounded hover:bg-gray-50 border\"\n                                >\n                                  <div className=\"font-medium\">{ingrediente.nome}</div>\n                                  <div className=\"text-sm text-gray-500\">\n                                    {formatarMoeda(ingrediente.preco_kg)}/kg · {ingrediente.unidade}\n                                  </div>\n                                </button>\n                              ))}\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"flex items-center space-x-2\">\n                <input\n                  type=\"checkbox\"\n                  id=\"ativa\"\n                  checked={formData.ativa}\n                  onChange={(e) => setFormData(prev => ({ ...prev, ativa: e.target.checked }))}\n                  className=\"rounded\"\n                />\n                <Label htmlFor=\"ativa\" className=\"text-sm\">\n                  Receita ativa (visível no catálogo)\n                </Label>\n              </div>\n\n              <div className=\"flex gap-4\">\n                <Button onClick={handleSaveReceita} variant=\"doce\">\n                  {editingReceita ? 'Atualizar Receita' : 'Criar Receita'}\n                </Button>\n                <Button \n                  onClick={() => {\n                    setShowForm(false)\n                    setEditingReceita(null)\n                    setIngredientesReceita([])\n                    setFormData({\n                      nome: '',\n                      descricao: '',\n                      tempo_producao: 60,\n                      complexidade: 'simples',\n                      rendimento: 1,\n                      categoria: 'doces',\n                      ativa: true\n                    })\n                  }}\n                  variant=\"outline\"\n                >\n                  Cancelar\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        ) : (\n          <>\n            {/* Filtros e Pesquisa */}\n            <Card className=\"mb-8\">\n              <CardContent className=\"pt-6\">\n                <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n                  <div className=\"md:col-span-2\">\n                    <div className=\"relative\">\n                      <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4\" />\n                      <Input\n                        placeholder=\"Pesquisar receitas...\"\n                        value={searchTerm}\n                        onChange={(e) => setSearchTerm(e.target.value)}\n                        className=\"pl-10\"\n                      />\n                    </div>\n                  </div>\n                  <div>\n                    <select\n                      value={filterCategoria}\n                      onChange={(e) => setFilterCategoria(e.target.value)}\n                      className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n                    >\n                      <option value=\"\">Todas categorias</option>\n                      <option value=\"doces\">Doces</option>\n                      <option value=\"bolos\">Bolos</option>\n                      <option value=\"tortas\">Tortas</option>\n                      <option value=\"salgados\">Salgados</option>\n                      <option value=\"bebidas\">Bebidas</option>\n                      <option value=\"outros\">Outros</option>\n                    </select>\n                  </div>\n                  <div>\n                    <select\n                      value={filterComplexidade}\n                      onChange={(e) => setFilterComplexidade(e.target.value)}\n                      className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n                    >\n                      <option value=\"\">Todas complexidades</option>\n                      <option value=\"simples\">Simples</option>\n                      <option value=\"media\">Média</option>\n                      <option value=\"complexa\">Complexa</option>\n                    </select>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Lista de Receitas */}\n            {receitas.length === 0 ? (\n              <Card>\n                <CardContent className=\"text-center py-12\">\n                  <ChefHat className=\"h-16 w-16 text-gray-400 mx-auto mb-4\" />\n                  <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">\n                    Nenhuma receita encontrada\n                  </h3>\n                  <p className=\"text-gray-600 mb-6\">\n                    Comece criando sua primeira receita para organizar seus produtos.\n                  </p>\n                  <Button onClick={() => setShowForm(true)} variant=\"doce\">\n                    <Plus className=\"h-5 w-5 mr-2\" />\n                    Criar Primeira Receita\n                  </Button>\n                </CardContent>\n              </Card>\n            ) : receitasFiltradas.length === 0 ? (\n              <Card>\n                <CardContent className=\"text-center py-12\">\n                  <Search className=\"h-16 w-16 text-gray-400 mx-auto mb-4\" />\n                  <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">\n                    Nenhum resultado encontrado\n                  </h3>\n                  <p className=\"text-gray-600\">\n                    Tente ajustar os filtros ou termo de pesquisa.\n                  </p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {receitasFiltradas.map((receita) => (\n                  <Card key={receita.id} className=\"hover:shadow-lg transition-shadow\">\n                    <CardHeader className=\"pb-3\">\n                      <div className=\"flex items-start justify-between\">\n                        <div className=\"flex-1\">\n                          <CardTitle className=\"text-lg mb-1\">{receita.nome}</CardTitle>\n                          <div className=\"flex items-center space-x-2 mb-2\">\n                            <Badge \n                              variant=\"secondary\"\n                              className={getComplexidadeColor(receita.complexidade)}\n                            >\n                              {getComplexidadeLabel(receita.complexidade)}\n                            </Badge>\n                            <Badge variant=\"outline\" className=\"text-xs\">\n                              {receita.categoria}\n                            </Badge>\n                          </div>\n                        </div>\n                        {!receita.ativa && (\n                          <Badge variant=\"outline\" className=\"text-xs text-gray-500\">\n                            Inativa\n                          </Badge>\n                        )}\n                      </div>\n                      \n                      {receita.descricao && (\n                        <CardDescription className=\"text-sm line-clamp-2\">\n                          {receita.descricao}\n                        </CardDescription>\n                      )}\n                    </CardHeader>\n                    \n                    <CardContent className=\"space-y-4\">\n                      <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                        <div className=\"flex items-center space-x-2\">\n                          <Clock className=\"h-4 w-4 text-gray-400\" />\n                          <span>{receita.tempo_producao} min</span>\n                        </div>\n                        <div className=\"flex items-center space-x-2\">\n                          <Users className=\"h-4 w-4 text-gray-400\" />\n                          <span>{receita.rendimento} un</span>\n                        </div>\n                      </div>\n\n                      {receita.custo_calculado && (\n                        <div className=\"bg-green-50 p-3 rounded-lg\">\n                          <div className=\"flex justify-between items-center text-sm\">\n                            <span className=\"text-green-800 font-medium\">Custo calculado:</span>\n                            <span className=\"text-green-900 font-bold\">\n                              {formatarMoeda(receita.custo_calculado)}\n                            </span>\n                          </div>\n                          {receita.preco_sugerido && (\n                            <div className=\"flex justify-between items-center text-sm mt-1\">\n                              <span className=\"text-green-800 font-medium\">Preço sugerido:</span>\n                              <span className=\"text-green-900 font-bold\">\n                                {formatarMoeda(receita.preco_sugerido)}\n                              </span>\n                            </div>\n                          )}\n                        </div>\n                      )}\n\n                      <div className=\"flex flex-wrap gap-2\">\n                        <Button \n                          size=\"sm\" \n                          variant=\"doce\"\n                          onClick={() => carregarDetalhesReceita(receita)}\n                        >\n                          <Eye className=\"h-4 w-4 mr-1\" />\n                          Ver Detalhes\n                        </Button>\n                        <Link href={`/dashboard/calculadora?receita=${receita.id}`}>\n                          <Button size=\"sm\" variant=\"outline\">\n                            <Calculator className=\"h-4 w-4 mr-1\" />\n                            Calcular\n                          </Button>\n                        </Link>\n                        <Button \n                          size=\"sm\" \n                          variant=\"outline\"\n                          onClick={() => handleEditReceita(receita)}\n                        >\n                          <Edit className=\"h-4 w-4 mr-1\" />\n                          Editar\n                        </Button>\n                        <Button \n                          size=\"sm\" \n                          variant=\"outline\"\n                          onClick={() => handleDuplicateReceita(receita)}\n                          disabled={!isPro && receitas.length >= 3}\n                        >\n                          <Copy className=\"h-4 w-4 mr-1\" />\n                          Duplicar\n                        </Button>\n                        <Button \n                          size=\"sm\" \n                          variant=\"outline\"\n                          onClick={() => handleDeleteReceita(receita)}\n                          className=\"text-red-600 hover:text-red-700\"\n                        >\n                          <Trash2 className=\"h-4 w-4 mr-1\" />\n                          Excluir\n                        </Button>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            )}\n          </>\n        )}\n        \n        {/* Modal de Vista Detalhada */}\n        {showDetalheModal && receitaDetalhada && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n            <div className=\"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto\">\n              <div className=\"p-6 border-b\">\n                <div className=\"flex items-center justify-between\">\n                  <h2 className=\"text-2xl font-bold\">{receitaDetalhada.nome}</h2>\n                  <Button\n                    onClick={() => {\n                      setShowDetalheModal(false)\n                      setReceitaDetalhada(null)\n                      setIngredientesDetalhada([])\n                      setCustoCalculadoDetalhado(null)\n                    }}\n                    variant=\"ghost\"\n                    size=\"sm\"\n                  >\n                    <Minus className=\"h-5 w-5\" />\n                  </Button>\n                </div>\n              </div>\n              \n              <div className=\"p-6 space-y-6\">\n                {/* Informações básicas */}\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  <div>\n                    <h3 className=\"font-semibold mb-3\">Informações Gerais</h3>\n                    <div className=\"space-y-2 text-sm\">\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-600\">Categoria:</span>\n                        <span className=\"font-medium\">{receitaDetalhada.categoria}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-600\">Complexidade:</span>\n                        <Badge className={getComplexidadeColor(receitaDetalhada.complexidade)}>\n                          {getComplexidadeLabel(receitaDetalhada.complexidade)}\n                        </Badge>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-600\">Tempo de produção:</span>\n                        <span className=\"font-medium\">{receitaDetalhada.tempo_producao} minutos</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-600\">Rendimento:</span>\n                        <span className=\"font-medium\">{receitaDetalhada.rendimento} unidades</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-600\">Status:</span>\n                        <Badge variant={receitaDetalhada.ativa ? \"default\" : \"outline\"}>\n                          {receitaDetalhada.ativa ? 'Ativa' : 'Inativa'}\n                        </Badge>\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <div>\n                    <h3 className=\"font-semibold mb-3\">Custos e Preços</h3>\n                    <div className=\"space-y-2 text-sm\">\n                      {custoCalculadoDetalhado && (\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-gray-600\">Custo calculado:</span>\n                          <span className=\"font-bold text-green-600\">\n                            {formatarMoeda(custoCalculadoDetalhado)}\n                          </span>\n                        </div>\n                      )}\n                      {receitaDetalhada.custo_calculado && (\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-gray-600\">Custo salvo:</span>\n                          <span className=\"font-medium\">\n                            {formatarMoeda(receitaDetalhada.custo_calculado)}\n                          </span>\n                        </div>\n                      )}\n                      {receitaDetalhada.preco_sugerido && (\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-gray-600\">Preço sugerido:</span>\n                          <span className=\"font-medium\">\n                            {formatarMoeda(receitaDetalhada.preco_sugerido)}\n                          </span>\n                        </div>\n                      )}\n                      {custoCalculadoDetalhado && (\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-gray-600\">Custo por unidade:</span>\n                          <span className=\"font-medium\">\n                            {formatarMoeda(custoCalculadoDetalhado / receitaDetalhada.rendimento)}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n                \n                {/* Descrição */}\n                {receitaDetalhada.descricao && (\n                  <div>\n                    <h3 className=\"font-semibold mb-3\">Descrição</h3>\n                    <p className=\"text-sm text-gray-700 bg-gray-50 p-3 rounded-lg\">\n                      {receitaDetalhada.descricao}\n                    </p>\n                  </div>\n                )}\n                \n                {/* Ingredientes */}\n                <div>\n                  <h3 className=\"font-semibold mb-3 flex items-center\">\n                    <ShoppingCart className=\"h-5 w-5 mr-2\" />\n                    Ingredientes ({ingredientesDetalhada.length})\n                  </h3>\n                  {loadingIngredientes ? (\n                    <div className=\"flex items-center justify-center py-8\">\n                      <div className=\"animate-spin w-6 h-6 border-2 border-primary border-t-transparent rounded-full\" />\n                    </div>\n                  ) : ingredientesDetalhada.length === 0 ? (\n                    <div className=\"text-center py-8 bg-gray-50 rounded-lg\">\n                      <Package className=\"h-12 w-12 text-gray-400 mx-auto mb-2\" />\n                      <p className=\"text-gray-500\">Nenhum ingrediente cadastrado</p>\n                      <p className=\"text-sm text-gray-400\">Edite a receita para adicionar ingredientes</p>\n                    </div>\n                  ) : (\n                    <div className=\"space-y-3\">\n                      {ingredientesDetalhada.map((ingredienteReceita) => {\n                        const custoIngrediente = (ingredienteReceita.quantidade / 1000) * ingredienteReceita.ingrediente.preco_kg\n                        return (\n                          <div \n                            key={ingredienteReceita.ingrediente_id} \n                            className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\"\n                          >\n                            <div className=\"flex-1\">\n                              <div className=\"font-medium\">{ingredienteReceita.ingrediente.nome}</div>\n                              <div className=\"text-sm text-gray-500\">\n                                {formatarQuantidade(ingredienteReceita.quantidade, ingredienteReceita.ingrediente.unidade)} · \n                                {formatarMoeda(ingredienteReceita.ingrediente.preco_kg)}/kg\n                              </div>\n                            </div>\n                            <div className=\"text-right\">\n                              <div className=\"font-medium\">{formatarMoeda(custoIngrediente)}</div>\n                            </div>\n                          </div>\n                        )\n                      })}\n                      \n                      {custoCalculadoDetalhado && (\n                        <div className=\"border-t pt-3 mt-4\">\n                          <div className=\"flex justify-between items-center font-semibold\">\n                            <span>Total dos ingredientes:</span>\n                            <span className=\"text-lg\">\n                              {formatarMoeda(\n                                ingredientesDetalhada.reduce((acc, ir) => \n                                  acc + ((ir.quantidade / 1000) * ir.ingrediente.preco_kg), 0\n                                )\n                              )}\n                            </span>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </div>\n                \n                {/* Ações */}\n                <div className=\"flex gap-3 pt-4 border-t\">\n                  <Link href={`/dashboard/calculadora?receita=${receitaDetalhada.id}`}>\n                    <Button variant=\"doce\">\n                      <Calculator className=\"h-4 w-4 mr-2\" />\n                      Calcular Preços\n                    </Button>\n                  </Link>\n                  <Button \n                    variant=\"outline\"\n                    onClick={() => {\n                      setShowDetalheModal(false)\n                      handleEditReceita(receitaDetalhada)\n                    }}\n                  >\n                    <Edit className=\"h-4 w-4 mr-2\" />\n                    Editar Receita\n                  </Button>\n                  <Button \n                    variant=\"outline\"\n                    onClick={() => handleDuplicateReceita(receitaDetalhada)}\n                    disabled={!isPro && receitas.length >= 3}\n                  >\n                    <Copy className=\"h-4 w-4 mr-2\" />\n                    Duplicar\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}","size_bytes":47395},"app/dashboard/relatorios/page.tsx":{"content":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useAuth } from '@/components/auth/auth-provider'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { \n  BarChart3,\n  PieChart,\n  TrendingUp,\n  TrendingDown,\n  DollarSign,\n  FileText,\n  Calendar,\n  Download,\n  Eye,\n  Calculator,\n  ChefHat,\n  Package,\n  Users,\n  Target,\n  Crown,\n  CheckCircle,\n  Clock,\n  Filter,\n  RefreshCw\n} from 'lucide-react'\nimport { useToast } from '@/hooks/use-toast'\nimport { supabase } from '@/lib/supabase-client'\nimport { formatarMoeda } from '@/lib/calculations-lib'\n\ntype RelatorioFinanceiro = {\n  periodo: string\n  totalReceitas: number\n  totalOrcamentos: number\n  valorMedioOrcamento: number\n  receitasCalculadas: number\n  margemMediaLucro: number\n  ingredientesCadastrados: number\n  receitasMaisRentaveis: {\n    nome: string\n    margem: number\n    custo: number\n    preco: number\n  }[]\n  tendenciaVendas: {\n    mes: string\n    valor: number\n  }[]\n}\n\ntype EstatisticasGerais = {\n  totalReceitas: number\n  receitasAtivas: number\n  totalIngredientes: number\n  ingredientesAtivos: number\n  totalOrcamentos: number\n  orcamentosPendentes: number\n  orcamentosAprovados: number\n  valorTotalOrcamentos: number\n  ultimosCalculos: {\n    receita: string\n    valor: number\n    data: string\n  }[]\n}\n\ntype RelatorioIngredientes = {\n  ingredientesMaisUsados: {\n    nome: string\n    categoria: string\n    usos: number\n    custoMedio: number\n  }[]\n  categoriasMaisUsadas: {\n    nome: string\n    quantidade: number\n    cor: string\n  }[]\n  ingredientesCaros: {\n    nome: string\n    preco: number\n    categoria: string\n  }[]\n}\n\nexport default function RelatoriosPage() {\n  const { profile } = useAuth()\n  const { toast } = useToast()\n  \n  // Estados principais\n  const [loading, setLoading] = useState(true)\n  const [activeTab, setActiveTab] = useState('geral')\n  const [periodoFiltro, setPeriodoFiltro] = useState('30') // dias\n  \n  // Estados dos relatórios\n  const [estatisticasGerais, setEstatisticasGerais] = useState<EstatisticasGerais | null>(null)\n  const [relatorioFinanceiro, setRelatorioFinanceiro] = useState<RelatorioFinanceiro | null>(null)\n  const [relatorioIngredientes, setRelatorioIngredientes] = useState<RelatorioIngredientes | null>(null)\n\n  const isPro = profile?.plano === 'pro'\n\n  useEffect(() => {\n    if (profile?.id && isPro) {\n      carregarTodosRelatorios()\n    }\n  }, [profile?.id, isPro, periodoFiltro])\n\n  const carregarTodosRelatorios = async () => {\n    setLoading(true)\n    try {\n      await Promise.all([\n        carregarEstatisticasGerais(),\n        carregarRelatorioFinanceiro(),\n        carregarRelatorioIngredientes()\n      ])\n    } catch (error) {\n      console.error('Erro ao carregar relatórios:', error)\n      toast({\n        title: \"Erro ao carregar relatórios\",\n        description: \"Não foi possível carregar os dados dos relatórios.\",\n        variant: \"destructive\",\n      })\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const carregarEstatisticasGerais = async () => {\n    try {\n      // Carregar receitas\n      const { data: receitas } = await supabase\n        .from('receitas')\n        .select('id, nome, ativa, custo_calculado, preco_sugerido')\n        .eq('user_id', profile?.id)\n\n      // Carregar ingredientes\n      const { data: ingredientes } = await supabase\n        .from('ingredientes')\n        .select('id, nome, ativo')\n        .eq('user_id', profile?.id)\n\n      // Carregar orçamentos\n      const { data: orcamentos } = await supabase\n        .from('orcamentos')\n        .select('id, status, valor_total, created_at')\n        .eq('user_id', profile?.id)\n\n      // Carregar últimos cálculos\n      const { data: calculos } = await supabase\n        .from('calculos_salvos')\n        .select(`\n          id, preco_total, created_at,\n          receitas (nome)\n        `)\n        .eq('user_id', profile?.id)\n        .order('created_at', { ascending: false })\n        .limit(5)\n\n      const stats: EstatisticasGerais = {\n        totalReceitas: receitas?.length || 0,\n        receitasAtivas: receitas?.filter(r => r.ativa).length || 0,\n        totalIngredientes: ingredientes?.length || 0,\n        ingredientesAtivos: ingredientes?.filter(i => i.ativo).length || 0,\n        totalOrcamentos: orcamentos?.length || 0,\n        orcamentosPendentes: orcamentos?.filter(o => o.status === 'pendente').length || 0,\n        orcamentosAprovados: orcamentos?.filter(o => o.status === 'aprovado').length || 0,\n        valorTotalOrcamentos: orcamentos?.reduce((sum, o) => sum + o.valor_total, 0) || 0,\n        ultimosCalculos: calculos?.map(c => ({\n          receita: (c as any).receitas?.nome || 'Receita removida',\n          valor: c.preco_total,\n          data: c.created_at\n        })) || []\n      }\n\n      setEstatisticasGerais(stats)\n    } catch (error) {\n      console.error('Erro ao carregar estatísticas gerais:', error)\n    }\n  }\n\n  const carregarRelatorioFinanceiro = async () => {\n    try {\n      const dataLimite = new Date()\n      dataLimite.setDate(dataLimite.getDate() - parseInt(periodoFiltro))\n\n      // Carregar orçamentos do período\n      const { data: orcamentos } = await supabase\n        .from('orcamentos')\n        .select('*')\n        .eq('user_id', profile?.id)\n        .gte('created_at', dataLimite.toISOString())\n        .order('created_at', { ascending: false })\n\n      // Carregar receitas com cálculos\n      const { data: receitas } = await supabase\n        .from('receitas')\n        .select('nome, custo_calculado, preco_sugerido')\n        .eq('user_id', profile?.id)\n        .not('custo_calculado', 'is', null)\n        .not('preco_sugerido', 'is', null)\n\n      // Carregar ingredientes para contagem\n      const { data: ingredientes } = await supabase\n        .from('ingredientes')\n        .select('id')\n        .eq('user_id', profile?.id)\n\n      // Carregar cálculos do período\n      const { data: calculos } = await supabase\n        .from('calculos_salvos')\n        .select('*')\n        .eq('user_id', profile?.id)\n        .gte('created_at', dataLimite.toISOString())\n\n      // Processar dados\n      const valorMedioOrcamento = orcamentos?.length ? \n        orcamentos.reduce((sum, o) => sum + o.valor_total, 0) / orcamentos.length : 0\n\n      const margemMediaLucro = calculos?.length ?\n        calculos.reduce((sum, c) => {\n          const detalhes = c.detalhes as any\n          return sum + (detalhes?.margemLucro || 0)\n        }, 0) / calculos.length : 0\n\n      // Receitas mais rentáveis\n      const receitasRentaveis = receitas?.map(r => ({\n        nome: r.nome,\n        custo: r.custo_calculado || 0,\n        preco: r.preco_sugerido || 0,\n        margem: r.custo_calculado && r.preco_sugerido ? \n          ((r.preco_sugerido - r.custo_calculado) / r.preco_sugerido) * 100 : 0\n      })).sort((a, b) => b.margem - a.margem).slice(0, 5) || []\n\n      // Tendência de vendas (últimos 6 meses)\n      const tendenciaVendas = []\n      for (let i = 5; i >= 0; i--) {\n        const mesData = new Date()\n        mesData.setMonth(mesData.getMonth() - i)\n        const inicioMes = new Date(mesData.getFullYear(), mesData.getMonth(), 1)\n        const fimMes = new Date(mesData.getFullYear(), mesData.getMonth() + 1, 0)\n        \n        const orcamentosMes = orcamentos?.filter(o => {\n          const dataOrcamento = new Date(o.created_at)\n          return dataOrcamento >= inicioMes && dataOrcamento <= fimMes\n        }) || []\n        \n        tendenciaVendas.push({\n          mes: mesData.toLocaleDateString('pt-BR', { month: 'short' }),\n          valor: orcamentosMes.reduce((sum, o) => sum + o.valor_total, 0)\n        })\n      }\n\n      const relatorio: RelatorioFinanceiro = {\n        periodo: `Últimos ${periodoFiltro} dias`,\n        totalReceitas: receitas?.length || 0,\n        totalOrcamentos: orcamentos?.length || 0,\n        valorMedioOrcamento,\n        receitasCalculadas: receitas?.length || 0,\n        margemMediaLucro: margemMediaLucro * 100, // converter para %\n        ingredientesCadastrados: ingredientes?.length || 0,\n        receitasMaisRentaveis: receitasRentaveis,\n        tendenciaVendas\n      }\n\n      setRelatorioFinanceiro(relatorio)\n    } catch (error) {\n      console.error('Erro ao carregar relatório financeiro:', error)\n    }\n  }\n\n  const carregarRelatorioIngredientes = async () => {\n    try {\n      // Carregar ingredientes com uso\n      const { data: receitaIngredientes } = await supabase\n        .from('receita_ingredientes')\n        .select(`\n          quantidade,\n          ingredientes (id, nome, preco_kg, categoria:categorias_ingredientes(nome, cor)),\n          receitas!inner (user_id)\n        `)\n        .eq('receitas.user_id', profile?.id)\n\n      // Processar ingredientes mais usados\n      const usoIngredientes: { [key: string]: { nome: string, categoria: string, usos: number, custoMedio: number } } = {}\n      \n      receitaIngredientes?.forEach(ri => {\n        const ing = (ri as any).ingredientes\n        if (ing) {\n          const key = ing.id\n          if (!usoIngredientes[key]) {\n            usoIngredientes[key] = {\n              nome: ing.nome,\n              categoria: ing.categoria?.nome || 'Sem categoria',\n              usos: 0,\n              custoMedio: ing.preco_kg\n            }\n          }\n          usoIngredientes[key].usos++\n        }\n      })\n\n      const ingredientesMaisUsados = Object.values(usoIngredientes)\n        .sort((a, b) => b.usos - a.usos)\n        .slice(0, 10)\n\n      // Carregar categorias com contagem\n      const { data: categorias } = await supabase\n        .from('categorias_ingredientes')\n        .select(`\n          nome, cor,\n          ingredientes (id)\n        `)\n        .eq('user_id', profile?.id)\n\n      const categoriasMaisUsadas = categorias?.map(cat => ({\n        nome: cat.nome,\n        quantidade: (cat as any).ingredientes?.length || 0,\n        cor: cat.cor\n      })).sort((a, b) => b.quantidade - a.quantidade).slice(0, 5) || []\n\n      // Ingredientes mais caros\n      const { data: ingredientesCaros } = await supabase\n        .from('ingredientes')\n        .select(`\n          nome, preco_kg,\n          categoria:categorias_ingredientes(nome)\n        `)\n        .eq('user_id', profile?.id)\n        .eq('ativo', true)\n        .order('preco_kg', { ascending: false })\n        .limit(10)\n\n      const relatorio: RelatorioIngredientes = {\n        ingredientesMaisUsados,\n        categoriasMaisUsadas,\n        ingredientesCaros: ingredientesCaros?.map(ing => ({\n          nome: ing.nome,\n          preco: ing.preco_kg,\n          categoria: (ing as any).categoria?.nome || 'Sem categoria'\n        })) || []\n      }\n\n      setRelatorioIngredientes(relatorio)\n    } catch (error) {\n      console.error('Erro ao carregar relatório de ingredientes:', error)\n    }\n  }\n\n  const exportarRelatorio = (tipo: string) => {\n    const data = new Date().toLocaleDateString('pt-BR')\n    let htmlContent = ''\n\n    if (tipo === 'financeiro' && relatorioFinanceiro) {\n      htmlContent = `\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <meta charset=\"utf-8\">\n        <title>Relatório Financeiro - DoceCalc</title>\n        <style>\n          body { font-family: Arial, sans-serif; padding: 20px; color: #333; line-height: 1.6; }\n          .header { text-align: center; border-bottom: 2px solid #e91e63; padding-bottom: 20px; margin-bottom: 30px; }\n          .logo { font-size: 24px; font-weight: bold; color: #e91e63; }\n          .metrics { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 20px 0; }\n          .metric { background-color: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center; }\n          .metric h3 { margin: 0; color: #e91e63; }\n          .metric p { margin: 5px 0; font-size: 24px; font-weight: bold; }\n          .table { width: 100%; border-collapse: collapse; margin: 20px 0; }\n          .table th, .table td { border: 1px solid #ddd; padding: 12px; text-align: left; }\n          .table th { background-color: #e91e63; color: white; }\n          @media print { body { margin: 0; } .no-print { display: none; } }\n        </style>\n      </head>\n      <body>\n        <div class=\"header\">\n          <div class=\"logo\">🍰 DoceCalc</div>\n          <h2>Relatório Financeiro</h2>\n          <p>Período: ${relatorioFinanceiro.periodo} | Gerado em: ${data}</p>\n        </div>\n\n        <div class=\"metrics\">\n          <div class=\"metric\">\n            <h3>Valor Médio/Orçamento</h3>\n            <p>R$ ${relatorioFinanceiro.valorMedioOrcamento.toFixed(2)}</p>\n          </div>\n          <div class=\"metric\">\n            <h3>Margem Média</h3>\n            <p>${relatorioFinanceiro.margemMediaLucro.toFixed(1)}%</p>\n          </div>\n          <div class=\"metric\">\n            <h3>Total de Receitas</h3>\n            <p>${relatorioFinanceiro.totalReceitas}</p>\n          </div>\n        </div>\n\n        <h3>Receitas Mais Rentáveis</h3>\n        <table class=\"table\">\n          <thead>\n            <tr><th>Receita</th><th>Custo</th><th>Preço</th><th>Margem</th></tr>\n          </thead>\n          <tbody>\n            ${relatorioFinanceiro.receitasMaisRentaveis.map(r => `\n              <tr>\n                <td>${r.nome}</td>\n                <td>R$ ${r.custo.toFixed(2)}</td>\n                <td>R$ ${r.preco.toFixed(2)}</td>\n                <td>${r.margem.toFixed(1)}%</td>\n              </tr>\n            `).join('')}\n          </tbody>\n        </table>\n\n        <div class=\"no-print\" style=\"margin-top: 30px; text-align: center;\">\n          <button onclick=\"window.print()\" style=\"background: #e91e63; color: white; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer;\">\n            🖨️ Imprimir / Salvar PDF\n          </button>\n          <button onclick=\"window.close()\" style=\"background: #6c757d; color: white; border: none; padding: 12px 24px; border-radius: 6px; margin-left: 10px;\">\n            ✕ Fechar\n          </button>\n        </div>\n      </body>\n      </html>\n      `\n    } else if (tipo === 'ingredientes' && relatorioIngredientes) {\n      htmlContent = `\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <meta charset=\"utf-8\">\n        <title>Relatório de Ingredientes - DoceCalc</title>\n        <style>\n          body { font-family: Arial, sans-serif; padding: 20px; color: #333; line-height: 1.6; }\n          .header { text-align: center; border-bottom: 2px solid #e91e63; padding-bottom: 20px; margin-bottom: 30px; }\n          .logo { font-size: 24px; font-weight: bold; color: #e91e63; }\n          .table { width: 100%; border-collapse: collapse; margin: 20px 0; }\n          .table th, .table td { border: 1px solid #ddd; padding: 12px; text-align: left; }\n          .table th { background-color: #e91e63; color: white; }\n          @media print { body { margin: 0; } .no-print { display: none; } }\n        </style>\n      </head>\n      <body>\n        <div class=\"header\">\n          <div class=\"logo\">🍰 DoceCalc</div>\n          <h2>Relatório de Ingredientes</h2>\n          <p>Gerado em: ${data}</p>\n        </div>\n\n        <h3>Ingredientes Mais Utilizados</h3>\n        <table class=\"table\">\n          <thead>\n            <tr><th>Ingrediente</th><th>Categoria</th><th>Usos</th><th>Custo/Kg</th></tr>\n          </thead>\n          <tbody>\n            ${relatorioIngredientes.ingredientesMaisUsados.map(ing => `\n              <tr>\n                <td>${ing.nome}</td>\n                <td>${ing.categoria}</td>\n                <td>${ing.usos}</td>\n                <td>R$ ${ing.custoMedio.toFixed(2)}</td>\n              </tr>\n            `).join('')}\n          </tbody>\n        </table>\n\n        <div class=\"no-print\" style=\"margin-top: 30px; text-align: center;\">\n          <button onclick=\"window.print()\" style=\"background: #e91e63; color: white; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer;\">\n            🖨️ Imprimir / Salvar PDF\n          </button>\n          <button onclick=\"window.close()\" style=\"background: #6c757d; color: white; border: none; padding: 12px 24px; border-radius: 6px; margin-left: 10px;\">\n            ✕ Fechar\n          </button>\n        </div>\n      </body>\n      </html>\n      `\n    }\n\n    if (htmlContent) {\n      const newWindow = window.open('', '_blank')\n      if (newWindow) {\n        newWindow.document.write(htmlContent)\n        newWindow.document.close()\n      } else {\n        toast({\n          title: \"Erro ao exportar\",\n          description: \"Não foi possível abrir a janela de exportação.\",\n          variant: \"destructive\",\n        })\n      }\n    } else {\n      toast({\n        title: \"Funcionalidade em desenvolvimento\",\n        description: `A exportação de ${tipo} será implementada em breve.`,\n      })\n    }\n  }\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('pt-BR')\n  }\n\n  const formatPercent = (value: number) => {\n    return `${value.toFixed(1)}%`\n  }\n\n  if (!isPro) {\n    return (\n      <div className=\"min-h-screen bg-gradient-soft flex items-center justify-center py-8 px-4\">\n        <Card className=\"max-w-lg mx-auto text-center\">\n          <CardHeader>\n            <div className=\"w-16 h-16 bg-gradient-doce rounded-full flex items-center justify-center mx-auto mb-4\">\n              <Crown className=\"h-8 w-8 text-white\" />\n            </div>\n            <CardTitle className=\"text-2xl\">Relatórios PRO</CardTitle>\n            <CardDescription>\n              Os relatórios detalhados estão disponíveis apenas no plano PRO\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4 text-sm text-gray-600\">\n              <div className=\"flex items-center space-x-3\">\n                <CheckCircle className=\"h-5 w-5 text-green-500\" />\n                <span>Análises financeiras completas</span>\n              </div>\n              <div className=\"flex items-center space-x-3\">\n                <CheckCircle className=\"h-5 w-5 text-green-500\" />\n                <span>Relatórios de rentabilidade</span>\n              </div>\n              <div className=\"flex items-center space-x-3\">\n                <CheckCircle className=\"h-5 w-5 text-green-500\" />\n                <span>Análise de ingredientes e custos</span>\n              </div>\n              <div className=\"flex items-center space-x-3\">\n                <CheckCircle className=\"h-5 w-5 text-green-500\" />\n                <span>Exportação em PDF profissional</span>\n              </div>\n              <div className=\"flex items-center space-x-3\">\n                <CheckCircle className=\"h-5 w-5 text-green-500\" />\n                <span>Tendências e projeções</span>\n              </div>\n            </div>\n            \n            <Button asChild className=\"w-full mt-6\" variant=\"doce\">\n              <a href=\"/dashboard/upgrade\">\n                <Crown className=\"h-4 w-4 mr-2\" />\n                Fazer Upgrade para PRO\n              </a>\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    )\n  }\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-soft flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4\" />\n          <p className=\"text-gray-600\">Carregando relatórios...</p>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-soft py-8 px-4\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"text-center mb-8\">\n          <div className=\"flex items-center justify-center space-x-2 mb-4\">\n            <BarChart3 className=\"h-8 w-8 text-primary\" />\n            <h1 className=\"text-3xl font-display font-bold text-gray-900\">\n              Relatórios e Análises\n            </h1>\n            <Badge className=\"bg-gradient-doce text-white\">\n              <Crown className=\"h-3 w-3 mr-1\" />\n              PRO\n            </Badge>\n          </div>\n          <p className=\"text-gray-600 max-w-2xl mx-auto\">\n            Análises detalhadas do seu negócio, tendências financeiras e insights para tomar decisões estratégicas\n          </p>\n        </div>\n\n        {/* Controles */}\n        <div className=\"flex flex-col sm:flex-row gap-4 mb-8\">\n          <div className=\"flex items-center space-x-2\">\n            <Filter className=\"h-5 w-5 text-gray-500\" />\n            <Label htmlFor=\"periodo\">Período:</Label>\n            <select\n              id=\"periodo\"\n              value={periodoFiltro}\n              onChange={(e) => setPeriodoFiltro(e.target.value)}\n              className=\"flex h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n            >\n              <option value=\"7\">Últimos 7 dias</option>\n              <option value=\"30\">Últimos 30 dias</option>\n              <option value=\"90\">Últimos 90 dias</option>\n              <option value=\"365\">Último ano</option>\n            </select>\n          </div>\n          \n          <Button \n            onClick={carregarTodosRelatorios}\n            variant=\"outline\"\n            size=\"sm\"\n          >\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            Atualizar\n          </Button>\n        </div>\n\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-6\">\n          <TabsList className=\"grid w-full grid-cols-3\">\n            <TabsTrigger value=\"geral\">Visão Geral</TabsTrigger>\n            <TabsTrigger value=\"financeiro\">Análise Financeira</TabsTrigger>\n            <TabsTrigger value=\"ingredientes\">Análise de Ingredientes</TabsTrigger>\n          </TabsList>\n\n          {/* Visão Geral */}\n          <TabsContent value=\"geral\" className=\"space-y-6\">\n            {estatisticasGerais && (\n              <>\n                {/* Cards de Estatísticas */}\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n                  <Card>\n                    <CardContent className=\"p-6\">\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <p className=\"text-sm font-medium text-gray-600\">Total de Receitas</p>\n                          <p className=\"text-2xl font-bold text-gray-900\">\n                            {estatisticasGerais.totalReceitas}\n                          </p>\n                          <p className=\"text-xs text-gray-500\">\n                            {estatisticasGerais.receitasAtivas} ativas\n                          </p>\n                        </div>\n                        <ChefHat className=\"h-8 w-8 text-primary\" />\n                      </div>\n                    </CardContent>\n                  </Card>\n\n                  <Card>\n                    <CardContent className=\"p-6\">\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <p className=\"text-sm font-medium text-gray-600\">Ingredientes</p>\n                          <p className=\"text-2xl font-bold text-gray-900\">\n                            {estatisticasGerais.totalIngredientes}\n                          </p>\n                          <p className=\"text-xs text-gray-500\">\n                            {estatisticasGerais.ingredientesAtivos} ativos\n                          </p>\n                        </div>\n                        <Package className=\"h-8 w-8 text-primary\" />\n                      </div>\n                    </CardContent>\n                  </Card>\n\n                  <Card>\n                    <CardContent className=\"p-6\">\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <p className=\"text-sm font-medium text-gray-600\">Orçamentos</p>\n                          <p className=\"text-2xl font-bold text-gray-900\">\n                            {estatisticasGerais.totalOrcamentos}\n                          </p>\n                          <p className=\"text-xs text-gray-500\">\n                            {estatisticasGerais.orcamentosPendentes} pendentes\n                          </p>\n                        </div>\n                        <FileText className=\"h-8 w-8 text-primary\" />\n                      </div>\n                    </CardContent>\n                  </Card>\n\n                  <Card>\n                    <CardContent className=\"p-6\">\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <p className=\"text-sm font-medium text-gray-600\">Valor Total</p>\n                          <p className=\"text-2xl font-bold text-gray-900\">\n                            {formatarMoeda(estatisticasGerais.valorTotalOrcamentos)}\n                          </p>\n                          <p className=\"text-xs text-gray-500\">\n                            {estatisticasGerais.orcamentosAprovados} aprovados\n                          </p>\n                        </div>\n                        <DollarSign className=\"h-8 w-8 text-primary\" />\n                      </div>\n                    </CardContent>\n                  </Card>\n                </div>\n\n                {/* Últimos Cálculos */}\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center space-x-2\">\n                      <Calculator className=\"h-5 w-5\" />\n                      <span>Últimos Cálculos Realizados</span>\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    {estatisticasGerais.ultimosCalculos.length > 0 ? (\n                      <div className=\"space-y-3\">\n                        {estatisticasGerais.ultimosCalculos.map((calculo, index) => (\n                          <div key={index} className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n                            <div>\n                              <p className=\"font-medium\">{calculo.receita}</p>\n                              <p className=\"text-sm text-gray-600\">{formatDate(calculo.data)}</p>\n                            </div>\n                            <div className=\"text-right\">\n                              <p className=\"font-semibold text-primary\">\n                                {formatarMoeda(calculo.valor)}\n                              </p>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    ) : (\n                      <div className=\"text-center py-8 text-gray-500\">\n                        <Calculator className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                        <p>Nenhum cálculo realizado ainda</p>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              </>\n            )}\n          </TabsContent>\n\n          {/* Análise Financeira */}\n          <TabsContent value=\"financeiro\" className=\"space-y-6\">\n            {relatorioFinanceiro && (\n              <>\n                {/* Métricas Financeiras */}\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                  <Card>\n                    <CardContent className=\"p-6\">\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <p className=\"text-sm font-medium text-gray-600\">Valor Médio/Orçamento</p>\n                          <p className=\"text-2xl font-bold text-gray-900\">\n                            {formatarMoeda(relatorioFinanceiro.valorMedioOrcamento)}\n                          </p>\n                        </div>\n                        <TrendingUp className=\"h-8 w-8 text-green-500\" />\n                      </div>\n                    </CardContent>\n                  </Card>\n\n                  <Card>\n                    <CardContent className=\"p-6\">\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <p className=\"text-sm font-medium text-gray-600\">Margem Média de Lucro</p>\n                          <p className=\"text-2xl font-bold text-gray-900\">\n                            {formatPercent(relatorioFinanceiro.margemMediaLucro)}\n                          </p>\n                        </div>\n                        <Target className=\"h-8 w-8 text-primary\" />\n                      </div>\n                    </CardContent>\n                  </Card>\n\n                  <Card>\n                    <CardContent className=\"p-6\">\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <p className=\"text-sm font-medium text-gray-600\">Receitas Calculadas</p>\n                          <p className=\"text-2xl font-bold text-gray-900\">\n                            {relatorioFinanceiro.receitasCalculadas}\n                          </p>\n                        </div>\n                        <Calculator className=\"h-8 w-8 text-blue-500\" />\n                      </div>\n                    </CardContent>\n                  </Card>\n                </div>\n\n                {/* Receitas Mais Rentáveis */}\n                <Card>\n                  <CardHeader>\n                    <div className=\"flex items-center justify-between\">\n                      <CardTitle className=\"flex items-center space-x-2\">\n                        <TrendingUp className=\"h-5 w-5\" />\n                        <span>Receitas Mais Rentáveis</span>\n                      </CardTitle>\n                      <Button onClick={() => exportarRelatorio('financeiro')} size=\"sm\" variant=\"outline\">\n                        <Download className=\"h-4 w-4 mr-2\" />\n                        Exportar\n                      </Button>\n                    </div>\n                  </CardHeader>\n                  <CardContent>\n                    {relatorioFinanceiro.receitasMaisRentaveis.length > 0 ? (\n                      <div className=\"space-y-3\">\n                        {relatorioFinanceiro.receitasMaisRentaveis.map((receita, index) => (\n                          <div key={index} className=\"grid grid-cols-4 gap-4 p-3 bg-gray-50 rounded-lg\">\n                            <div>\n                              <p className=\"font-medium\">{receita.nome}</p>\n                            </div>\n                            <div>\n                              <p className=\"text-sm text-gray-600\">Custo</p>\n                              <p className=\"font-medium\">{formatarMoeda(receita.custo)}</p>\n                            </div>\n                            <div>\n                              <p className=\"text-sm text-gray-600\">Preço</p>\n                              <p className=\"font-medium\">{formatarMoeda(receita.preco)}</p>\n                            </div>\n                            <div>\n                              <p className=\"text-sm text-gray-600\">Margem</p>\n                              <p className=\"font-semibold text-green-600\">\n                                {formatPercent(receita.margem)}\n                              </p>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    ) : (\n                      <div className=\"text-center py-8 text-gray-500\">\n                        <TrendingUp className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                        <p>Nenhuma receita com cálculo de rentabilidade</p>\n                        <p className=\"text-sm\">Use a calculadora para analisar suas receitas</p>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n\n                {/* Tendência de Vendas */}\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center space-x-2\">\n                      <BarChart3 className=\"h-5 w-5\" />\n                      <span>Tendência de Orçamentos (Últimos 6 Meses)</span>\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"grid grid-cols-6 gap-4\">\n                      {relatorioFinanceiro.tendenciaVendas.map((item, index) => (\n                        <div key={index} className=\"text-center\">\n                          <div className=\"bg-primary/10 rounded-lg p-4 mb-2\">\n                            <div \n                              className=\"bg-primary rounded w-full\" \n                              style={{ \n                                height: `${Math.max(20, (item.valor / Math.max(...relatorioFinanceiro.tendenciaVendas.map(t => t.valor))) * 100)}px` \n                              }}\n                            />\n                          </div>\n                          <p className=\"text-sm font-medium capitalize\">{item.mes}</p>\n                          <p className=\"text-xs text-gray-600\">{formatarMoeda(item.valor)}</p>\n                        </div>\n                      ))}\n                    </div>\n                  </CardContent>\n                </Card>\n              </>\n            )}\n          </TabsContent>\n\n          {/* Análise de Ingredientes */}\n          <TabsContent value=\"ingredientes\" className=\"space-y-6\">\n            {relatorioIngredientes && (\n              <>\n                {/* Ingredientes Mais Usados */}\n                <Card>\n                  <CardHeader>\n                    <div className=\"flex items-center justify-between\">\n                      <CardTitle className=\"flex items-center space-x-2\">\n                        <Package className=\"h-5 w-5\" />\n                        <span>Ingredientes Mais Utilizados</span>\n                      </CardTitle>\n                      <Button onClick={() => exportarRelatorio('ingredientes')} size=\"sm\" variant=\"outline\">\n                        <Download className=\"h-4 w-4 mr-2\" />\n                        Exportar\n                      </Button>\n                    </div>\n                  </CardHeader>\n                  <CardContent>\n                    {relatorioIngredientes.ingredientesMaisUsados.length > 0 ? (\n                      <div className=\"space-y-3\">\n                        {relatorioIngredientes.ingredientesMaisUsados.map((ingrediente, index) => (\n                          <div key={index} className=\"grid grid-cols-4 gap-4 p-3 bg-gray-50 rounded-lg\">\n                            <div>\n                              <p className=\"font-medium\">{ingrediente.nome}</p>\n                              <p className=\"text-sm text-gray-600\">{ingrediente.categoria}</p>\n                            </div>\n                            <div>\n                              <p className=\"text-sm text-gray-600\">Usos</p>\n                              <p className=\"font-medium\">{ingrediente.usos}</p>\n                            </div>\n                            <div>\n                              <p className=\"text-sm text-gray-600\">Custo/Kg</p>\n                              <p className=\"font-medium\">{formatarMoeda(ingrediente.custoMedio)}</p>\n                            </div>\n                            <div>\n                              <Badge variant=\"outline\">\n                                #{index + 1}\n                              </Badge>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    ) : (\n                      <div className=\"text-center py-8 text-gray-500\">\n                        <Package className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                        <p>Nenhum ingrediente utilizado ainda</p>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n\n                <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                  {/* Categorias Mais Usadas */}\n                  <Card>\n                    <CardHeader>\n                      <CardTitle className=\"flex items-center space-x-2\">\n                        <PieChart className=\"h-5 w-5\" />\n                        <span>Categorias por Quantidade</span>\n                      </CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                      {relatorioIngredientes.categoriasMaisUsadas.length > 0 ? (\n                        <div className=\"space-y-3\">\n                          {relatorioIngredientes.categoriasMaisUsadas.map((categoria, index) => (\n                            <div key={index} className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n                              <div className=\"flex items-center space-x-3\">\n                                <div \n                                  className=\"w-4 h-4 rounded-full\" \n                                  style={{ backgroundColor: categoria.cor }}\n                                />\n                                <span className=\"font-medium\">{categoria.nome}</span>\n                              </div>\n                              <Badge variant=\"outline\">\n                                {categoria.quantidade} {categoria.quantidade === 1 ? 'item' : 'itens'}\n                              </Badge>\n                            </div>\n                          ))}\n                        </div>\n                      ) : (\n                        <div className=\"text-center py-8 text-gray-500\">\n                          <PieChart className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                          <p>Nenhuma categoria criada</p>\n                        </div>\n                      )}\n                    </CardContent>\n                  </Card>\n\n                  {/* Ingredientes Mais Caros */}\n                  <Card>\n                    <CardHeader>\n                      <CardTitle className=\"flex items-center space-x-2\">\n                        <DollarSign className=\"h-5 w-5\" />\n                        <span>Ingredientes Mais Caros</span>\n                      </CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                      {relatorioIngredientes.ingredientesCaros.length > 0 ? (\n                        <div className=\"space-y-3\">\n                          {relatorioIngredientes.ingredientesCaros.slice(0, 5).map((ingrediente, index) => (\n                            <div key={index} className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n                              <div>\n                                <p className=\"font-medium\">{ingrediente.nome}</p>\n                                <p className=\"text-sm text-gray-600\">{ingrediente.categoria}</p>\n                              </div>\n                              <div className=\"text-right\">\n                                <p className=\"font-semibold text-red-600\">\n                                  {formatarMoeda(ingrediente.preco)}\n                                </p>\n                                <p className=\"text-xs text-gray-500\">por Kg</p>\n                              </div>\n                            </div>\n                          ))}\n                        </div>\n                      ) : (\n                        <div className=\"text-center py-8 text-gray-500\">\n                          <DollarSign className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                          <p>Nenhum ingrediente cadastrado</p>\n                        </div>\n                      )}\n                    </CardContent>\n                  </Card>\n                </div>\n              </>\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  )\n}","size_bytes":40063},"app/dashboard/upgrade/page.tsx":{"content":"'use client'\n\nimport { useState } from 'react'\nimport { useAuth } from '@/components/auth/auth-provider'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { \n  CheckCircle, \n  Crown, \n  CreditCard, \n  Smartphone, \n  Zap,\n  Shield,\n  Star,\n  ArrowRight\n} from 'lucide-react'\nimport { useRouter } from 'next/navigation'\nimport Link from 'next/link'\n\nexport default function UpgradePage() {\n  const { profile } = useAuth()\n  const router = useRouter()\n  const [isLoading, setIsLoading] = useState(false)\n  const [selectedPayment, setSelectedPayment] = useState<'pix' | 'card'>('pix')\n\n  const isPro = profile?.plano === 'pro'\n\n  if (isPro) {\n    return (\n      <div className=\"min-h-screen bg-gradient-soft flex items-center justify-center\">\n        <Card className=\"max-w-md mx-auto text-center\">\n          <CardHeader>\n            <div className=\"mx-auto w-16 h-16 bg-gradient-doce rounded-full flex items-center justify-center mb-4\">\n              <Crown className=\"h-8 w-8 text-white\" />\n            </div>\n            <CardTitle className=\"text-2xl\">Você já é PRO! 🎉</CardTitle>\n            <CardDescription>\n              Você já tem acesso a todas as funcionalidades premium do DoceCalc.\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Link href=\"/dashboard\">\n              <Button variant=\"doce\" className=\"w-full\">\n                Voltar ao Dashboard\n                <ArrowRight className=\"ml-2 h-4 w-4\" />\n              </Button>\n            </Link>\n          </CardContent>\n        </Card>\n      </div>\n    )\n  }\n\n  const handleUpgrade = async (method: 'pix' | 'card') => {\n    setIsLoading(true)\n    \n    try {\n      if (method === 'pix') {\n        // Redirecionar para página de pagamento PIX (AbacatePay)\n        router.push('/dashboard/upgrade/pix')\n      } else {\n        // Redirecionar para página de pagamento Stripe\n        router.push('/dashboard/upgrade/stripe')\n      }\n    } catch (error) {\n      console.error('Erro no upgrade:', error)\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const proFeatures = [\n    'Receitas ilimitadas',\n    'Calculadora avançada com economia de escala',\n    'Orçamentos profissionais em PDF',\n    'Relatórios detalhados de lucratividade',\n    'Templates de receitas prontos',\n    'Análise de custos por categoria',\n    'Suporte prioritário',\n    'Atualizações de preços automáticas'\n  ]\n\n  return (\n    <div className=\"min-h-screen bg-gradient-soft py-12 px-4\">\n      <div className=\"max-w-4xl mx-auto\">\n        {/* Header */}\n        <div className=\"text-center mb-12\">\n          <Badge className=\"bg-primary/10 text-primary border-primary/20 mb-4\">\n            Upgrade Disponível 🚀\n          </Badge>\n          <h1 className=\"text-4xl font-display font-bold text-gray-900 mb-4\">\n            Desbloqueie todo o potencial do \n            <span className=\"text-transparent bg-gradient-doce bg-clip-text\"> DoceCalc</span>\n          </h1>\n          <p className=\"text-xl text-gray-600 max-w-2xl mx-auto\">\n            Transforme sua confeitaria em um negócio realmente lucrativo com nosso plano profissional\n          </p>\n        </div>\n\n        <div className=\"grid lg:grid-cols-2 gap-8 mb-12\">\n          {/* Plano Atual */}\n          <Card className=\"relative\">\n            <CardHeader>\n              <div className=\"text-center\">\n                <CardTitle className=\"text-xl mb-2\">Plano Atual - Gratuito</CardTitle>\n                <div className=\"text-3xl font-bold text-gray-600\">R$ 0</div>\n                <p className=\"text-gray-500\">Funcionalidades básicas</p>\n              </div>\n            </CardHeader>\n            <CardContent>\n              <ul className=\"space-y-3\">\n                <li className=\"flex items-center text-gray-600\">\n                  <CheckCircle className=\"h-4 w-4 text-green-500 mr-3\" />\n                  Até 3 receitas\n                </li>\n                <li className=\"flex items-center text-gray-400 line-through\">\n                  <Crown className=\"h-4 w-4 text-gray-300 mr-3\" />\n                  Receitas ilimitadas\n                </li>\n                <li className=\"flex items-center text-gray-400 line-through\">\n                  <Crown className=\"h-4 w-4 text-gray-300 mr-3\" />\n                  Orçamentos profissionais\n                </li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Plano PRO */}\n          <Card className=\"relative border-primary bg-gradient-to-b from-primary/5 to-transparent\">\n            <div className=\"absolute -top-3 left-1/2 transform -translate-x-1/2\">\n              <Badge className=\"bg-gradient-doce text-white\">Recomendado 🔥</Badge>\n            </div>\n            <CardHeader>\n              <div className=\"text-center\">\n                <CardTitle className=\"text-xl mb-2 flex items-center justify-center\">\n                  <Crown className=\"h-5 w-5 text-primary mr-2\" />\n                  Plano Profissional\n                </CardTitle>\n                <div className=\"text-4xl font-bold text-primary\">R$ 29</div>\n                <p className=\"text-gray-600\">por mês</p>\n              </div>\n            </CardHeader>\n            <CardContent>\n              <ul className=\"space-y-3 mb-6\">\n                {proFeatures.map((feature, index) => (\n                  <li key={index} className=\"flex items-center\">\n                    <CheckCircle className=\"h-4 w-4 text-green-500 mr-3 flex-shrink-0\" />\n                    <span className=\"text-sm\">{feature}</span>\n                  </li>\n                ))}\n              </ul>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Métodos de Pagamento */}\n        <Card className=\"max-w-2xl mx-auto\">\n          <CardHeader>\n            <CardTitle className=\"text-center text-2xl\">\n              Escolha como pagar 💳\n            </CardTitle>\n            <CardDescription className=\"text-center\">\n              Oferecemos as melhores opções de pagamento para você\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Tabs value={selectedPayment} onValueChange={(value) => setSelectedPayment(value as 'pix' | 'card')}>\n              <TabsList className=\"grid w-full grid-cols-2\">\n                <TabsTrigger value=\"pix\" className=\"flex items-center\">\n                  <Smartphone className=\"h-4 w-4 mr-2\" />\n                  PIX\n                </TabsTrigger>\n                <TabsTrigger value=\"card\" className=\"flex items-center\">\n                  <CreditCard className=\"h-4 w-4 mr-2\" />\n                  Cartão\n                </TabsTrigger>\n              </TabsList>\n              \n              <TabsContent value=\"pix\" className=\"mt-6\">\n                <div className=\"text-center space-y-4\">\n                  <div className=\"bg-green-50 p-4 rounded-lg border border-green-200\">\n                    <div className=\"flex items-center justify-center mb-2\">\n                      <Zap className=\"h-6 w-6 text-green-600 mr-2\" />\n                      <span className=\"font-semibold text-green-800\">PIX Instantâneo</span>\n                    </div>\n                    <p className=\"text-green-700 text-sm\">\n                      Pagamento processado na hora, acesso imediato às funcionalidades PRO\n                    </p>\n                  </div>\n                  \n                  <div className=\"text-2xl font-bold text-gray-900\">\n                    R$ 29,00\n                  </div>\n                  \n                  <Button \n                    onClick={() => handleUpgrade('pix')} \n                    disabled={isLoading}\n                    size=\"lg\" \n                    variant=\"doce\" \n                    className=\"w-full\"\n                  >\n                    {isLoading ? (\n                      <div className=\"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2\" />\n                    ) : (\n                      <Smartphone className=\"h-5 w-5 mr-2\" />\n                    )}\n                    Pagar com PIX\n                  </Button>\n                </div>\n              </TabsContent>\n              \n              <TabsContent value=\"card\" className=\"mt-6\">\n                <div className=\"text-center space-y-4\">\n                  <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\n                    <div className=\"flex items-center justify-center mb-2\">\n                      <Shield className=\"h-6 w-6 text-blue-600 mr-2\" />\n                      <span className=\"font-semibold text-blue-800\">Pagamento Seguro</span>\n                    </div>\n                    <p className=\"text-blue-700 text-sm\">\n                      Processado pelo Stripe, a plataforma mais segura do mundo\n                    </p>\n                  </div>\n                  \n                  <div className=\"text-2xl font-bold text-gray-900\">\n                    R$ 29,00\n                  </div>\n                  \n                  <Button \n                    onClick={() => handleUpgrade('card')} \n                    disabled={isLoading}\n                    size=\"lg\" \n                    variant=\"doce\" \n                    className=\"w-full\"\n                  >\n                    {isLoading ? (\n                      <div className=\"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2\" />\n                    ) : (\n                      <CreditCard className=\"h-5 w-5 mr-2\" />\n                    )}\n                    Pagar com Cartão\n                  </Button>\n                </div>\n              </TabsContent>\n            </Tabs>\n\n            <div className=\"mt-6 text-center text-sm text-gray-500\">\n              <div className=\"flex items-center justify-center space-x-4\">\n                <div className=\"flex items-center\">\n                  <CheckCircle className=\"h-4 w-4 mr-1 text-green-500\" />\n                  Acesso imediato\n                </div>\n                <div className=\"flex items-center\">\n                  <CheckCircle className=\"h-4 w-4 mr-1 text-green-500\" />\n                  Cancele quando quiser\n                </div>\n                <div className=\"flex items-center\">\n                  <CheckCircle className=\"h-4 w-4 mr-1 text-green-500\" />\n                  Suporte 24/7\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Depoimentos */}\n        <div className=\"mt-16 text-center\">\n          <h3 className=\"text-2xl font-bold text-gray-900 mb-8\">\n            O que dizem nossas usuárias PRO 💬\n          </h3>\n          \n          <div className=\"grid md:grid-cols-3 gap-6 max-w-4xl mx-auto\">\n            <Card className=\"text-center\">\n              <CardContent className=\"pt-6\">\n                <div className=\"flex justify-center mb-3\">\n                  {[...Array(5)].map((_, i) => (\n                    <Star key={i} className=\"h-4 w-4 text-yellow-400 fill-current\" />\n                  ))}\n                </div>\n                <p className=\"text-sm text-gray-600 mb-4\">\n                  \"Depois do upgrade, meu lucro aumentou 150%! Os relatórios me mostraram onde eu estava perdendo dinheiro.\"\n                </p>\n                <p className=\"font-semibold\">Marina Santos</p>\n                <p className=\"text-xs text-gray-500\">Docinhos da Mari</p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"text-center\">\n              <CardContent className=\"pt-6\">\n                <div className=\"flex justify-center mb-3\">\n                  {[...Array(5)].map((_, i) => (\n                    <Star key={i} className=\"h-4 w-4 text-yellow-400 fill-current\" />\n                  ))}\n                </div>\n                <p className=\"text-sm text-gray-600 mb-4\">\n                  \"Os orçamentos em PDF impressionam os clientes. Consegui fechar 40% mais vendas!\"\n                </p>\n                <p className=\"font-semibold\">Julia Oliveira</p>\n                <p className=\"text-xs text-gray-500\">Confeitaria Ju</p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"text-center\">\n              <CardContent className=\"pt-6\">\n                <div className=\"flex justify-center mb-3\">\n                  {[...Array(5)].map((_, i) => (\n                    <Star key={i} className=\"h-4 w-4 text-yellow-400 fill-current\" />\n                  ))}\n                </div>\n                <p className=\"text-sm text-gray-600 mb-4\">\n                  \"Agora sei exatamente quanto cobrar em cada receita. Nunca mais vendo no prejuízo!\"\n                </p>\n                <p className=\"font-semibold\">Carla Silva</p>\n                <p className=\"text-xs text-gray-500\">Doces da Carla</p>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}","size_bytes":13072},"app/api/auth/login/route.ts":{"content":"import { NextRequest, NextResponse } from 'next/server'\nimport { signIn } from '@/lib/auth'\n\n// Use Node.js runtime for database operations\nexport const runtime = 'nodejs'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { email, password } = await request.json()\n    if (!email || !password) {\n      return NextResponse.json({ error: 'Email e senha são obrigatórios' }, { status: 400 })\n    }\n\n    const result = await signIn(email, password)\n\n    return NextResponse.json({\n      success: true,\n      user: result.user,\n      token: result.token,\n    })\n  } catch (error: any) {\n    console.error('Erro no login:', error)\n    return NextResponse.json({ error: error.message || 'Erro interno' }, { status: 500 })\n  }\n}\n","size_bytes":743},"app/api/auth/register/route.ts":{"content":"import { NextRequest, NextResponse } from 'next/server'\nimport { signUp } from '@/lib/auth'\n\n// Use Node.js runtime for database operations\nexport const runtime = 'nodejs'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { email, password, nome } = await request.json()\n\n    if (!email || !password || !nome) {\n      return NextResponse.json(\n        { error: 'Email, senha e nome são obrigatórios' },\n        { status: 400 }\n      )\n    }\n\n    const result = await signUp(email, password, nome)\n\n    return NextResponse.json({\n      success: true,\n      user: {\n        id: result.user.id,\n        email: result.user.email,\n        nome: result.user.nome,\n        plano: result.user.plano,\n      },\n      token: result.token,\n    })\n  } catch (error: any) {\n    console.error('Erro no cadastro:', error)\n    return NextResponse.json(\n      { error: error.message || 'Erro interno do servidor' },\n      { status: 400 }\n    )\n  }\n}\n","size_bytes":954},"app/api/user/upgrade/route.ts":{"content":"import { NextRequest, NextResponse } from 'next/server'\nimport { createRouteHandlerClient } from '@supabase/auth-helpers-nextjs'\nimport { cookies } from 'next/headers'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const supabase = createRouteHandlerClient({ cookies })\n    const body = await request.json()\n    const { paymentIntentId, plan = 'pro' } = body\n\n    // Verificar se o usuário está autenticado\n    const { data: { session }, error: sessionError } = await supabase.auth.getSession()\n    \n    if (sessionError || !session?.user) {\n      return NextResponse.json(\n        { error: 'Usuário não autenticado' },\n        { status: 401 }\n      )\n    }\n\n    const userId = session.user.id\n\n    // Atualizar o plano do usuário no banco de dados\n    const { data: updatedProfile, error: updateError } = await supabase\n      .from('profiles')\n      .update({\n        plano: plan,\n        updated_at: new Date().toISOString()\n      })\n      .eq('id', userId)\n      .select()\n      .single()\n\n    if (updateError) {\n      console.error('Erro ao atualizar perfil:', updateError)\n      return NextResponse.json(\n        { error: 'Erro ao atualizar perfil do usuário' },\n        { status: 500 }\n      )\n    }\n\n    // Opcional: Salvar informações do pagamento para histórico\n    /*\n    const { error: paymentError } = await supabase\n      .from('payments')\n      .insert({\n        user_id: userId,\n        payment_intent_id: paymentIntentId,\n        amount: 2900, // R$ 29,00 em centavos\n        currency: 'BRL',\n        status: 'completed',\n        plan: plan,\n        method: 'stripe',\n        created_at: new Date().toISOString()\n      })\n\n    if (paymentError) {\n      console.error('Erro ao salvar pagamento:', paymentError)\n      // Não falhar a requisição se não conseguir salvar o histórico\n    }\n    */\n\n    return NextResponse.json({\n      success: true,\n      profile: updatedProfile,\n      message: 'Upgrade realizado com sucesso!'\n    })\n\n  } catch (error: any) {\n    console.error('Erro ao fazer upgrade do usuário:', error)\n    return NextResponse.json(\n      { error: 'Erro interno do servidor' },\n      { status: 500 }\n    )\n  }\n}","size_bytes":2175},"app/dashboard/upgrade/pix/page.tsx":{"content":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useAuth } from '@/components/auth/auth-provider'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport { \n  ArrowLeft, \n  Copy, \n  CheckCircle, \n  Clock,\n  Smartphone,\n  QrCode\n} from 'lucide-react'\nimport { useRouter } from 'next/navigation'\nimport Link from 'next/link'\nimport { useToast } from '@/hooks/use-toast'\n\nexport default function PixPaymentPage() {\n  const { profile } = useAuth()\n  const router = useRouter()\n  const { toast } = useToast()\n  const [isLoading, setIsLoading] = useState(false)\n  const [pixData, setPixData] = useState<{\n    qrCode: string\n    pixKey: string\n    paymentId: string\n    amount: number\n  } | null>(null)\n  const [paymentStatus, setPaymentStatus] = useState<'pending' | 'processing' | 'completed' | 'failed'>('pending')\n\n  const isPro = profile?.plano === 'pro'\n\n  useEffect(() => {\n    if (isPro) {\n      router.push('/dashboard')\n      return\n    }\n\n    // Criar pagamento PIX ao carregar a página\n    createPixPayment()\n  }, [isPro, router])\n\n  const createPixPayment = async () => {\n    setIsLoading(true)\n    \n    try {\n      // Simular criação de pagamento PIX via AbacatePay\n      // Na implementação real, isso seria uma chamada para a API\n      const response = await fetch('/api/payments/pix/create', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          amount: 29.00,\n          description: 'Upgrade para DoceCalc PRO - Plano Mensal',\n          customerName: profile?.nome,\n          customerEmail: profile?.email || '',\n        }),\n      })\n\n      if (!response.ok) {\n        throw new Error('Erro ao criar pagamento PIX')\n      }\n\n      const data = await response.json()\n      setPixData(data)\n      \n      // Simular verificação de status do pagamento\n      checkPaymentStatus(data.paymentId)\n      \n    } catch (error) {\n      console.error('Erro ao criar pagamento PIX:', error)\n      toast({\n        title: \"Erro no Pagamento\",\n        description: \"Não foi possível gerar o PIX. Tente novamente.\",\n        variant: \"destructive\",\n      })\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const checkPaymentStatus = (paymentId: string) => {\n    // Simular verificação periódica do status\n    const interval = setInterval(async () => {\n      try {\n        const response = await fetch(`/api/payments/pix/status/${paymentId}`)\n        const data = await response.json()\n        \n        if (data.status === 'completed') {\n          setPaymentStatus('completed')\n          clearInterval(interval)\n          \n          toast({\n            title: \"Pagamento Confirmado! 🎉\",\n            description: \"Bem-vinda ao DoceCalc PRO! Redirecionando...\",\n          })\n          \n          setTimeout(() => {\n            router.push('/dashboard')\n          }, 2000)\n        }\n      } catch (error) {\n        console.error('Erro ao verificar status:', error)\n      }\n    }, 3000) // Verificar a cada 3 segundos\n\n    // Limpar interval após 10 minutos\n    setTimeout(() => {\n      clearInterval(interval)\n    }, 600000)\n  }\n\n  const copyPixKey = () => {\n    if (pixData?.pixKey) {\n      navigator.clipboard.writeText(pixData.pixKey)\n      toast({\n        title: \"PIX Copiado!\",\n        description: \"Código PIX copiado para a área de transferência\",\n      })\n    }\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-soft flex items-center justify-center\">\n        <Card className=\"max-w-md mx-auto text-center\">\n          <CardContent className=\"pt-6\">\n            <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4\" />\n            <p className=\"text-gray-600\">Gerando seu PIX...</p>\n          </CardContent>\n        </Card>\n      </div>\n    )\n  }\n\n  if (paymentStatus === 'completed') {\n    return (\n      <div className=\"min-h-screen bg-gradient-soft flex items-center justify-center\">\n        <Card className=\"max-w-md mx-auto text-center\">\n          <CardHeader>\n            <div className=\"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4\">\n              <CheckCircle className=\"h-8 w-8 text-green-600\" />\n            </div>\n            <CardTitle className=\"text-2xl text-green-800\">Pagamento Confirmado!</CardTitle>\n            <CardDescription>\n              Bem-vinda ao DoceCalc PRO! 🎉 Você agora tem acesso a todas as funcionalidades premium.\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-sm text-gray-600 mb-4\">\n              Redirecionando para o dashboard...\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-soft py-12 px-4\">\n      <div className=\"max-w-2xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <Link href=\"/dashboard/upgrade\">\n            <Button variant=\"ghost\" className=\"mb-4\">\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Voltar\n            </Button>\n          </Link>\n          \n          <div className=\"text-center\">\n            <Badge className=\"bg-green-100 text-green-800 border-green-200 mb-4\">\n              <Smartphone className=\"h-4 w-4 mr-2\" />\n              Pagamento PIX\n            </Badge>\n            <h1 className=\"text-3xl font-display font-bold text-gray-900 mb-2\">\n              Finalize seu upgrade\n            </h1>\n            <p className=\"text-gray-600\">\n              Pague via PIX e tenha acesso imediato ao DoceCalc PRO\n            </p>\n          </div>\n        </div>\n\n        {/* PIX Payment Card */}\n        <Card className=\"mb-6\">\n          <CardHeader>\n            <CardTitle className=\"text-center\">\n              <QrCode className=\"h-6 w-6 mx-auto mb-2\" />\n              Pagamento via PIX\n            </CardTitle>\n            <CardDescription className=\"text-center\">\n              Escaneie o QR Code ou copie o código PIX abaixo\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            {pixData ? (\n              <div className=\"space-y-6\">\n                {/* QR Code */}\n                <div className=\"text-center\">\n                  <div className=\"bg-white p-4 rounded-lg border-2 border-gray-200 inline-block\">\n                    <div className=\"w-48 h-48 bg-gray-100 rounded flex items-center justify-center\">\n                      <QrCode className=\"h-24 w-24 text-gray-400\" />\n                      <div className=\"absolute text-xs text-gray-500 mt-20\">\n                        QR Code PIX\n                      </div>\n                    </div>\n                  </div>\n                  <p className=\"text-sm text-gray-600 mt-2\">\n                    Abra seu app do banco e escaneie o código\n                  </p>\n                </div>\n\n                {/* PIX Key */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Ou copie o código PIX:\n                  </label>\n                  <div className=\"flex space-x-2\">\n                    <input\n                      type=\"text\"\n                      value={pixData.pixKey}\n                      readOnly\n                      className=\"flex-1 px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-sm font-mono\"\n                    />\n                    <Button onClick={copyPixKey} variant=\"outline\">\n                      <Copy className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </div>\n\n                {/* Payment Details */}\n                <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\n                  <div className=\"flex justify-between items-center mb-2\">\n                    <span className=\"text-sm font-medium text-blue-800\">Valor:</span>\n                    <span className=\"text-lg font-bold text-blue-900\">R$ {pixData.amount.toFixed(2)}</span>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm font-medium text-blue-800\">Plano:</span>\n                    <span className=\"text-sm text-blue-700\">DoceCalc PRO - Mensal</span>\n                  </div>\n                </div>\n\n                {/* Status */}\n                <div className=\"text-center\">\n                  <div className=\"flex items-center justify-center space-x-2 text-orange-600\">\n                    <Clock className=\"h-4 w-4 animate-pulse\" />\n                    <span className=\"text-sm font-medium\">Aguardando pagamento...</span>\n                  </div>\n                  <p className=\"text-xs text-gray-500 mt-1\">\n                    O pagamento será confirmado automaticamente em alguns segundos\n                  </p>\n                </div>\n              </div>\n            ) : (\n              <div className=\"text-center py-8\">\n                <p className=\"text-gray-600\">Erro ao gerar PIX. Tente novamente.</p>\n                <Button onClick={createPixPayment} className=\"mt-4\">\n                  Tentar Novamente\n                </Button>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Instructions */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg\">Como pagar com PIX</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-3 text-sm\">\n              <div className=\"flex items-start space-x-3\">\n                <div className=\"w-6 h-6 bg-primary text-white rounded-full flex items-center justify-center flex-shrink-0 text-xs font-bold\">\n                  1\n                </div>\n                <p>Abra o app do seu banco ou carteira digital</p>\n              </div>\n              <div className=\"flex items-start space-x-3\">\n                <div className=\"w-6 h-6 bg-primary text-white rounded-full flex items-center justify-center flex-shrink-0 text-xs font-bold\">\n                  2\n                </div>\n                <p>Escolha a opção \"Pix\" e depois \"Ler QR Code\" ou \"Pix Copia e Cola\"</p>\n              </div>\n              <div className=\"flex items-start space-x-3\">\n                <div className=\"w-6 h-6 bg-primary text-white rounded-full flex items-center justify-center flex-shrink-0 text-xs font-bold\">\n                  3\n                </div>\n                <p>Escaneie o QR Code ou cole o código PIX</p>\n              </div>\n              <div className=\"flex items-start space-x-3\">\n                <div className=\"w-6 h-6 bg-primary text-white rounded-full flex items-center justify-center flex-shrink-0 text-xs font-bold\">\n                  4\n                </div>\n                <p>Confirme o pagamento de R$ 29,00</p>\n              </div>\n              <div className=\"flex items-start space-x-3\">\n                <div className=\"w-6 h-6 bg-green-500 text-white rounded-full flex items-center justify-center flex-shrink-0 text-xs font-bold\">\n                  ✓\n                </div>\n                <p>Pronto! Você será redirecionada automaticamente</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Support */}\n        <div className=\"text-center mt-8\">\n          <p className=\"text-sm text-gray-600\">\n            Problemas com o pagamento?{' '}\n            <a href=\"mailto:suporte@docecalc.com\" className=\"text-primary hover:underline\">\n              Entre em contato conosco\n            </a>\n          </p>\n        </div>\n      </div>\n    </div>\n  )\n}","size_bytes":11758},"app/dashboard/upgrade/stripe/page.tsx":{"content":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useAuth } from '@/components/auth/auth-provider'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport { \n  ArrowLeft, \n  CreditCard,\n  Shield,\n  CheckCircle,\n  Loader2\n} from 'lucide-react'\nimport { useRouter } from 'next/navigation'\nimport Link from 'next/link'\nimport { loadStripe } from '@stripe/stripe-js'\nimport { Elements, CardElement, useStripe, useElements } from '@stripe/react-stripe-js'\nimport { useToast } from '@/hooks/use-toast'\n\n// Configurar Stripe (usando a chave pública do ambiente)\nconst stripePromise = loadStripe(process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY || process.env.VITE_STRIPE_PUBLIC_KEY || '')\n\nfunction CheckoutForm() {\n  const { profile } = useAuth()\n  const stripe = useStripe()\n  const elements = useElements()\n  const { toast } = useToast()\n  const router = useRouter()\n  const [isLoading, setIsLoading] = useState(false)\n  const [clientSecret, setClientSecret] = useState<string>('')\n\n  useEffect(() => {\n    // Criar Payment Intent quando o componente carregar\n    createPaymentIntent()\n  }, [])\n\n  const createPaymentIntent = async () => {\n    try {\n      const response = await fetch('/api/payments/stripe/create-intent', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          amount: 2900, // R$ 29,00 em centavos\n          currency: 'brl',\n          description: 'Upgrade para DoceCalc PRO - Plano Mensal',\n          customerName: profile?.nome,\n          customerEmail: profile?.email || '',\n        }),\n      })\n\n      if (!response.ok) {\n        throw new Error('Erro ao criar intenção de pagamento')\n      }\n\n      const data = await response.json()\n      setClientSecret(data.clientSecret)\n    } catch (error) {\n      console.error('Erro ao criar Payment Intent:', error)\n      toast({\n        title: \"Erro no Pagamento\",\n        description: \"Não foi possível processar o pagamento. Tente novamente.\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n\n    if (!stripe || !elements || !clientSecret) {\n      return\n    }\n\n    setIsLoading(true)\n\n    const cardElement = elements.getElement(CardElement)\n\n    if (!cardElement) {\n      setIsLoading(false)\n      return\n    }\n\n    try {\n      const { error, paymentIntent } = await stripe.confirmCardPayment(clientSecret, {\n        payment_method: {\n          card: cardElement,\n          billing_details: {\n            name: profile?.nome || '',\n            email: profile?.email || '',\n          },\n        },\n      })\n\n      if (error) {\n        throw new Error(error.message)\n      }\n\n      if (paymentIntent?.status === 'succeeded') {\n        toast({\n          title: \"Pagamento Confirmado! 🎉\",\n          description: \"Bem-vinda ao DoceCalc PRO! Redirecionando...\",\n        })\n\n        // Atualizar perfil do usuário para PRO\n        await fetch('/api/user/upgrade', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            paymentIntentId: paymentIntent.id,\n            plan: 'pro',\n          }),\n        })\n\n        setTimeout(() => {\n          router.push('/dashboard')\n        }, 2000)\n      }\n    } catch (error: any) {\n      toast({\n        title: \"Erro no Pagamento\",\n        description: error.message || \"Não foi possível processar o pagamento.\",\n        variant: \"destructive\",\n      })\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  if (!clientSecret) {\n    return (\n      <div className=\"flex items-center justify-center py-8\">\n        <div className=\"animate-spin w-6 h-6 border-4 border-primary border-t-transparent rounded-full mr-3\" />\n        <span className=\"text-gray-600\">Preparando pagamento...</span>\n      </div>\n    )\n  }\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-6\">\n      {/* Card Input */}\n      <div>\n        <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n          Informações do Cartão\n        </label>\n        <div className=\"border border-gray-300 rounded-md p-4 bg-white\">\n          <CardElement\n            options={{\n              style: {\n                base: {\n                  fontSize: '16px',\n                  color: '#424770',\n                  '::placeholder': {\n                    color: '#aab7c4',\n                  },\n                },\n                invalid: {\n                  color: '#9e2146',\n                },\n              },\n              hidePostalCode: true,\n            }}\n          />\n        </div>\n      </div>\n\n      {/* Security Note */}\n      <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\n        <div className=\"flex items-center space-x-2 text-blue-800 mb-2\">\n          <Shield className=\"h-5 w-5\" />\n          <span className=\"font-medium text-sm\">Pagamento 100% Seguro</span>\n        </div>\n        <p className=\"text-blue-700 text-xs\">\n          Seus dados são protegidos pela criptografia SSL e processados pelo Stripe, \n          a plataforma de pagamentos mais segura do mundo.\n        </p>\n      </div>\n\n      {/* Payment Button */}\n      <Button\n        type=\"submit\"\n        disabled={!stripe || isLoading}\n        size=\"lg\"\n        variant=\"doce\"\n        className=\"w-full\"\n      >\n        {isLoading ? (\n          <>\n            <Loader2 className=\"h-5 w-5 mr-2 animate-spin\" />\n            Processando...\n          </>\n        ) : (\n          <>\n            <CreditCard className=\"h-5 w-5 mr-2\" />\n            Pagar R$ 29,00\n          </>\n        )}\n      </Button>\n\n      <div className=\"text-center text-xs text-gray-500\">\n        Ao confirmar o pagamento, você concorda com nossos{' '}\n        <a href=\"/termos\" className=\"text-primary hover:underline\">\n          Termos de Uso\n        </a>\n      </div>\n    </form>\n  )\n}\n\nexport default function StripePaymentPage() {\n  const { profile } = useAuth()\n  const router = useRouter()\n\n  const isPro = profile?.plano === 'pro'\n\n  useEffect(() => {\n    if (isPro) {\n      router.push('/dashboard')\n    }\n  }, [isPro, router])\n\n  if (isPro) {\n    return (\n      <div className=\"min-h-screen bg-gradient-soft flex items-center justify-center\">\n        <Card className=\"max-w-md mx-auto text-center\">\n          <CardHeader>\n            <div className=\"mx-auto w-16 h-16 bg-gradient-doce rounded-full flex items-center justify-center mb-4\">\n              <CheckCircle className=\"h-8 w-8 text-white\" />\n            </div>\n            <CardTitle className=\"text-2xl\">Você já é PRO! 🎉</CardTitle>\n            <CardDescription>\n              Você já tem acesso a todas as funcionalidades premium do DoceCalc.\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Link href=\"/dashboard\">\n              <Button variant=\"doce\" className=\"w-full\">\n                Voltar ao Dashboard\n              </Button>\n            </Link>\n          </CardContent>\n        </Card>\n      </div>\n    )\n  }\n\n  if (!stripePromise) {\n    return (\n      <div className=\"min-h-screen bg-gradient-soft flex items-center justify-center\">\n        <Card className=\"max-w-md mx-auto text-center\">\n          <CardContent className=\"pt-6\">\n            <p className=\"text-red-600\">Erro na configuração do pagamento.</p>\n            <Link href=\"/dashboard/upgrade\">\n              <Button variant=\"outline\" className=\"mt-4\">\n                Voltar\n              </Button>\n            </Link>\n          </CardContent>\n        </Card>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-soft py-12 px-4\">\n      <div className=\"max-w-2xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <Link href=\"/dashboard/upgrade\">\n            <Button variant=\"ghost\" className=\"mb-4\">\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Voltar\n            </Button>\n          </Link>\n          \n          <div className=\"text-center\">\n            <Badge className=\"bg-blue-100 text-blue-800 border-blue-200 mb-4\">\n              <CreditCard className=\"h-4 w-4 mr-2\" />\n              Pagamento por Cartão\n            </Badge>\n            <h1 className=\"text-3xl font-display font-bold text-gray-900 mb-2\">\n              Finalize seu upgrade\n            </h1>\n            <p className=\"text-gray-600\">\n              Pague com cartão de crédito ou débito de forma segura\n            </p>\n          </div>\n        </div>\n\n        {/* Main Payment Card */}\n        <Card className=\"mb-6\">\n          <CardHeader>\n            <CardTitle className=\"text-center\">\n              Upgrade para DoceCalc PRO\n            </CardTitle>\n            <CardDescription className=\"text-center\">\n              Preencha os dados do seu cartão para concluir o upgrade\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            {/* Order Summary */}\n            <div className=\"bg-gray-50 p-4 rounded-lg mb-6\">\n              <h3 className=\"font-medium text-gray-900 mb-3\">Resumo do Pedido</h3>\n              <div className=\"space-y-2\">\n                <div className=\"flex justify-between text-sm\">\n                  <span className=\"text-gray-600\">DoceCalc PRO - Mensal</span>\n                  <span className=\"font-medium\">R$ 29,00</span>\n                </div>\n                <div className=\"flex justify-between text-sm\">\n                  <span className=\"text-gray-600\">Taxa de processamento</span>\n                  <span className=\"font-medium\">R$ 0,00</span>\n                </div>\n                <hr className=\"my-2\" />\n                <div className=\"flex justify-between font-medium\">\n                  <span>Total</span>\n                  <span>R$ 29,00</span>\n                </div>\n              </div>\n            </div>\n\n            {/* Stripe Payment Form */}\n            <Elements stripe={stripePromise}>\n              <CheckoutForm />\n            </Elements>\n          </CardContent>\n        </Card>\n\n        {/* Features Reminder */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg\">O que você ganha com o PRO</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm\">\n              <div className=\"flex items-center space-x-2\">\n                <CheckCircle className=\"h-4 w-4 text-green-500 flex-shrink-0\" />\n                <span>Receitas ilimitadas</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <CheckCircle className=\"h-4 w-4 text-green-500 flex-shrink-0\" />\n                <span>Calculadora avançada</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <CheckCircle className=\"h-4 w-4 text-green-500 flex-shrink-0\" />\n                <span>Orçamentos em PDF</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <CheckCircle className=\"h-4 w-4 text-green-500 flex-shrink-0\" />\n                <span>Relatórios detalhados</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <CheckCircle className=\"h-4 w-4 text-green-500 flex-shrink-0\" />\n                <span>Templates de receitas</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <CheckCircle className=\"h-4 w-4 text-green-500 flex-shrink-0\" />\n                <span>Suporte prioritário</span>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Support */}\n        <div className=\"text-center mt-8\">\n          <p className=\"text-sm text-gray-600\">\n            Problemas com o pagamento?{' '}\n            <a href=\"mailto:suporte@docecalc.com\" className=\"text-primary hover:underline\">\n              Entre em contato conosco\n            </a>\n          </p>\n        </div>\n      </div>\n    </div>\n  )\n}","size_bytes":12171},"app/api/payments/pix/create/route.ts":{"content":"import { NextRequest, NextResponse } from 'next/server'\nimport { supabase } from '@/lib/supabase-client'\n\n// AbacatePay API integration for PIX payments\n// Documentação: https://abacatepay.readme.io/reference\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json()\n    const { amount, description, customerName, customerEmail } = body\n\n    // Simular criação de pagamento PIX via AbacatePay\n    // Na implementação real, você faria uma chamada para a API do AbacatePay\n    \n    // Exemplo de requisição AbacatePay (implementar quando tiver as credenciais)\n    /*\n    const abacatePayResponse = await fetch('https://api.abacatepay.com/v1/billing', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${process.env.ABACATEPAY_API_KEY}`,\n      },\n      body: JSON.stringify({\n        frequency: 'ONE_TIME',\n        methods: ['PIX'],\n        products: [{\n          external_id: `docecalc_pro_${Date.now()}`,\n          name: 'DoceCalc PRO - Plano Mensal',\n          description: description,\n          quantity: 1,\n          price: Math.round(amount * 100) // Converter para centavos\n        }],\n        metadata: {\n          return_url: `${process.env.NEXT_PUBLIC_APP_URL}/dashboard`,\n          completion_url: `${process.env.NEXT_PUBLIC_APP_URL}/dashboard/upgrade/success`\n        },\n        customer: {\n          metadata: {\n            name: customerName,\n            email: customerEmail,\n            tax_id: null // CPF opcional\n          }\n        }\n      })\n    })\n\n    if (!abacatePayResponse.ok) {\n      throw new Error('Erro ao criar pagamento PIX')\n    }\n\n    const pixData = await abacatePayResponse.json()\n    */\n\n    // Por enquanto, simular resposta do AbacatePay\n    const pixData = {\n      id: `pix_${Date.now()}`,\n      qrCode: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==',\n      pixKey: `00020126330014BR.GOV.BCB.PIX0111${Math.random().toString(36).substring(2, 15)}520400005303986540${amount.toFixed(2)}5802BR5913${customerName}6009SAO PAULO61080540900062070503***6304${Math.random().toString(36).substring(2, 6).toUpperCase()}`,\n      paymentId: `payment_${Date.now()}`,\n      amount: amount,\n      status: 'pending',\n      createdAt: new Date().toISOString()\n    }\n\n    // Salvar pagamento no banco de dados (opcional, para tracking)\n    /*\n    const { error: dbError } = await supabase\n      .from('payments')\n      .insert({\n        payment_id: pixData.paymentId,\n        user_id: userSession.user.id,\n        amount: amount,\n        currency: 'BRL',\n        method: 'pix',\n        status: 'pending',\n        metadata: {\n          description,\n          customer_name: customerName,\n          customer_email: customerEmail\n        }\n      })\n\n    if (dbError) {\n      console.error('Erro ao salvar pagamento:', dbError)\n    }\n    */\n\n    return NextResponse.json({\n      qrCode: pixData.qrCode,\n      pixKey: pixData.pixKey,\n      paymentId: pixData.paymentId,\n      amount: pixData.amount,\n      status: pixData.status\n    })\n\n  } catch (error: any) {\n    console.error('Erro ao criar pagamento PIX:', error)\n    return NextResponse.json(\n      { error: 'Erro interno do servidor' },\n      { status: 500 }\n    )\n  }\n}","size_bytes":3331},"app/api/payments/stripe/create-intent/route.ts":{"content":"import { NextRequest, NextResponse } from 'next/server'\nimport Stripe from 'stripe'\n\nfunction getStripe() {\n  if (!process.env.STRIPE_SECRET_KEY) {\n    throw new Error('STRIPE_SECRET_KEY não está configurada')\n  }\n  \n  return new Stripe(process.env.STRIPE_SECRET_KEY)\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const stripe = getStripe()\n    const body = await request.json()\n    const { amount, currency = 'brl', description, customerName, customerEmail } = body\n\n    // Validação de entrada\n    if (!amount || typeof amount !== 'number' || amount <= 0) {\n      return NextResponse.json(\n        { error: 'Valor deve ser um número positivo' },\n        { status: 400 }\n      )\n    }\n\n    if (currency !== 'brl' && currency !== 'usd') {\n      return NextResponse.json(\n        { error: 'Moeda deve ser BRL ou USD' },\n        { status: 400 }\n      )\n    }\n\n    // Criar Customer no Stripe apenas se email for válido\n    let customer\n    if (customerEmail && customerEmail.includes('@') && customerName) {\n      try {\n        const existingCustomers = await stripe.customers.list({\n          email: customerEmail,\n          limit: 1\n        })\n\n        if (existingCustomers.data.length > 0) {\n          customer = existingCustomers.data[0]\n        } else {\n          customer = await stripe.customers.create({\n            email: customerEmail,\n            name: customerName,\n            metadata: {\n              source: 'docecalc_upgrade'\n            }\n          })\n        }\n      } catch (error) {\n        console.error('Erro ao criar/buscar customer:', error)\n        // Continuar sem customer se houver erro\n      }\n    }\n\n    // Criar Payment Intent\n    const paymentIntent = await stripe.paymentIntents.create({\n      amount: amount, // Valor em centavos\n      currency: currency,\n      description: description,\n      customer: customer?.id,\n      metadata: {\n        product: 'docecalc_pro',\n        plan: 'monthly',\n        customer_name: customerName,\n        customer_email: customerEmail\n      },\n      payment_method_types: ['card'],\n      setup_future_usage: 'off_session', // Para salvar o método de pagamento para futuras cobranças\n    })\n\n    return NextResponse.json({\n      clientSecret: paymentIntent.client_secret,\n      paymentIntentId: paymentIntent.id\n    })\n\n  } catch (error: any) {\n    console.error('Erro ao criar Payment Intent:', error)\n    \n    // Retornar erro específico do Stripe se disponível\n    if (error.type === 'StripeCardError') {\n      return NextResponse.json(\n        { error: error.message },\n        { status: 400 }\n      )\n    }\n\n    return NextResponse.json(\n      { error: 'Erro interno do servidor' },\n      { status: 500 }\n    )\n  }\n}","size_bytes":2718},"app/api/payments/pix/status/[paymentId]/route.ts":{"content":"import { NextRequest, NextResponse } from 'next/server'\n\nexport async function GET(\n  request: NextRequest,\n  { params }: { params: { paymentId: string } }\n) {\n  try {\n    const { paymentId } = params\n\n    // Verificar status do pagamento no AbacatePay\n    // Na implementação real, você faria uma chamada para a API do AbacatePay\n    \n    // Exemplo de verificação AbacatePay (implementar quando tiver as credenciais)\n    /*\n    const abacatePayResponse = await fetch(`https://api.abacatepay.com/v1/billing/${paymentId}`, {\n      method: 'GET',\n      headers: {\n        'Authorization': `Bearer ${process.env.ABACATEPAY_API_KEY}`,\n      }\n    })\n\n    if (!abacatePayResponse.ok) {\n      throw new Error('Erro ao verificar status do pagamento')\n    }\n\n    const paymentStatus = await abacatePayResponse.json()\n    */\n\n    // Por enquanto, simular verificação de status\n    // Em um cenário real, isso verificaria com o AbacatePay\n    const statusOptions = ['pending', 'completed', 'failed']\n    const randomStatus = Math.random() < 0.3 ? 'completed' : 'pending' // 30% chance de estar completo\n\n    const paymentStatus = {\n      id: paymentId,\n      status: randomStatus,\n      updatedAt: new Date().toISOString()\n    }\n\n    return NextResponse.json(paymentStatus)\n\n  } catch (error: any) {\n    console.error('Erro ao verificar status do pagamento:', error)\n    return NextResponse.json(\n      { error: 'Erro interno do servidor' },\n      { status: 500 }\n    )\n  }\n}","size_bytes":1474},"vite.config.ts":{"content":"import { defineConfig } from 'vite'\nimport react from '@vitejs/plugin-react'\nimport path from 'path'\n\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [react()],\n  resolve: {\n    alias: {\n      '@': path.resolve(__dirname, './src'),\n    },\n  },\n  server: {\n    port: 5000,\n    host: '0.0.0.0',\n  },\n})","size_bytes":323},"src/App.css":{"content":"/* App specific styles */\n#root {\n  max-width: 1280px;\n  margin: 0 auto;\n  padding: 2rem;\n  text-align: center;\n}","size_bytes":113},"src/App.tsx":{"content":"import { BrowserRouter as Router, Routes, Route } from 'react-router-dom'\nimport DashboardPage from './pages/DashboardPage'\nimport CalculadoraPage from './pages/CalculadoraPage'\nimport './App.css'\n\nfunction App() {\n  return (\n    <Router>\n      <div className=\"min-h-screen bg-gray-50\">\n        <Routes>\n          <Route path=\"/\" element={<DashboardPage />} />\n          <Route path=\"/dashboard\" element={<DashboardPage />} />\n          <Route path=\"/calculadora\" element={<CalculadoraPage />} />\n        </Routes>\n      </div>\n    </Router>\n  )\n}\n\nexport default App","size_bytes":567},"src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n:root {\n  font-family: Inter, system-ui, Avenir, Helvetica, Arial, sans-serif;\n  line-height: 1.5;\n  font-weight: 400;\n\n  color-scheme: light dark;\n  color: rgba(255, 255, 255, 0.87);\n  background-color: #242424;\n\n  font-synthesis: none;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  -webkit-text-size-adjust: 100%;\n}\n\na {\n  font-weight: 500;\n  color: #646cff;\n  text-decoration: inherit;\n}\na:hover {\n  color: #535bf2;\n}\n\nbody {\n  margin: 0;\n  display: flex;\n  place-items: center;\n  min-width: 320px;\n  min-height: 100vh;\n}\n\nh1 {\n  font-size: 3.2em;\n  line-height: 1.1;\n}\n\nbutton {\n  border-radius: 8px;\n  border: 1px solid transparent;\n  padding: 0.6em 1.2em;\n  font-size: 1em;\n  font-weight: 500;\n  font-family: inherit;\n  background-color: #1a1a1a;\n  cursor: pointer;\n  transition: border-color 0.25s;\n}\nbutton:hover {\n  border-color: #646cff;\n}\nbutton:focus,\nbutton:focus-visible {\n  outline: 4px auto -webkit-focus-ring-color;\n}\n\n@media (prefers-color-scheme: light) {\n  :root {\n    color: #213547;\n    background-color: #ffffff;\n  }\n  a:hover {\n    color: #747bff;\n  }\n  button {\n    background-color: #f9f9f9;\n  }\n}","size_bytes":1254},"src/main.tsx":{"content":"import React from 'react'\nimport ReactDOM from 'react-dom/client'\nimport App from './App.tsx'\nimport './index.css'\n\nReactDOM.createRoot(document.getElementById('root')!).render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n)","size_bytes":235}},"version":1}